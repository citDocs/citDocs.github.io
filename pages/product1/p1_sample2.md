---
title: Sample 2 Topic (Product 1)
keywords: sample
summary: "This is just a sample topic..."
sidebar: product1_sidebar
permalink: p1_sample2.html
folder: product1
---

# <center>РЕШЕНИЕ ПРОБЛЕМ С ВВЕДЕНИЕМ ДАННЫХ В ЯЧЕЙКИ</center>

## <center>ВВОДИМ В ЯЧЕЙКУ ЧИСЛО КАК ТЕКСТ</center>

Часто в Excel числа необходимо записать как текст. И на оборот, введенные нами текстовые значения программа меняет на числа или даты.

На первом уроке рассмотрим, в каких случаях может возникнуть конфликт между пользователем и программой при введении данных в ячейки. Так же найдем лучшее решения для правильного введения в ячейки числа как текст.

### <center>КАК ПРЕОБРАЗОВАТЬ ЧИСЛО В ТЕКСТ?</center>

Вводить числа как текст в Excel приходится достаточно часто. Например:

<ol>
    <li>Номер фактуры или договора состоит из более 12-ти чисел. Допустим номер: «1234567891012» Excel округляет большие числа в такой формат «1,23457E+12».</li>
    <li>Некоторые номера телефонов автоматически конвертируются в дату. Номер телефона: 2012-10-17 отображается как «17.10.2012».</li>
    <li>Иногда нужно записать формулу обычным текстом.</li>
</ol>

Поэтому важно научиться управлять форматами ячеек.

Попробуйте заполнить табличку, так как показано на рисунке:

![img](/images/img.png)

Как видно на примере проблема возникает при введении текста «10/12». После нажатия клавиши «Enter» получаем дату:

![img](/images/img.png)

Необходимо заставить Excel распознавать числа как текст.

**Решение 1.** В ячейке D2 введите перед текстовым значением символ апострофа «'» _(апостроф следует ввести с английской раскладки клавиатуры)_. Теперь число преобразовано в текстовое значение.

**Решение 2.** Задайте в ячейке D2 текстовый формат. Для этого откройте окно «Формат ячеек» CTRL+1. На вкладке «Число» выберите из списка «Числовые формат» опцию «Текстовый» и нажмите ОК. Теперь можно вводить любые числа как текст без апострофа.

Главным отличием выше описанных двух примеров является закрепление за ячейкой способа отображения ее значений с помощью присвоения формата. Если в первом решении в ячейку будут вводиться новые типы данных (без апострофа), то они будут отображаться по умолчанию.

_Примечание. Второе решение закрепляет за ячейкой ее формат, и любые другие типы данных будут преобразованы, пока пользователь не изменит для нее другие форматы (например, «Общий» - по умолчанию)._

### <center>МАТЕМАТИЧЕСКИЕ ОПЕРАЦИИ С ТЕКСТОМ В EXCEL</center>

Если функция ссылается на ячейку, в которой число записано текстом, то при вычислении значение этой ячейки равно «0». Но здесь нужно быть очень внимательным, так как бывают исключения. Это может приводить к ошибочным расчетам. Приводим конкретный пример.

<ol>
    <li>
        Заполните диапазон ячеек A1:D6 так как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Колонку E не нужно заполнять, так как в ней отображается содержимое ячеек в колонке D. Обратите внимание в ячейках B3 и B6 числовые данные записаны как текстовые через апостроф «'».
    </li>
    <li>
        В колонку D введите формулы, которые отображаются в колонке E как на рисунке.
    </li>
</ol>

Теперь обратите внимание на результаты вычислений функций и формул в колонке D.

В ячейке D2 функция =СУММ(A2:C2) отображает правильный результат 1+100+10=111. А в ячейке D3 функция суммирования меняет значение ячейки B3 на число 0, так как там данные отображаются в текстовом формате. В результате: 1+0+10=11.

**Внимание!** При вычислении аналогичных значений ячеек, но уже с помощью обычной формулы =A6+B6+C6 все значения ячеек воспринимаются как числовые значения, несмотря на то, что ячейка B6 имеет текстовый формат. Формулы могут суммировать, умножать, разделять и вычитать текст, если он состоит только из символов чисел (0-9), а функции не могут.

Из этого примера возникает простой вывод. При вычислении и расчетах в Excel необходимо использовать одинаковые типы данных, не зависимо от формул и функций. Это лучше чем конвертировать текст в число и позволит избежать много ошибок. Не выполняйте никаких математических операций с текстом.

## <center>ЗАПОЛНЕНИЕ ЯЧЕЕК В EXCEL ЗНАКАМИ ПОСЛЕ ЗАПЯТОЙ</center>

При вводе значений в ячейки листа Excel все данные проходят через встроенный программный фильтр форматирования. Он позволяет упростить работу пользователя. Поэтому введенные данные могут отличаться от отображаемых значений после ввода.

К каким проблемам может привести фильтр форматов ячеек, рассмотрим на конкретных примерах. А также найдем лучшие решения для выхода из сложившихся ситуаций.

### <center>ЕСЛИ EXCEL СЧИТАЕТ НЕКОРРЕКТНО ЧИСЛА ПОСЛЕ ЗАПЯТОЙ</center>

Рассмотрим простой пример, когда содержимое ячеек отличается, от отображения их значений. Например, могут возникнуть математические ошибки при округлении дробных чисел.

На готовом примере продемонстрируем следующие расчеты.

<ol>
    <li>
        Заполните исходную табличку как показано на рисунке:
    </li>
    <li>
        В ячейках B и C задайте финансовый формат (CTRL+1 «Формат ячеек»-«Число»-«Финансовый»).
    </li>
    <li>
        В ячейку C1 запишите то, что отображается в ячейке B1 (1,53 – результат после округления до двух знаков после запятой). Так же само введите число в C2 как отображено в B2 _(символы валют не проставляем, так как они преставятся автоматически благодаря финансовому формату)_.
    </li>
    <li>
        В третьей строке просуммируем значение каждой колонки таблички.
    </li>
</ol>

![img](/images/img.png)

Как видите точность расчета знаков после запятой в Excel, может отличаться. Форматирование в реальности не округляет числовые значения в ячейках. Они остаются те же и реальными отображаются в строке формул.

![img](/images/img.png)

При суммировании большого количества таких округлений ошибки могут быть очень большими. Поэтому при расчетах и вычислениях нельзя округлять с помощью форматирования. Необходимо знать, как округлить сумму в Excel. Точное округление можно сделать только специальными функциями такими как:

<ul>
    <li>=ОКРУГЛ;</li>
    <li>=ОКРУГЛВВЕРХ;</li>
    <li>=ОКРУГЛВНИЗ;</li>
    <li>=ЦЕЛОЕ _(функция позволяет в Excel округлить до большего целого)_.< /li>
</ul>

Для эффективного использования этих функций в больших количествах применяются массивы функций. Но это уже рассмотрим на следующих уроках.

### <center>АВТОМАТИЧЕСКАЯ ВСТАВКА ДЕСЯТИЧНОЙ ЗАПЯТОЙ</center>

Автоматический фильтр форматов рассчитан на упрощение работы с программой, особенно если научится им управлять. Очень часто нам приходится поставить запятую при вводе денежных сумм для отображения копеек. Десятичный разделитель запятая в Excel может проставлятся автоматически при заполнении финансовых данных в денежном эквиваленте. Для этого:

<ol>
    <li>
        Откройте окно «Фай»-«Параметры».
    </li>
    <li>
        В окне «Параметр Excel» перейдите на «Дополнительно»-«Параметры правки» и отметьте галочкой пункт «Автоматическая вставка десятичной запятой». Число знаков после разделителя пусть останется «2». Теперь проверим результат.
        ![img](/images/img.png)
    </li>
    <li>
        В ячейку A1 введите 1234 и нажмите «Enter», в результате мы видим 12,34 как на рисунке:
        ![img](/images/img.png)
    </li>
</ol>

Теперь можно спокойно вводить суммы с копейками, не разделяя их запятой. После каждого ввода запятая будет проставляться автоматически перед двумя последними числами.

Стоит отметить, что если в сумме 00 копеек, то знаки после запятой в Excel нужно вводить обязательно. Иначе может получиться так 0,01 или 0,2.

Если при вводе с автоматическим режимом вставки разделителя вы ввели запятую, то она останется в том месте, где вы ее вводили.

![img](/images/img.png)

То есть количество знаков после запятой можно изменить или перенести саму запятую.

После заполнения сумм с копейками не забудьте отключить эту функцию.

## <center>4 СПОСОБА ЗАМЕНИТЬ ТОЧКУ НА ЗАПЯТУЮ В EXCEL</center>

Точка вместо запятой дробных чисел может привести к существенным последствиям при расчетах в программе Excel. Чаще всего такие ошибки случаются, когда импортируются данные в таблицу из других источников.

Если в дробных числах вместо запятой стоит точка, то программа автоматически воспринимает их как текстовый тип данных. Поэтому перед тем как выполнять математические расчеты и вычисления следует отформатировать и подготовить импортированные данные.

### <center>КАК В EXCEL ЗАМЕНИТЬ ТОЧКУ, НА ЗАПЯТУЮ?</center>

Выделите и скопируйте данные из ниже приведенной таблицы:

| №**п/п** | **Валютная пара** | **Пересчет** | **Продажа** | **Покупка** | **Спрэд**   |
| -------- | ----------------- | ------------ | ----------- | ----------- | ----------- |
| 1 	   | EUR/USD	       | 1	          | 1.1347	    | 1.1350      | 0.0003      |
| -------- | ----------------- | ------------ | ----------- | ----------- | ----------- |
| 2	       | GBP/USD	       | 1	          | 1.5438	    | 1.5442      | 0.0004      |
| -------- | ----------------- | ------------ | ----------- | ----------- | ----------- |
| 3	       | USD/CHF	       | 1	          | 0.9543	    | 0.9547      | 0.0004      |
| -------- | ----------------- | ------------ | ----------- | ----------- | ----------- |
| 4	       | USD/JPY	       | 100	      | 1.1948	    | 1.1945      | -0.0003     |
| -------- | ----------------- | ------------ | ----------- | ----------- | ----------- |

Теперь перейдите на рабочий лист и щелкните правой кнопкой мышки по ячейке A1. Из появившегося контекстного меню выберите опцию «Специальная вставка». В диалоговом окне выберите «Текст в кодировке Unicode» и нажмите ОК.

![img](/images/img.png)
![img](/images/img.png)

Как видно Excel распознает числа только в колонке C. Значения в этой колонке выровнены по правой стороне. В других колонках по левому краю. Во всех ячейках формат по умолчанию «Общий», а в ячейках D3, D5, E3, E5 вообще отображается формат «Дата». Мы копировали данные через специальную вставку и все форматы исходной таблицы устранены. Причина только одна – вместо запятой стоит точка. Такой тип данных не подготовлен и его нельзя использовать для вычислений.

_Примечание. Если копировать данные из других источников без специальной вставки, то вместе с данными копируется и формат. В таком случаи формат ячеек «Общий» (по умолчанию) может быть изменен. Тогда нельзя визуально отличить, где распознано число, а где текст._

Все последующие действия необходимо выполнять с чистого листа. Удалите все, что есть на листе или откройте новый для дальнейшей работы.

Чтобы заменить точку, на запятую в импортированных данных можно использовать 4 способа:

#### Способ 1: замена точки на запятую в Excel через Блокнот

Программа Блокнот Windows не требует использования сложных настроек и функций, а лишь выступает посредником в копировании и предварительной подготовки данных.

<ol>
    <li>
        Скопируйте данные из исходной таблички на этой странице. Откройте программу Блокнот Windows («Пуск»-«Все программы»-«Стандартные»-«Блокнот») и вставьте в него скопированные данные для подготовки.
        ![img](/images/img.png)
    </li>
    <li>
        Выберите в меню «Правка» опцию «Заменить» (или комбинацию горячих клавиш CTRL+H). В появившимся диалоговом окне, введите в поле: «Что» точку (.), а в поле «Чем» запятую (,). И нажмите кнопку «Заменить все».
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
</ol>

Программа Блокнот заменила все точки, на запятые. Теперь данные готовы для копирования и вставки на лист.

![img](/images/img.png)

Это весьма простой, но очень эффективный способ.

#### Способ 2: временно меняем настройки Excel

Перед тем как поменять точку на запятую в Excel правильно оцените поставленную задачу. Возможно, лучше заставить программу временно воспринимать точку, как разделитель десятых в дробных числах. Просто в настройках мы указываем, что в дробных числах разделитель точка вместо запятой.

Для этого нужно открыть «Файл»-«Параметры»-«Дополнительно». В разделе «Параметры правки» следует временно убрать галочку «Использовать системные разделители». А в поле «Разделитель целой и дробной части» следует удалить запятую и ввести точку.

![img](/images/img.png)

После выполнения вычислений настоятельно рекомендуется вернуть настройки по умолчанию.

**Внимание!** Данный способ сработает, если сделать все изменения до импорта данных, а не после.

#### Способ 3: временно меняем системные настройки Windows

Принцип этого способа похож на предыдущий. Только здесь мы меняем похожие настройки в Windows. В настройках региональных стандартов операционной системы нужно заменить запятую, на точку. Теперь подробнее о том, как это сделать.

Открываем «Пуск»-«Панель управления»-«Языки и региональные стандарты». Нажимаем на кнопку «Дополнительно». В появившимся окне изменяем в первом поле «Разделитель целой и дробной части» - вводим нужное нам значение. Дальше ОК и ОК.

![img](/images/img.png)

**Внимание!** Если вы откроете этот файл на другом компьютере, где установлены другие системные параметры региональных стандартов, то могут возникнуть проблемы с вычислениями.

#### Способ 4 используем функцию найти и заменить в Excel

Данный способ похож на первый. Только здесь мы используем ту же функцию из Блокнота, но уже в самом Excel.

В этом способе, в отличие от выше приведенных, мы сначала вставляем скопированную табличку на чистый лист, а потом подготавливаем ее к выполнению вычислений и расчетов.

Важным недостатком данного способа является сложность его реализации, если некоторые дробные числа с точкой после вставки были распознаны как дата, а не как текст. Поэтому мы сначала избавимся от дат, а потом разберемся с текстом и точками.

<ol>
    <li>
        Предварительно выделите столбцы где будут находится дробные числа с точкой в качестве разделителя. В данном случаи это 3 столбца D:F.
    </li>
    <li>
        Установите для выделенного диапазона текстовый формат ячеек, чтобы заранее избежать автоматического преобразования в формат даты некоторых чисел. Для этого выберите текстовый формат из выпадающего списка на закладке «Главная» в разделе «Число». Или нажмите CTRL+1 , в появившимся окне «Формат ячеек» выберите закладку «Число», а в разделе «Числовые форматы» укажите «Текстовый».
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Скопируйте таблицу и щелкните правой кнопкой мышки по ячейке A1. Из контекстного меню выберите опцию «Специальная вставка». Выберите «Текст в кодировке Unicode» и нажмите ОК. Обратите внимание, как теперь отображаются значения в ячейках: D3, D5, E3, E5, в отличии от самого первого копирования таблицы.
        ![img](/images/img.png)
    </li>
    <li>
        Нажмите на инструмент «Главная»-«Найти и выделить»-«Заменить» (или нажмите комбинацию CTRL+H).
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне введите в поле «Найти» - точку, а в во второе поле введите запятую. И нажмите «Заменить все».
    </li>
    <li>
        Снова выделите 3 столбца D:F и измените формат ячеек на «Числовой» CTRL+SHIFT+1. Не забудьте увеличить разрядность до 4-х, как описано в пункте №2.
        ![img](/images/img.png)
    </li>
</ol>

Все точки сменились на запятые. А текст автоматически преобразился в число.

Вместо 4-го и 5-го пункта можно использовать в отдельной колонке формулу с функциями: 

![img](/images/img.png)

Например, выделите диапазон ячеек G2:I5, введите эту формулу и нажмите CTRL+Enter. А потом переместите значения ячеек диапазона G2:I5 в диапазон D2:F5.

Эта формула находит в тексте точку с помощью функции НАЙТИ. Потом вторая функция меняет ее на запятую. А функция ЗНАЧЕН преобразует полученный результат в число.

# <center>АВТОМАТИЧЕСКОЕ ЗАПОЛНЕНИЕ ЯСЕЕК ТАБЛИЦ</center>

## <center>КАК АВТОМАТИЧЕСКИ ЗАПОЛНИТЬ ЯЧЕЙКИ В MS EXCEL С БОЛЬШИМИ ТАБЛИЦАМИ</center>

В программе Excel существует много приемов для быстрого и эффективного заполнения ячеек данными. Всем известно, что лень – это двигатель прогресса. Знают об этом и разработчики.

На заполнение данных приходится тратить большую часть времени на скучную и рутинную работу. Например, заполнение табеля учета рабочего времени или расходной накладной и т.п.

Рассмотрим приемы автоматического и полуавтоматического заполнения в Excel. А так же, какими инструментами обладают электронные таблицы для облегчения труда пользователя. Научимся применять их в практике и узнаем насколько они эффективные.

### <center>КАК В EXCEL ЗАПОЛНИТЬ ЯЧЕЙКИ ОДИНАКОВЫМИ ЗНАЧЕНИЯМИ?</center>

Сначала рассмотрим, как автоматически заполнять ячейки в Excel. Для примера заполним наполовину незаполненную исходную таблицу.

![img](/images/img.png)

Это небольшая табличка только на примере и ее можно было заполнить вручную. Но в практике иногда приходится заполнять по 30 тысяч строк. Чтобы не заполнять эту исходную таблицу вручную следует создать формулу для заполнения в Excel данными – автоматически. Для этого следует выполнить ряд последовательных действий:

<ol>
    <li>
        Перейдите на любую пустую ячейку исходной таблицы.
    </li>
    <li>
        Выберите инструмент: «Главная»-«Найти и выделить»-«Перейти» (или нажмите горячие клавиши CTRL+G).
    </li>
    <li>
        В появившемся окне щелкните на кнопку «Выделить».
    </li>
    <li>
        В появившемся окне выберите опцию «пустые ячейки» и нажмите ОК. Все незаполненные ячейки выделены.
    </li>
    <li>
        Теперь введите формулу «=A1» и нажмите комбинацию клавиш CTRL+Enter. Так выполняется заполнение пустых ячеек в Excel предыдущим значением – автоматически.
        ![img](/images/img.png)
    </li>
    <li>
        Выделите колонки A:B и скопируйте их содержимое.
    </li>
    <li>
        Выберите инструмент: «Главная»-«Вставить»-«Специальная вставка» (или нажмите CTRL+ALT+V).
    </li>
    <li>
        В появившемся окне выберите опцию «значения» и нажмите Ок. Теперь исходная таблица заполнена не просто формулами, а естественными значениями ячеек.
    </li>
</ol>

![img](/images/img.png)

При заполнении 30-ти тысяч строк невозможно не допустить ошибки. Выше приведенный способ не только экономит силы и время, но и исключает возникновение ошибок вызванных человеческим фактором.

**Внимание!** В 5-том пункте таблица красиво заполнилась без ошибок, так как наша активная ячейка была по адресу A2, после выполнения 4-го пункта. При использовании данного метода будьте внимательны и следите за тем где находится активная ячейка после выделения. Важно откуда она будет брать свои значения.

### <center>ПОЛУАВТОМАТИЧЕСКОЕ ЗАПОЛНЕНИЕ ЯЧЕЕК В EXCEL ИЗ ВЫПАДАЮЩЕГО СПИСКА</center>

Теперь в полуавтоматическом режиме можно заполнить пустые ячейки. У только несколько значений, которые повторяются в последовательном или случайном порядке.

В новой исходной таблице автоматически заполните колонки C и D соответствующие им данными.

<ol>
    <li>
        Заполните заголовки колонок C1 – «Дата» и D1 – «Тип платежа».
    </li>
    <li>
        В ячейку C2 введите дату 18.07.2015
    </li>
    <li>
        В ячейках С2:С4 даты повторяются. Поэтому выделяем диапазон С2:С4 и нажимаем комбинацию клавиш CTRL+D, чтобы автоматически заполнить ячейки предыдущими значениями.
    </li>
    <li>
        Введите текущею дату в ячейку C5. Для этого нажмите комбинацию клавиш CTRL+; (точка с запятой на английской раскладке клавиатуры). Заполните текущими датами колонку C до конца таблицы.
    </li>
    <li>
        Диапазон ячеек D2:D4 заполните так как показано ниже на рисунке.
    </li>
    <li>
        В ячейке D5 введите первую буку «п», а дальше слово заполнят не надо. Достаточно нажать клавишу Enter.
    </li>
    <li>
        В ячейке D6 после ввода первой буквы «н» не отображается часть слова для авто-заполнения. Поэтому нажмите комбинацию ALT+(стрела вниз), чтобы появился выпадающий список. Выберите стрелками клавиатуры или указателем мышки значение «наличными в кассе» и нажмите Enter.
    </li>
</ol>

![img](/images/img.png)

Такой полуавтоматический способ ввода данных позволяет в несколько раз ускорить и облегчить процесс работы с таблицами.

**Внимание!** Если значение состоит из нескольких строк, то при нажатии на комбинацию ALT+(стрела вниз) оно не будет отображаться в выпадающем списке значений.

Разбить значение на строки можно с помощью комбинации клавиш ALT+Enter. Таким образом, текст делится на строки в рамках одной ячейки.

![img](/images/img.png)

_Примечание. Обратите внимание, как мы вводили текущую дату в пункте 4 с помощью горячих клавиш (CTRL+;). Это очень удобно! А при нажатии CTRL+SHIFT+; мы получаем текущее время._

## <center>ПРИМЕР КАК ИЗМЕНИТЬ СРАЗУ ВСЕ ЦЕНЫ В EXCEL</center>

В прайсах Excel очень часто приходится изменять цены. Особенно в условиях нестабильной экономики.

Рассмотрим 2 простых и быстрых способа одновременного изменения всех цен с увеличением наценки в процентах. Показатели НДС будут перечитываться автоматически. А так же мы узнаем, как посчитать наценку в процентах.

### <center>КАК СДЕЛАТЬ НАЦЕНКУ НА ТОВАР В EXCEL?</center>

В исходной таблице, которая условно представляет собой расходную накладную нужно сделать наценку для всех цен и НДС на 7%. Как вычисляется Налог на Добавленную стоимость видно на рисунке:

![img](/images/img.png)

«Цена с НДС» рассчитывается суммированием значений «цены без НДС» + «НДС». Это значит, что нам достаточно увеличить на 7% только первую колонку.

#### Способ 1: изменение цен в Excel

<ol>
    <li>
        В колонке E мы вычислим новые цены без НДС+7%. Вводим формулу: =B2*1,07. Копируем это формулу во все соответствующие ячейки таблицы колонки E. Так же скопируем заголовок колонки из B1 в E1. Как посчитать процент повышения цены в Excel, чтобы проверить результат? Очень просто! В ячейке F2 задайте процентный формат и введите формулу наценки на товар: =(E2-B2)/B2. Наценка составляет 7%.
        ![img](/images/img.png)
    </li>
    <li>
        Копируем столбец E и выделяем столбец B. Выбираем инструмент: «Главная»-«Вставить»-«Специальная вставка» (или нажимаем CTRL+SHIFT+V). В появившимся окне отмечаем опцию «значения» и нажимаем Ок. Таким образом, сохранился финансовый формат ячеек, а значения обновились.
    </li>
    <li>
        Удаляем уже ненужный столбец E. Обратите внимание, что благодаря формулам значения в столбцах C и D изменились автоматически.
    </li>
</ol>   

![img](/images/img.png)

Вот и все у нас прайс с новыми ценами, которые увеличенные на 7%. Столбец E и F можно удалить.

#### Способ 2: позволяет сразу изменить цены в столбце Excel

<ol>
    <li>
        В любую отдельную от таблицы ячейку (например, E3) введите значение 1,07 и скопируйте его.
    </li>
    <li>
        Выделите диапазон B2:B5. Снова выберите инструмент «Специальная вставка» (или нажимаем CTRL+SHIFT+V). В появившемся окне, в разделе «Вставить» выберите опцию «значения». В разделе «Операции» выберите опцию «умножить» и нажмите ОК. Все числа в колонке «цена без НДС» увеличились на 7%.
    </li>
</ol>

![img](/images/img.png)
![img](/images/img.png)
![img](/images/img.png)

**Внимание!** Заметьте, в ячейке D2 отображается ошибочное значение: вместо 1,05 там 1,04. Это ошибки округлений.

Чтобы все расчеты били правильными, необходимо округлять числа, перед тем как их суммировать.

В ячейке C2 добавим к формуле функцию: =ОКРУГЛ(B2*0,22;2). Проверяем D2 = B2 + C2 (1,05 = 0,86 + 0,19). Теперь скопируем содержимое C2 в целый диапазон C2:C5.

![img](/images/img.png)

_Примечание. Так как у нас только 2 слагаемых нам не нужно округлять значения в колонке B. Ошибок уже 100% не будет._

Ошибки округлений в Excel вовсе не удивляют опытных пользователей. Уже не раз рассматривались примеры по данному вопросу и еще не рас будут рассмотрены на следующих уроках.

Неправильно округленные числа приводят к существенным ошибкам даже при самых простых вычислениях. Особенно если речь идет о больших объемах данных. Всегда нужно помнить об ошибках при округлении, особенно когда нужно подготовить точный отчет.

## <center>БЫСТРОЕ ЗАПОЛНЕНИЕ И РЕДАКТИРОВАНИЕ ШАБЛОНА ТАБЛИЦ</center>

Очень часто в процессе работы с Excel приходится аккуратно обновлять данные в сложных таблицах, которые содержат множество формул и функций. Можно наделать много ошибок, особенно если с файлом работают разные пользователи.

В таком случаи хорошим тоном является ведение шаблонов отчетов и таблиц. Но с шаблонами нужно уметь правильно работать при заполнении или обновлении их данными.

### <center>АВТОМАТИЗАЦИЯ ЗАПОЛНЕНИЯ И РЕДАКТИРОВАНИЯ ТАБЛИЦ В EXCEL</center>

На рисунке отображена таблица с данными, в которой неизвестно где исходные данные, а где результаты вычислений формул и функций.

![img](/images/img.png)

Можно перейти в режим отображения формул, нажав комбинацию клавиш CTRL+Ё (` - выше клавишы Tab).

![img](/images/img.png)

Теперь видно, что стоимость 1-го обычно часа работы составляет 15$. А сверхурочный час оплачивается по 20$. Так же видно как формируется сумма к выплате.

Но чтобы редактировать большие таблицы этого не достаточно. Например, если нам нужно автоматически выделить только число из каждой ячейки Excel.

Нужно использовать более эффективные инструменты, которые позволят обновить исходные данные, не затронув формулы.

Перед тем как научится их использовать нажмите еще раз комбинацию CTRL+Ё, чтобы перейти в обычный режим отображения листа.

Редактируем шаблон таблицы с формулами:

<ol>
    <li>
        Выберите инструмент: «Главная»-«Найти и выделить»-«Перейти» (или нажмите CTRL+G), а потом нажмите на кнопку : «Выделить» .
        ![img](/images/img.png)
    </li>
    <li>
        В появившимся окне выберите опцию «константы» и поставьте галочку только на против «числа». Нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

Автоматически выделились только те диапазоны, которые содержат числовые значения. Формулы и функции не выделены. Чтобы стереть старые данные осталось лишь нажать клавишу Delete.

![img](/images/img.png)

Вуаля! Можно заполнять новыми данными.

**Внимание!** Стоит отметить, что можно управлять выделениями инструмента «Перейти». Например, можно ограничить выделение чисел только в определенном диапазоне. Для этого предварительно выделите диапазон A1:D3. Потом выполните пункт 1, а за тем пункт 2.

![img](/images/img.png)

В результате будут выделены числовые значения только в диапазоне C2:C3.

## <center>КОПИРОВАНИЕ ФОРМУЛ БЕЗ ИЗМЕНЕНИЯ АДРЕСОВ ОТНОСИТЕЛЬНЫХ ССЫЛОК</center>

Целью этого урока является научить пользователя контролировать адреса ссылок на ячейки в формулах при их копировании или перемещении.

В зависимости от того копируется или перемещается формула в Excel, адреса ее ссылок могут существенно отличаться. Об этом нужно помнить всегда!

### <center>КОПИРОВАНИЕ ФОРМУЛ EXCEL БЕЗ ИЗМЕНЕНИЙ ССЫЛОК</center>

На готовом примере разберем согбенности изменения ссылок в формулах. Но перед тем как скопировать формулу в Excel, создайте на листе простую табличку как показано на рисунке:

![img](/images/img.png)

Скопируйте значения столбца B (например, комбинацией клавиш CTRL+C) и вставьте их в столбец D (CTRL+V) . А потом переместите данные из столбца B в E (например, комбинацией клавиш CTRL+X).

Теперь переключитесь в режим отображения формул – CTRL+`(Ё). Обратите внимание, как ведут себя ссылки на ячейки при перемещении и копировании.

![img](/images/img.png)
![img](/images/img.png)

При перемещении (те, что в столбце E) ссылки не изменяются. А при копировании (те, что в столбце D), они смещаются автоматически.

### <center>КОПИРОВАНИЕ ФОРМУЛ В EXCEL СО СМЕЩЕНИЕМ</center>

При копировании адреса относительных ссылок приспосабливаются к новому положению. Если ссылка была на одну ячейку влево, то она так и продолжает ссылаться, но адрес естественно меняется. Поэтому формула: =A2*1,23 стала формулой =C2*1,23. Когда мы ту же самую формулу не скопируем, а переместим, то адреса ее ссылок не изменятся, несмотря на то, что они относительные. При перемещении ссылки на ячейки ведут себя как абсолютные. Об этом следует всегда помнить пользователю Excel.

_Примечание. В разделе, посвященном формулам, будет уделено больше внимания относительным и абсолютным ссылкам. А пока отметим что по умолчанию ссылки относительные, а если в адресе присутствует символ «$» - значит ссылка абсолютная._

Теперь усложним задание. Верните табличку до изначального вида как на первом рисунке. Выполните ряд последовательных действий:

<ol>
    <li>
        Скопируйте «Лист1», например с помощью мышки+CTRL. Наведите указатель на ярлычок первого листа. Удерживая левую клавишу мышки и клавишу CTRL на клавиатуре, переместите ярлычок (копия листа) в новое место. Отпустите сначала мышку, а потом клавиатуру. У вас получился такой же лист, но уже с названием «Лист1(2)».
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        На копии «Лист1(2)» в ячейку D2 скопируйте значение из B2, а в ячейку E2 переместите (как на предыдущем задании).
        ![img](/images/img.png)
    </li>
    <li>
        Теперь скопируйте столбцы D:E из «Лист1(2)» и вставьте их в столбцы D:E из «Лист1».
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
</ol>

Как видите обе ячейки D2 и E2 были одинаково и одновременно скопированы, но ссылки в их формулах уже ведут себя по-разному. При копировании формул E2 значение не меняется. Все из-за того, что значения E2 из «Лист1(2)» получены путем перемещения и это уже считается для Excel иной способ присваивания адресов в формулах данной ячейки. Чтобы еще раз в этом убедиться, снова приведите табличку на «Лист1» в изначальный вид как на первом рисунке.

На этот раз в ячейку E2 скопируйте формулу из B2, а в ячейку D2 переместите туже самую формулу.

![img](/images/img.png)

Программа нас информирует, что мы имеем ошибку «неправильная ссылка на ячейку» в E2. Но если бы мы не переносили, а просто скопировали формулы, то никаких ошибок не возникло.

_Примечание. Быстро перемещать формулы можно с помощью перетаскивания ячейки мышкой удерживая левую клавишу после наведения указателя на рамку курсора выделенной ячейки. А выполнив это действие с нажатой клавишей CTRL, тогда формула скопируется._

![img](/images/img.png)

Данный урок может показаться сложным для понимания, но на практике достаточно прост. Нужно только помнить об особенностях поведения формул при их копировании.

## <center>ПРОСТЫЕ РАСЧЕТЫ И ВЫЧИСЛЕНИЯ БЕЗ ИСПОЛЬЗОВАНИЯ ФОРМУЛ</center>

В Excel можно выполнять самые простые вычисления без использования формул. Программа автоматически может посчитать: сумму или среднее арифметическое число, количество заполненных ячеек и т.п. у выделенном диапазоне.

Как быстро выполнить простые вычисления в Excel без использования формул? Ответ на этот вопрос рассмотрим более подробно на данном уроке.

### <center>ПРИМЕР БЫСТРЫХ ВЫЧИСЛЕНИЙ В EXCEL БЕЗ ФОРМУЛ</center>

Для примера возьмем простую табличку:

![img](/images/img.png)

Здесь нам нужно посчитать сумму и среднее значение всех выплат, а так же среднее число трех самых больших выплат. Для этого делаем следующее:

<ol>
    <li>
        Выделите диапазон C2:C7 и обратите внимание на правую сторону строки состояния, где уже отображаются готовые результаты простых вычислений:
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните правой кнопкой мышки по диапазону C2:C7 и выберите опцию: «Сортировка»-«Сортировка от максимального к минимальному». В результате появится диалоговое окно, в котором предлагается выбрать одно из двух действий. Для решения данной задачи подойдет любой вариант. Но чтобы не нарушать привязку данных выберем первый: «автоматически расширять выделенный диапазон». Потом нажимаем на кнопку «Сортировка». О том, что диапазон расширился, а таблица отсортирована по колонке C с привязкой к значениям других колонок, свидетельствует измененная очередность цифр в первой колонке.
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Выделяем первые 3 ячейки (C2:C4) и в строке состояния мы получаем их сумму и среднее значение.
        ![img](/images/img.png)
    </li>
</ol>

_Примечание. Если в пункте 2 сначала снять выделение с диапазона и сделать щелчок правой кнопкой мышки, просто по любой ячейке в пределах C2:C7, то вся таблица автоматически сортируется с привязкой всех данных. Без появления диалогового окна._

Excel умеет самостоятельно распознавать диапазоны таблиц если они не содержат пустых строк или столбцов. Обратите внимание, первая строка таблицы автоматически распознается как заголовки столбцов и не участвует в сортировке.

**Внимание!** Если щелкнуть правой кнопкой мышки по строке состояния появится контекстное меню, в котором можно настраивать элементы отображаемой информации.

![img](/images/img.png)

В строке состояния можно сразу получать результаты простых вычислений без формул:

<ul>
    <li>максимальное или минимальное значение ячеек выделенного диапазона без сортировки;</li>
    <li>отображение количества только чисел и др.</li>
</ul>

А при необходимости можно выключить лишние элементы, которые могут мешать в работе.

# <center>ФОРМАТИРОВАНИЕ ЯЧЕЕК</center>

## <center>КАК ИЗМЕНИТЬ ФОРМАТ ЯЧЕЙКИ В EXCEL БЫСТРО И КАЧЕСТВЕННО</center>

Изменение формата ячеек в Excel позволяет организовать данные на листе в логическую и последовательную цепочку для профессиональной работы. С другой стороны неправильное форматирование может привести к серьезным ошибкам.

Содержимое ячейки это одно, а способ отображения содержимого ячеек на мониторе или печати это другое. Перед тем как изменить формат данных в ячейке Excel следует запомнить простое правило: «Все, что содержит ячейка, может быть по-разному представлено, а презентация отображения данных зависит от форматирования». Это легко понять, если показать на примере. Посмотрите, как с помощью форматирования можно отображать число 2 разными способами:

![img](/images/img.png)

Большинство пользователей Excel пользуются исключительно стандартными инструментами форматирования:

<ul>
    <li>кнопками на панели «Главная»;</li>
    <li>готовые шаблоны форматов ячеек доступных в диалоговом окне открыто с помощью комбинацией горячих клавиш CTRL+1.</li>
</ul>

### <center>ФОРМАТЫ ДАННЫХ ВВОДИМЫХ В ЯЧЕЙКИ ЭЛЕКТРОННОЙ ТАБЛИЦЫ</center>

Диапазон ячеек A2:A7 заполните цифрой 2 и отформатируйте все ячейки так как показано выше на рисунке.

Решение задачи:

<ol>
    <li>
        Выделите диапазон A2:A7 введите число 2 и нажмите комбинацию клавиш CTRL+Enter.
    </li>
    <li>
        В ячейке A2 должен быть формат «Общий он в программе Excel задан по умолчанию. Поэтому сразу переходим на ячейку A3. Щелкаем по инструменту «Главная»-«Число»-«Увеличить разрядность» (увеличение количества отображаемых чисел после запятой).
    </li>
    <li>
        Перейдите на ячейку A4 и нажмите инструмент «Главная»-«Число»-«Процентный формат» или комбинацию горячих клавиш CTRL+SHIFT+5. Или просто введите 200% вручную и форматирование для ячейки присвоится автоматически.
    </li>
    <li>
        Кликните по ячейке A5 и щелкните по инструменту «Финансовый числовой формат», он немного отличается от денежного, но об этом далее…
    </li>
    <li>
        Сделайте активной ячейку A6 и щелкните на угловую кнопку со стрелкой в низ в разделе «Главная»-«Число» или нажмите комбинацию клавиш CTRL+1. В появившемся окне на закладке «Число» выберите из раздела «Числовые форматы:» опцию «Дата», а в разделе «Тип:» укажите соответствующий способ отображения дат. В разделе «Образец:» отображается предварительный просмотр отображения содержимого ячейки.
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Переходим в ячейку A7 так же жмем комбинацию клавиш CTRL+1 для вызова диалогового окна «Формат ячеек», только в этот раз выбираем опцию «Время».
    </li>
</ol>

Какие возможности предоставляет диалоговое окно формат ячеек? Функции всех инструментов для форматирования, которые содержит закладка «Главная» можно найти в этом диалоговом окне (CTRL+1) и даже больше.

В ячейке A5 мы воспользовались финансовым форматом, но есть еще и денежный, их очень часто путают. Эти два формата отличаются способом отображения:

<ul>
    <li>
        финансовый формат при отображении чисел меньше чем 0 ставит минус с левой стороны ячейки, а денежный ставит минус перед числом;
    </li>
    <li>
        денежный формат по умолчанию отображает отрицательные значения красным цветом шрифта (например, введите в ячейку значение -2р. и денежный формат присвоится автоматически);
    </li>
    <li>
        в финансовом формате после сокращения валют добавляется 1 пробел при отображении значений.
    </li>
</ul>

![img](/images/img.png)

Если нажать комбинацию горячих клавиш: CTRL+SHIFT+4, то ячейке присвоится денежный формат.

Что касается даты в ячейке A6, то здесь стоит упомянуть о правилах Excel. Формат даты считаются как последовательность дней от 1 января 1900 года. То есть если ячейка содержит значение – число 2, то это число в формате даты должно отображаться как 02.01.1900 и так далее.

Время для Excel – это значение чисел после запятой. Так как у нас в ячейке A7 целое число, время там отображено соответственно.

### <center>ФОРМАТ ДАТЫ СО ВРЕМЕНЕМ В EXCEL</center>

Отформатируем таблицу с данными так, чтобы значения в строках отображались соответственно названиям столбцов:

![img](/images/img.png)

В первом столбце форматы уже соответствуют его названию, поэтому переходим ко второму и выделяем диапазон B3:B7. Потом жмем CTRL+1 и на закладке «Число» указываем время, а в разделе «Тип:» выбираем способ отображения такой как указано на рисунке:

![img](/images/img.png)

Так же делаем с диапазонами C3:C7 и D3:D7, подбирая соответствующие форматы и типы отображения.

Если ячейка содержит значение больше чем 0, но меньше чем 1, то формат даты в третьем столбце будет отображаться как: 0 января 1900 года. В то время как в четвертом столбце дата уже отображается иначе благодаря другому типу (системы даты 1904 года, подробнее смотрите ниже). А если число <0, то значение будет отображаться так: «####», как ошибочное.

Обратите внимание, как отображается время в ячейках, которые содержат дробные числа.

Так как даты и время в Excel являются числами, значит с ними легко выполнять математические операции, но это рассмотрим на следующих уроках.

### <center>ДВЕ СИСТЕМЫ ОТОБРАЖЕНИЯ ДАТ EXCEL</center>

В Excel существует две системы отображения дат:

<ol>
    <li>Дата 1 января 1900 года соответствует числу 1.</li>
    <li>Дата 1 января 1904 года соответствует числу 0, а 1 это уже 02.01.1904 соответственно.</li>
</ol>

_Примечание. Чтобы все даты по умолчанию отображались по системе 1904 года можно в параметрах внести соответствующие настройки: «Файл»-«Параметры»-«Дополнительно»-«При пересчете этой книги:»-«Использовать систему дат 1904»._

Наглядно приводим пример отличия отображения дат в этих двух системах на рисунке:

![img](/images/img.png)

В справке Excel указаны минимальные и максимальные числа для дат обоих систем.

| **Система дат** | **Первая дата**               | **Последняя дата**                    |
| --------------- | ----------------------------- | ------------------------------------- |
| 1900	          | 1 января 1900 г. (значение 1) |	31 декабря 9999 г. (значение 2958465) |
| --------------- | ----------------------------- | ------------------------------------- |
| 1904	          | 2 января 1904 г. (значение 1) |	31 декабря 9999 г. (значение 2957003) |
| --------------- | ----------------------------- | ------------------------------------- |

Настройки изменения системы дат распространяются не только на конкретный лист, а на всю программу. Поэтому если нет острой необходимости их менять, то лучше пользоваться системой установленной по умолчанию – 1900 года. Это позволит избежать серьезных ошибок при выполнении математических операций с датами и временем.

## <center>НЕСТАНДАРТНОЕ УСЛОВНОЕ ФОРМАТИРОВАНИЕ ПО ЗНАЧЕНИЮ ЯЧЕЙКИ В EXCEL</center>

Условное форматирование позволяет экспонировать данные, которые соответствуют определенным условиям.

В Excel существует два вида условного форматирования:

<ol>
    <li>Присвоение формата ячейкам с помощью нестандартного форматирования.</li>
    <li>Задание условного формата с помощью специальных инструментов на вкладке «Файл»-«Стили»-«Условное форматирование».</li>
</ol>

Рассмотрим оба эти метода в деле и проанализируем, насколько или чем они отличаются.

Все кто связан с торговлей или предоставлением платных услуг используют таблицы Excel подобные как на рисунке ниже. Ведь каждый хочет знать, заработал или потерял после совершения сделки купли/продажи. Обычно формируется отчет, в котором следует найти наименее прибыльные или убыточные операции. Рационально выделить ячейки значения, которых соответствуют определенным условиям.

![img](/images/img.png)
![img](/images/img.png)

Для решения данной задачи выделим ячейки со значениями в колонке C и присвоим им условный формат так, чтобы выделить значения которые меньше чем 2. Где в Excel условное форматирование:

<ol>
    <li>Выделяем диапазон C2:C5 и выбираем инструмент: «Файл»-«Стили»-«Условное форматирование».</li>
    <li>В появившемся выпадающем списке выбираем опцию: «Правила выделения ячеек»-«Меньше».</li>
    <li>В диалоговом окне «меньше» указываем в поле значение 2, а напротив него выбираем из выпадающего списка желаемый формат. Жмем ОК.</li>
</ol>

«Светло-красная заливка и темно-красный текст» - это формат выделения значений, который предложен по умолчанию. Но из списка можно выбрать другие или решится на последний пункт: «Пользовательский формат». Сразу же появится знакомое нам окно из предыдущих уроков: «Формат ячеек». В нем вы можете задать свой стиль оформления ячейки, который будет отображаться только лишь при соблюдении условия.

Если отчет должен увеличиться, то можно выделить больше ячеек для присвоения условного форматирования. Но целый столбец форматировать условным форматированием не рекомендуется, чтобы не нагружать систему лишними процессами.

### <center>ПРАВИЛА УСЛОВНОГО ФОРМАТИРОВАНИЯ В EXCEL</center>

Теперь будем форматировать с условиями нестандартным способом. Сделаем так, чтобы при определенном условии значение получало не только оформление, но и подпись. Для этого снова выделяем диапазон C2:C5 и вызываем окно «Формат ячеек».

![img](/images/img.png)
![img](/images/img.png)

Переходим на вкладку «Число» выбираем опцию «(все форматы)» и в поле «Тип:» указываем следующее значение: _0;[Красный]"убыток"-0_.

Значение формата состоит из двух секций разделенных точкой с запятой. Сначала идет 0 и в этой левой секции можно задавать форматы для чисел равно или больше нуля. Правая секция служит для оформления отрицательных числовых значений.

Пользовательские форматы позволяют использовать от 1-ой до 4-х таких секций:

<ol>
    <li>В одной секции форматируются все числа.</li>
    <li>Две секции оформляют числа больше и меньше чем 0.</li>
    <li>Три секции разделяют форматы на: I)>0; II)<0; III)=0.</li>
    <li>Если секций аж 4, тогда последняя определяет стиль отображения текста.</li>
</ol>

По синтаксису код цвета должен быть первым элементом в любой из секций. Всего по умолчанию доступно 8 цветов:

<span class="ch">[Черный]</span><span class="b">[Белый]</span><span class="g">[Желтый]</span><span class="k">[Красный]</span><span class="f">[Фиолетовый]</span><span class="s">[Синий]</span><span class="gol">[Голубой]</span><span class="z">[Зеленый]</span>

### <center>УСЛОВНОЕ ФОРМАТИРОВАНИЕ ЦВЕТОМ В EXCEL</center>

Для продвинутых пользователей доступен код [ЦВЕТn] где n – это число 1-56. Например [ЦВЕТ50] – это бирюзовый.

Таблица цветов Excel с кодами:

![img](/images/img.png)

Теперь в нашем отчете о доходах скроем нулевые значения. Для этого зададим тот же формат, только в конце точка с запятой: 0;[Красный]"убыток"-0; - в конце (;) для открытия третей пустой секции.

Если секция пуста, значит, не отображает значений. То есть таким образом можно оставить и вторую или первую секцию, чтобы скрыть числа больше или меньше чем 0.

Используем больше цветов в нестандартном форматировании. Условия следующие:

<ul>
    <li>числа >100 в синем цвете;</li>
    <li>числа <=50 в зеленом цвете;</li>
    <li>все остальные – в красном.</li>
</ul>

В опции (все форматы) пишем следующее значение:

_<center>[Зеленый] [<=50]0;[Синий][>100]0;[Красный]0</center>_

![img](/images/img.png)

Как видно на рисунке нестандартное условное форматирование так же обладает широкой функциональностью.

Как упоминалось выше, секция должна начинаться с кода цвета (если нужно задать цвет), а после указываем условие:

<ul>
    <li>в квадратных скобках, а после способ отображения числа;</li>
    <li>число 0 значит отображение числа стандартным способом.</li>
</ul>

Для освоения информации по нестандартному форматированию рассмотрим еще, чем отличается использование символов # и 0.

Заполните новый лист как показано на рисунке:

![img](/images/img.png)

Во всех ячейках каждой колонки используйте нестандартный формат со значением первой строки.

Мы видим, что символ 0 отображает значение в ячейках как число, а если целых чисел недостаточно отображается просто 0.

Если же мы используем символ #, то при отсутствии целых чисел ничего не отображается.

Символ пробела служит как разделитель на тысячи.

Задача следующая. Нужно отобразить значения нестандартным способом:

<ul>
    <li>числа должны отображаться в формате «Общий»;</li>
    <li>нули будут скрыты;</li>
    <li>текст должен отображаться красным цветом.</li>
</ul>

**Решение:** _0; 0;;[Красный]@_

![img](/images/img.png)

_Примечание: символ @ - значит отображение любого текста, то есть сам текст указывать не обязательно._

Как видите здесь 4 секции. Третья пустая значит, нули будут скрыты. А если в ячейку будет введен текст, за него отвечает четвертая секция.

## <center>СТИЛИ ЯЧЕЕК В EXCEL И СРЕДСТВА УПРАВЛЕНИЯ ИМИ</center>

Стили в Excel – это инструмент, который позволяет существенно упростить и ускорить процесс форматирования документа. Стилям форматирования можно дать определение как сохраненные под определенным названием готовых настроек форматов. Их можно легко присвоить одной или множеству ячеек.

### <center>ПРИСВОЕНИЕ СТИЛЕЙ ФОРМАТИРОВАНИЯ ЯЧЕЙКАМ</center>

В каждом стиле определены следующие настройки:

<ol>
    <li>Шрифт (тип, размер, цвет и т.п.).</li>
    <li>Формат отображения чисел.</li>
    <li>Границы ячеек.</li>
    <li>Заливка и узоры.</li>
    <li>Защита ячеек.</li>
</ol>

Благодаря стилям все листы легко и быстро отформатировать. А если мы вносим изменение в стиль, то эти изменения автоматически присваиваются всем листам, которые им отформатированы.

В Excel предусмотрена библиотека из готовых тематических стилей, а так же присутствует возможность создавать собственные пользовательские стили.

Чтобы воспользоваться библиотекой встроенных стилей необходимо:

<ol>
    <li>
        Виделите в указанной на рисунке таблице не отформатированную область ячеек, но без заголовка.
        ![img](/images/img.png)
    </li>
    <li>
        Выберите инструмент: «Главная»-«Стили»-«Стили ячейки».
        ![img](/images/img.png)
    </li>
    <li>
        Из выпадающего списка миниатюр предварительного просмотра стиля, выберите понравившейся Вам.
    </li>
</ol>

### <center>СОЗДАНИЕ ПОЛЬЗОВАТЕЛЬСКОГО СТИЛЯ ПО ОБРАЗЦУ</center>

Теперь создадим свой пользовательский стиль, но по образцу уже готового:

<ol>
    <li>Выделите первую строку таблицы, чтобы отформатировать ее заголовок.</li>
    <li>
        Отобразите выпадающий список встроенных стилей и щелкните правой кнопкой мышки по «Заголовок 2». А из контекстного меню выберите опцию «Дублировать».
        ![img](/images/img.png)
    </li>
    <li>
        В диалоговом окне, укажите имя стиля «Новый заголовок» и, не изменяя настроек жмите на кнопку «Формат».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне «Формат ячеек» внесите свои изменения. На вкладке шрифт укажите темно-зеленый цвет. А шрифт измените на «курсив». Далее ОК и снова ОК.
    </li>
    <li>
        Присвойте Ваш стиль на главной панели: «Стили ячейки»-«Пользовательские»-«Новый заголовок».
    </li>
</ol>

![img](/images/img.png)

Таким образом, на основе встроенного стиля мы создали дубликат, который изменили под свои потребности.

Можно ли изменять стиль в Excel? В принципе можно было и не создавать дубликат, а в контекстном меню сразу выбрать «Изменить». Все изменения любого встроенного стиля по умолчанию, сохранились бы только в текущей книге. На настройки программы они не влияют. И при создании новой книги библиотека стилей отображается стандартно без изменений.

Можно ли удалить стиль в Excel? Конечно можно, но только в рамках одной книги. Например, как удалить пользовательские стили в Excel?

Выбираем желаемый стиль на главной панели: «Стили ячейки» и в разделе «Пользовательские» щелкаем правой кнопкой мышки. Из появившегося контекстного меню выберем опцию «Удалить». В результате ячейки очистятся от форматов заданных соответствующим стилем.

Точно так же можно удалить стили в Excel встроенные по умолчанию в библиотеке, но данное изменение будет распространяться только на текущую книгу.

### <center>СОЗДАТЬ СТИЛЬ ПО ФОРМАТУ ЯЧЕЙКИ</center>

Но что если нужно создать стиль на основе пользовательского формата ячеек, который задан обычным способом.

<ol>
    <li>Задайте пустой ячейке формат с изменением заливки и цвета шрифта.</li>
    <li>Теперь выделите эту исходную ячейку и выберите инструмент на главной панели: «Стили ячейки»-«Создать стиль ячейки».</li>
    <li>В окне «Стиль» укажите имя стиля «Как в ячейке1» и нажмите ОК.</li>
</ol>

Теперь у Вас в разделе стилей «Пользовательские» отображается имя «Как в ячейке1». Принцип понятен.

Все выше описанные стилевые форматы сохраняются в рамках файла текущей книги Excel. Поэтому для дальнейших действий сохраните эту книгу под названием «Урок о стилях.xlsx».

### <center>КОПИРОВАНИЕ СТИЛЯ В ДРУГИЕ КНИГИ</center>

Иногда возникает необходимость использовать текущие стили и в других книгах. Для этого можно просто скопировать их:

<ol>
    <li>Создайте новую книгу, в которой будем использовать пользовательский стиль «Как в ячейке1».</li>
    <li>Откройте книгу «Урок о стилях.xlsx» из сохраненным исходным требуемым нам стилем.</li>
    <li>Выберите инструмент на главной закладке: «Стили ячейки»-«Объединить». И в окне «Объединение стилей» укажите на нужную нам книгу и ОК.</li>
</ol>

![img](/images/img.png)

Теперь все пользовательские или измененные форматы из исходной книги скопированы в текущую.

Если Вам нужно будет часто использовать один стиль в разных книгах, тогда есть смысл создать специальную книгу со своими стилями и сохранить ее как шаблон. Это будет значительно удобнее чем каждый раз копировать… А все преимущества шаблонов подробнее рассмотрим на следующих уроках.

Форматирование в Excel – это очень утомительное, но важное задание. Благодаря стилям мы можем существенно ускорить и упростить данный рабочий процесс. Сохраняя при этом точную копию форматов ячеек в разных листах и книгах.

## <center>СОЗДАНИЕ ШАБЛОНОВ И ТЕМ ДЛЯ БЫСТРОГО ФОРМАТИРОВАНИЯ В EXCEL</center>

Шаблон формата Excel может быть как библиотекой наборов стилей форматирования, так и готовым документом с таблицами, данными, форматами и графиками. В шаблоны-документы достаточно только ввести свои данные, чтобы получить готовый, тематически стильно оформленный, презентабельный отчет. Например, «**Семейный бюджет**» – очень полезный встроенный шаблон в Excel.

### <center>СОЗДАНИЕ ШАБЛОНА В EXCEL</center>

Создадим свой новый шаблон, в котором следует использовать стили форматирования. Как форматировать с помощью стилей мы знаем из предыдущего урока: **стили ячеек и средства управления ими**. Чтобы сделать шаблон в Excel, выполним определенный ряд действий, которые послужат практическим примером для решения данной задачи:

<ol>
    <li>
        Сначала нужно сделать шаблон таблицы Excel и график, как показано ниже на рисунке. И присвойте ей пользовательский стиль форматирования.
        ![img](/images/img.png)
    </li>
    <li>
        Сохраняем документ как шаблон: «Файл»-«Сохранить как». В окне сохранения можно указать любую папку, так как Excel потом автоматически перенесет этот файл в специальную директорию для хранения нестандартных шаблонов.
    </li>
    <li>
        В поле тип файла следует указать «Шаблоны формата Microsoft Office Excel *.xltx». Заметьте, как только мы выбираем этот тип файла, автоматически открывается папка «Шаблоны» в окне сохранения документа.
        ![img](/images/img.png)
    </li>
    <li>
        В поле: «Имя файла» введите любое название шаблона. Например, «мои расходы». И жмите СОХРАНИТЬ.
    </li>
    <li>
        После сохранения закройте документ.
    </li>
</ol>

Теперь чтобы использовать наш шаблон достаточно выбрать меню: «Файл»-«Создать»-«Мои шаблоны». Выберите свой шаблон «мои расходы».

![img](/images/img.png)

Откройте и сохраните этот документ как обычный файл в формате *.xlsx. А теперь обратите внимание на то, что наш пользовательский стиль так же сохранен в данной книге.

Таким образом, у вас есть готовая форма для быстрого создания отчетов, в которой нужно только изменять данные и не нужно ничего форматировать. Это очень удобно и продуктивно. Используйте возможности шаблонов по максимуму!

### <center>СОЗДАНИЕ ФАЙЛА ПО ШАБЛОНУ EXCEL</center>

Можно установить свой пользовательский шаблон, по которому будет оформлен и отформатирован документ при каждом запуске программы Excel. Для этого следует сохранить файл с расширением *.xlsx в папке XLSTART. Данная папка создается при установке программы Excel. Чтобы легко найти путь к ней следует перейти в режим VisualBasic (Alt+F11) и открыть окно: «View»-«Immediate». А там следует набрать код: ? **application.StartupPath** и нажать Enter. Ниже отобразиться путь:

_<center>C:\Users\имя пользователя\AppData\Roaming\Microsoft\Excel\XLSTART</center>_

![img](/images/img.png)

_Примечание. В разных версиях Windows путь к XLSTART может отличаться, поэтому лучше узнать его через выше описанные действия._

Теперь при каждой загрузке программы будет открыт файл который лежит в этой папке. Более того если вы сохраните там несколько документов, то все они будут открыты при каждой запуске программы.

**Полезный совет!** Если в папке XLSTART сохранить отформатированный шаблон с именем Лист.xltx. То каждый новый созданный лист будет иметь такой же формат как Лист.xltx. При том не зависимо, в какой способ создан новый лист, через меню или комбинацией горячих клавиш SHIFT+F11. Формат будет один и тот же. А чтобы отменить такую функцию нужно просто удалить этот шаблон из XLSTART.

Форматирование документов – это важный, но очень утомительный процесс. Для его автоматизации существует несколько полезных инструментов такие как: темы, стили и шаблоны. Каждый из них обладает своими преимуществами и недостатками. Например, самый простой способ автоматизации форматирования – это стили. Они облегчаю пользователю процесс форматирования, но могут быть сохранены только в рамках одной книги. Да созданные или измененные пользователем стили можно скопировать в другую книгу. Или создать отдельную, специальную книгу с целым набором свих пользовательских стилей, чтобы копировать их в другие документы, но это крайне неудобно. Для решения такой задачи лучше использовать шаблоны.

### <center>СОЗДАНИЕ ТЕМЫ ДОКУМЕНТА ДЛЯ АВТОМАТИЧЕСКОГО ФОРМАТИРОВАНИЯ</center>

Тема Excel – это собрание стилей, цветов, шрифтов и много разных графических свойств форматирования, которые легко можем менять в пару кликов мышкой для изменения стильного оформления документа. Темы стали доступны начиная с 2007-й версии и новее. Их можно встретить и в других продуктах входящих в пакет MS Office.

Для примера возьмем простой не форматированный документ и будем присваивать ему разные темы пока не выберем подходящую к данным. Заодно посмотрим, что произойдет выбрать другую тему Excel:

<ol>
    <li>
        Создайте новую книгу и заполните ее данными (начиная со столбца H) так как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>Выберите инструмент: «Разметка страницы»-«Темы».</li>
    <li>
        В выпадающем списке наводите курсор мышки на разные темы и обратите внимание на то, как меняется стиль оформления данных документа.
        ![img](/images/img.png)
    </li>
    <li>Щелкните по подходящей теме, которая на Ваш взгляд наиболее подходит к данному документу.</li>
</ol>

**Внимание!** Темы присваиваются к целому документу. Поэтому нельзя для разных листов задавать разные темы форматирования.

Пользователь имеет возможность самостоятельно создавать и редактировать любую тему. Для этого доступны 3 инструмента, которые находятся рядом возле тем:

<ul>
    <li>цвета;</li>
    <li>шрифты;</li>
    <li>эффекты.</li>
</ul>

Каждый из этих инструментов открывает целые предопределенные наборы для настройки темы. Можно создавать новые наборы шрифтов или наборы цветов, только нельзя создать новые эффекты. Приходится использовать только те, которые предложены программой по умолчанию.

![img](/images/img.png)

Как только вы сохраните новый набор шрифтов и/или цветов под своим названием, тогда она будет доступна в разделе тем как для Excel, так и для других программ из пакета MS Office (Word, PowerPoint и др.).

# <center>ЗАЩИТА ДАННЫХ</center>

## <center>ЗАЩИТА ФАЙЛА EXCEL ПАРОЛЕМ И ШИФРОВАНИЕМ</center>

Excel позволяет паролем ограничивать доступ пользователям к документам на разных уровнях защиты.

Существует 3 базовых вида защиты паролем файлов Excel:

<ol>
    <li>Защита открытия документа.</li>
    <li>Защита от изменения данных в документе.</li>
    <li>Шифрование файлов.</li>
</ol>

Далее рассмотрим все виды более подробно.

### <center>КАК ПОСТАВИТЬ ЗАЩИТУ НА ФАЙЛ</center>

Для наглядного примера установим несколько паролей на 1 документ, используя разные виды защиты:

<ol>
    <li>Выберите опцию: «Файл»-«Сохранить как».</li>
    <li>
        В появившимся окне щелкните на кнопку «Сервис» и выберите опцию «Общие параметры».
        ![img](/images/img.png)
    </li>
    <li>
        В следующем появившемся окне задайте разные значения в поля: «Пароль для открытия» и «Пароль для изменения». Также отметьте галочками опции: «Всегда создавать резервную копию» и «Рекомендовать доступ только для чтения».
        ![img](/images/img.png)
    </li>
    <li>
        Дальше Excel попросит ввести повторно сначала пароль на открытие, а потом пароль на изменение документа. После повторного ввода паролей следует выполнить стандартную процедуру сохранения файла с указанием его имени и выбора папки.
    </li>
</ol>

_Примечание. В окне «Общие параметры» каждая опция функционирует независимо. Например, можно только задать пароль на открытие документа или только отметить опцию для постоянного резервирования копии документа и т.д._

Описание функций параметров окна «Общие параметры»:

<ol>
    <li>
        Всегда создавать резервную копию. При сохранении документа вместе с исходным основным файлом *.xlsx, создается в том же каталоге файл резервной копии с расширением *.xlk. Фактически это полная копия исходного файла со всеми его сохранениями в процессе работы с документом.
    </li>
    <li>
        Пароль для открытия файла. Если введен пароль он будет запрашиваться при каждом открытии документа. Пока пользователь не введет правильный пароль – документ не откроется. И не будут доступны данные даже для чтения.
    </li>
    <li>
        Пароль для изменения документа. Если документ защищен этим паролем, то он откроется в режиме «только чтение». Данные можно просматривать, но нельзя изменять.
    </li>
    <li>
        Рекомендовать доступ только для чтения. Если данная опция включена, то при каждом открытии документа, будет отображаться диалоговое окно с рекомендацией просматривать его в режиме для чтения. Но пользователю будет доступен выбор, в каком режиме открыть документ: в полном доступе или только для чтения.
    </li>
</ol>

_Примечание. Кнопка «Сервис» и опция «Общие параметры» в диалоговом окне сохранения документа доступна и в других программах входящих в пакет MS Office (Word, PowerPoint и др.). Интерфейс настройки общих параметров немного отличается от Excel, но в целом все интуитивно понятно и подобно._

### <center>ШИФРОВАНИЕ ФАЙЛА С ПАРОЛЕМ</center>

Чтобы поставить защиту в Excel более надежную от взлома, следует воспользоваться встроенной функцией шифрования книги. Ведь существуют программы, которые позволяют снять защиту с файла Excel. Например, такие как Advanced Excel Password Recovery. В этой программе невинное описание: «программа предназначена для восстановления забытых паролей к файлам Excel». Но все мы прекрасно понимаем основное предназначение данного софта.

Для шифрования файлов следует выбрать инструмент: «Файл»-«Сведения»-«Защитить книгу»-«Зашифровать паролем». В окне «Шифрование документа» введите пароль для максимальной защиты файла в Excel.

![img](/images/img.png)

**Внимание!** Для максимальной надежности запаковывайте в архивы с паролем и максимальным сжатием зашифрованные файлы Excel. Это будет еще более надежный способ защиты информации в документах. Так же используйте сложные и длинные пароли с использованием спецсимволов альт-кодов. Например, код Alt+3(на цифровой клавиатуре) = ♥.

### <center>ЗАЩИТА СТРУКТУРЫ КНИГИ</center>

Excel позволяет защищать паролем файлы как целиком, так и отдельными частями. Сейчас займемся селективной (выборочной) защитой документов.

Чтобы сохранить от изменений только структуру документа с помощью пароля делаем следующее:

<ol>
    <li>
        Выберите инструмент: «Рецензирование»-«Защитить книгу»
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне «Защита структуры и окон» включите опцию «структуру» и введите пароль. Нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

_Примечание. Для решения данной задачи можно пойти другим путем: «Файл»-«Сведения»-«Разрешения»-«Защитить структуру книги»._

Если структура книги защищена паролем – это значит что нельзя:

<ol>
    <li>Переносить, удалять, копировать, переименовывать все существующие листы.</li>
    <li>Вставлять (создавать) новые листы и даже листы диаграмм.</li>
    <li>Переносить или копировать листы в другие книги.</li>
    <li>Отображать скрытые листы.</li>
    <li>Ограничение некоторых операций выполняемых с помощью кода VBA-макросов.</li>
</ol>

**Полезный совет.** Защиту структуры книги часто используют для запрета отображения скрытых листов, в которых хранятся простые базы данных для: простых приложений, созданных средствами Excel или выпадающих списков и т.п.

## <center>КАК НАСТРОИТЬ АВТОСОХРАНЕНИЕ ДОКУМЕНТА В EXCEL</center>

Каждый пользователь, который терял существенную часть своей работы по причине зависания или сбоя компьютера знает, насколько важно вовремя сохранять документы. Когда мы работаем, вся информация хранится в оперативной памяти, а когда сохраняем документ, она записывается на диск. Из оперативной памяти легко потерять данные, а жесткий диск уже надежно их сохраняет.

Всем пользователям рекомендуется правильно организовать процесс ручного сохранения данных:

<ol>
    <li>
        После создания нового документа рекомендуется сразу сохранить его на диск «Файл»-«Сохранить как». И только потом выполнять в документе различные операции.
    </li>
    <li>
        Регулярно периодически после любых изменений (чем чаще, тем лучше) сохранять текущую версию файла с помощью кнопки «Сохранить» на панели быстрого доступа. Или используя комбинацию горячих клавиш CTRL+S.
    </li>
</ol>

К сожалению, большинство пользователей, даже профессионального уровня, так увлекаются процессом работы, что часто забывают периодически сохранять изменения в документе. В момент сбоя иди зависания компьютера – это приводит к безвозвратной утери проделанной работы определенного объема. Потому стоит решение данной проблемы перепоручить самому Excel.

### <center>КАК ВКЛЮЧИТЬ АВТОСОХРАНЕНИЕ В EXCEL</center>

Чтобы сделать автосохранение в Excel через заданный промежуток времени, следует выполнить следующее:

<ol>
    <li>
        Выберите «Файл»-«Параметры»-«Сохранение».
        ![img](/images/img.png)
    </li>
    <li>
        В разделе «Сохранение книг», нужно поставить галочкой в пункт «Автосохранение». И укажите интервал периодичности автоматического сохранения документов.
    </li>
    <li>Так же важно отметить пункт: «Сохранять последнюю автосохраненную версию при закрытии».</li>
    <li>Можно задать путь к желаемой папке, где будут сохраняться документы после автовосстановления.</li>
    <li>После всех изменений подтверждаем нажатием кнопки «ОК» .</li>
</ol>

_Примечание. Обратите внимание, что в данном разделе настроек можно изменить папку, которая предлагается по умолчанию для сохранения новых документов - «Расположение файлов по умолчанию». То есть, вместо папки «Мои документы» можно указать любую другую часто используемую папку на Ваш выбор._

Таким образом, если Вы забыли сохранить изменения в документе, а Ваш компьютер дал сбой (по любой причине), то будут утеряны только данные, проделаны на протяжении последних 10 минут (при настройках по умолчанию). Поэтому, в настройках лучше уменьшить значение данного параметра хотя-бы на 5 минут.

### <center>КАК ВОССТАНОВИТЬ ФАЙЛ EXCEL ИЗ АВТОСОХРАНЕНИЯ</center>

После первого запуска программы после сбоя, Excel автоматически предложит открыть последнюю сохраненную версию документа. Если же этого не произошло, тогда выберите: «Файл»-«Сведения»-«Управление версиями»-«Восстановить несохраненные книги»:

![img](/images/img.png)

Там же в списке «Версии» хранятся файлы автосохранений. Но если и этот вариант не работает, тогда можно самому вручную открыть автосохранение в Excel. Искать папку следует по пути заданному в выше описанных настройках. По умолчанию, скорее всего такой путь:

_<center>C:\Users\имя пользователя\AppData\Roaming\Microsoft\Excel\</center>_

Но в разных версиях Windows или Excel путь может отличаться. Чтобы узнать, куда сохраняет Excel в автоматическом режиме, нужно зайти в настройки и убедиться в правильности пути. Как описано выше.

_Примечание. Если файл был правильно закрыт (при этом неважно сохранен или нет), тогда папка автовосстановления будет пуста. При правильном закрытии документа его резервная копия автоматически удаляется. Поэтому, если вы закрываете несохраненный документ, выскакивает диалоговое окно, которое просит подтвердить Ваше действие._

Стоит отметить, что даже если у Вас настроена функция автоматического сохранения документов, не стоит игнорировать возможности ручного сохранения (CTRL+S). Всякое бывает… Известны случаи, в практике пользователей, когда автоматическое сохранение просто не срабатывает. Например, если компьютер завис в процессе выполнения сложных вычислительных операций в программе.

Любая информация должна быть сохранена до любого вероятного сбоя компьютера. Не сохраненные файлы Excel можно безвозвратно потерять при зависании или в момент сбоя компьютера. В таких ситуациях теряются данные из оперативной памяти, которые не записаны на жестком диске. Стоит помнить о регулярном ручном сохранении файлов, а возможности автостроения существенно помогут сберечь всю важную информацию и весь Ваш труд.

## <center>ЗАЩИТА ПЕРСОНАЛЬНЫХ ДАННЫХ В ФАЙЛЕ EXCEL</center>

Каждый файл Excel содержит информацию о Вас, такую как:

<ul>
    <li>имя пользователя компьютера;</li>
    <li>ваше личное имя и фамилия;</li>
    <li>адрес автора файла и другая контактная информация.</li>
</ul>

Всю информацию о себе, которую вы вводили при установке пакета MS Office, содержит каждый файл Excel. Если мы говорим о полной приватности не стоит забывать о примечаниях в ячейках, которые по умолчанию подписывают автора пользователя первой строкой. Да и сами ячейки могут содержать персональную информацию об авторе документа. Далее рассмотрим, как найти такого рода информацию и удалить ее из файлов Excel.

### <center>КАК УДАЛИТЬ ПЕРСОНАЛЬНУЮ ИНФОРМАЦИЮ ИЗ ФАЙЛА EXCEL</center>

Для наглядного примера выполните практическое задание:

<ol>
    <li>
        В любую ячейку (например, D2) введите примечание (SHIFT+F2). По умолчанию будет предложена первая строка с именем пользователя компьютера, он же считается автором документа. Пока не удаляйте ее, а просто допишите любой текст.
        ![img](/images/img.png)
    </li>
    <li>
        Сохраните документ и выберите инструмент: «Файл»-«Сведения». В правой части экрана щелкните по ссылке «Показать все свойства». Откроется подробная информация о файле, где указано много персональной информации о Вас: организация, руководитель, автор, кем изменен документ и др.
        ![img](/images/img.png)
    </li>
    <li>
        Для удаления всех персональных данных из файла выберите инструмент: «Файл»-«Сведения»-«Поиск проблем»-«Инспектор документов». В появившемся окне отметьте все пункты и нажмите проверить.
        ![img](/images/img.png)
    </li>
    <li>
        После поиска, при наличии проблем нажмите на кнопку «Удалить все».
    </li>
</ol>

![img](/images/img.png)

Теперь проверяем, снова открыв подробную информацию о файле: «Файл»-«Сведения»-«Показать все свойства». Как видим пусто:

<ul>
    <li>руководитель – укажите руководителя;</li>
    <li>автор – добавить автора;</li>
    <li>кем изменено – еще не сохранен (такой параметр будет теперь отображаться постоянно, даже после редактирования, сохранения и закрытия документа пользователем).</li>
</ul>

**Внимание!** Инструмент «Инспектор документов» не удаляет примечания, а только устраняет имя пользователя в первой строке, которое прописывается по умолчанию при создании нового примечания. А если документ содержит скрытые листы, то данный инструмент может удалить их безвозвратно! Если нажать на кнопку «Удалить все» напротив соответствующей проблемы. Данный факт легко протестировать своими руками.

## <center>ЗАЩИТА ЛИСТА И ЯЧЕЕК В EXCEL</center>

На лист можно поставить защиту, при которой все могут просматривать содержание листа, но нельзя ничего в нем изменять. Так же можно заблокировать все, кроме диапазона ячеек для ввода данных. А иногда можем просто скрыть формулы или источники данных.

### <center>КАК ПОСТАВИТЬ ЗАЩИТУ В EXCEL НА ЛИСТ</center>

В таблице данных защитим ячейки листа от изменений, данных в шапке и строке итоговых значений.

![img](/images/img.png)

<ol>
    <li>
        Выделите диапазон ячеек B2:B6 и вызовите окно «Формат ячеек» (CTRL+1). Перейдите на вкладку «Защита» и снимите галочку на против опции «Защищаемая ячейка». Нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Выберите инструмент «Рицензирование»-«Защитить лист».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне «Защита листа» установите галочки так как указано на рисунке. То есть 2 опции оставляем по умолчанию, которые разрешают всем пользователям выделять любые ячейки. А так же разрешаем их форматировать, поставив галочку напротив «форматирование ячеек». При необходимости укажите пароль на снятие защиты с листа.
    </li>
</ol>

</ins>Теперь проверим.</ins> Попробуйте вводить данные в любую ячейку вне диапазона B2:B6. В результате получаем сообщение: «Ячейка защищена от изменений». Но если мы захотим отформатировать любую ячейку на листе (например, изменить цвет фона) – нам это удастся без ограничений. Так же без ограничений мы можем делать любые изменения в диапазоне B2:B6. Как вводить данные, так и форматировать их.

Как видно на рисунке, в окне «Защита листа» содержится большое количество опций, которыми можно гибко настраивать ограничение доступа к данным листа.

### <center>КАК СКРЫТЬ ФОРМУЛУ В ЯЧЕЙКЕ EXCEL</center>

Часто бывает так, что самое ценное на листе это формулы, которые могут быть достаточно сложными. Данный пример сохраняет формулы от случайного удаления, изменения или копирования. Но их можно просматривать. Если перейти в ячейку B7, то в строке формул мы увидим: «СУММ(B2:B6)» .

Теперь попробуем защитить формулу не только от удаления и редактирования, а и от просмотра. Решить данную задачу можно двумя способами:

<ol>
    <li>Запретить выделять ячейки на листе.</li>
    <li>Включить скрытие содержимого ячейки.</li>
</ol>

Рассмотрим, как реализовать второй способ:

<ol>
    <li>Если лист защищенный снимите защиту выбрав инструмент: «Рецензирование»-«Снять защиту листа».</li>
    <li>
        Перейдите на ячейку B7 и снова вызываем окно «Формат ячеек» (CTRL+1). На закладке «Защита» отмечаем опцию «Скрыть формулы».
        ![img](/images/img.png)
    </li>
    <li>Включите защиту с такими самыми параметрами окна «Защита листа» как в предыдущем примере.</li>
</ol>

Теперь переходим на ячейку B7 и убеждаемся в том, что в строке формул ничего не отображается. Даже результат вычисления формулы.

![img](/images/img.png)

_Примечание. Закладка «Защита» доступна только при незащищенном листе._

### <center>КАК СКРЫТЬ ЛИСТ В EXCEL</center>

Допустим нам нужно скрыть закупочные цены и наценку в прайс-листе:

<ol>
    <li>Заполните «Лист1» так как показано на рисунке. Здесь у нас будут храниться закупочные цены.</li>
    <li>
        Скопируйте закупочный прайс на «Лист2», а в место цен в диапазоне B2:B4 проставьте формулы наценки 25%: =Лист1!B2*1,25.
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните правой кнопкой мышки по ярлычке листа «Лист1» и выберите опцию «Скрыть». Рядом же находится опция «Показать». Она будет активна, если книга содержит хотя бы 1 скрытый лист. Используйте ее, чтобы показать все скрытие листы в одном списке. Но существует способ, который позволяет даже **скрыть лист в списке** с помощью VBA-редактора (Alt+F11).
        ![img](/images/img.png)
    </li>
    <li>
        Для блокировки опции «Показать» выберите инструмент «Рецензирование»-«Защитить книгу». В появившемся окне «Защита структуры и окон» поставьте галочку напротив опции «структуру».
        ![img](/images/img.png)
    </li>
    <li>
        Выделите диапазон ячеек B2:B4, чтобы в формате ячеек установить параметр «Скрыть формулы» как описано выше. И включите защиту листа.
    </li>
</ol>

**Внимание!** Защита листа является наименее безопасной защитой в Excel. Получить пароль можно практически мгновенно с помощью программ для взлома. Например, таких как: Advanced Office Password Recovery – эта программа позволяет снять защиту листа Excel, макросов и т.п.

**Полезный совет!** Чтобы посмотреть скрытые листы Excel и узнать их истинное количество в защищенной книге, нужно открыть режим редактирования макросов (Alt+F11). В левом окне «VBAProject» будут отображаться все листы с их именами.

![img](/images/img.png)

Но и здесь может быть закрыт доступ паролем. Для этого выбираем инструмент: «Tools»-«VBAProjectProperties»-«Protection» и в соответствующих полях вводим пароль. С другой стороны, если установленные пароли значит, книга скрывает часть данных от пользователя. А при большом желании пользователь рано или поздно найдет способ получить доступ этим к данным. Об этом следует помнить, когда Вы хотите показать только часть данных, а часть желаете скрыть! В данном случае следует правильно оценивать уровень секретности информации, которая предоставляется другим лицам. Ответственность за безопасность в первую очередь лежит на Вас.

_Примечание. Группировка при защите листа Excel – не работает при любых настройках. Сделать доступную в полноценном режиме функцию группировки на защищенном листе можно только с помощью макросов._

## <center>СКРЫТЬ ЛИСТ В СПИСКЕ СКРЫТЫХ ЛИСТОВ EXCEL</center>

Скрывать листы можно используя контекстное меню, вызванное правой кнопкой мышки по ярлычку листа. Как было описано в предыдущем уроке. Но листы можно скрывать так, чтобы их не было видно даже в списке скрытых листов. Причем без использования защиты структуры книги. Для реализации данной задачи нужно воспользоваться параметрами, которые доступны в режиме VBA-редактора (Alt+F11).

### <center>КАК ЛУЧШЕ СКРЫТЬ ЛИСТ В EXCEL</center>

Для наглядности разберем пример. Скройте «Лист3» обычным способом (с помощью опции «Скрыть» в контекстном меню).

![img](/images/img.png)

А «Лист2» скроем параметрами VBA-редактора макросов. Для этого выполним следующие действия:

<ol>
    <li>
        Откройте VBA-редактор, нажав комбинацию горячих клавиш Alt+F11.
    </li>
    <li>
        В окне «Project» выберите «Лист2». А в окне «Properties» найдите свойство «Visible» и выберите ему параметр «2-xlSheetVeryHidden». И закройте окно редактора.
        ![img](/images/img.png)
    </li>
    <li>
        Чтобы показать скрытые листы Excel, щелкните правой кнопкой мышки по ярлычку листа и выберите опцию «Показать».
    </li>
</ol>

![img](/images/img.png)

В списки скрытых листов мы не видим наш «Лист3». Он надежно спрятан. Чтобы снова его увидеть нужно зайти в VBA-редактор и поменять параметры в свойстве «Visible» на «-1-xlSheetVisible».

_Примечание. Третий параметр «0-xlSheetHidden» дает тот же результат что и обычное скрытие листа при помощи контекстного меню._

**Полезный совет.** Визуально можно скрыть ярлыки листов:

<ol>
    <li>
        С помощью настроек параметров: «Файл»-«Параметры»-«Дополнительно»-«Показывать ярлычки листов».
        ![img](/images/img.png)
    </li>
    <li>С помощью расширения горизонтальной прокрутки, как показано на рисунке:</li>
</ol>

![img](/images/img.png)

Но и в первом и во втором случаи между листами можно переключатся с помощью комбинации горячих клавиш CTRL+PageUp и CTRL+PageDown.

### <center>ПОЛЕЗНЫЙ ЛАЙФХАК В EXCEL</center>

Чтобы запретить вставку новых строк и столбцов в Excel без использования защиты листа нужно сделать так:

<ol>
    <li>
        Перейдите в последнюю ячейку относительно строк и столбцов XFD1048576. Для этого можно ввести в поле имя адрес ячейки XFD1048576 и нажать Enter. А если лист пустой можно нажать комбинацию горячих клавиш CTRL+ → (стрелка влево) чтобы сместить курсор в последний столбец XFD1, а потом CTRL+ ↓ (стрелка вниз) смесит курсор в последнюю ячейку XFD1048576.
        ![img](/images/img.png)
    </li>
    <li>Введите в последнюю ячейку XFD1048576 любое значение, можно даже пробел « ».</li>
</ol>

Вот и все теперь в лист нельзя вставить строку или столбец. Если нужно запретить вставлять только строки, тогда вводим любое значение в самую последнюю строку (например, A1048576). А если запретить вставлять только столбцы тогда вводим любое значение в последнем столбце (например, XFD1).

Надежное скрытие листов, которых нельзя отобразить стандартными средствами (опцией Показать). Полезные лайфхаки для работы с листами и ячейками.

## <center>ПРОВЕРКА ВВОДА ДАННЫХ В EXCEL И ЕЕ ОСОБЕННОСТИ</center>

Иногда возникает необходимость перестраховаться от ошибок перед вводом в ячейки данных несоответствующим определенным условиям. Например, в номенклатуре магазина товаров и цен недолжно быть возможности ввода отрицательных чисел и нулей. Ведь магазин не раздает товар с доплатой или за бесплатно.

### <center>ПРОВЕРКА ВВОДИМЫХ ДАННЫХ В EXCEL</center>

Для того, чтобы предотвратить ошибки оператора компьютерного набору в Excel, будем использовать проверку данных ввода. Тем самым создадим ему комфортные условия для рутинной работы, где сложно не допустить ошибки.

У нас имеется лист номенклатуры товаров магазина:

![img](/images/img.png)

<ol>
    <li>
        Выделите столбец B и выберите инструмент «Данные»-«Проверка данных».
        ![img](/images/img.png)
    </li>
    <li>
        Заполняем значениями поля на вкладке «Параметры» как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        На вкладке «Сообщение для ввода» создаем особое примечание, в котором при помещения курсора на ячейку будет отображаться условия для ее заполнения. И жмем ОК.
        ![img](/images/img.png)
    </li>
</ol>

<ins>Теперь проверим.</ins> В ячейку B2 введите натуральное число, а в ячейку B3 отрицательное. Как видно в ячейке B3 действие оператора набора – заблокировано. Отображается сообщение об ошибке: «Введенное значение неверно».

_Примечание. При желании можно написать собственный текст для ошибки на третей закладке настроек инструмента «Сообщение об ошибке»._

Чтобы удалить проверку данных в Excel нужно: выделить соответствующий диапазон ячеек, выбрать инструмент и нажать на кнопку «Очистить все» (указано на втором рисунке).

### <center>ОСОБЕННОСТИ ПРОВЕРКИ ДАННЫХ</center>

Данным способом проверяются данные только в процессе ввода. Если данные уже введенные они будут не проверенные. Например, в столбце B нельзя ввести текст после установки условий заполнения в нем ячеек. Но заголовок в ячейке B1 «Цена» остался без предупреждения об ошибке.

**Внимание!** Если ячейки будут скопированы, а не введены то их значения так же не будут проверены.

Чтобы проверить соответствуют ли все введенные данные, определенным условиям в столбце и нет ли там ошибок, следует использовать другой инструмент: «Данные»-«Проверка данных»-«Обвести неверные данные».

![img](/images/img.png)

Если значения в столбце B должны соответствовать определенным условиям, но содержит ошибки, то все они будут обведены красным овалом. Этот инструмент очень удобно использовать, когда нужно проверить уже введенные или скопированные данные.

Конечно, можно выполнить проверку данных в столбце с помощью логической функции Excel – «ЕСЛИ». Или условное форматирование. Но применение инструмента «Проверка данных» – более эффективно, удобно и продуктивно для данной задачи. Особенно если нам нужно одновременно выполнить проверку по нескольким столбцам. В таком случаи более заметна рациональность его использования.

# <center>РАБОТА С ТАБЛИЦАМИ</center>

## <center>АВТОМАТИЧЕСКОЕ СОЗДАНИЕ ТАБЛИЦ EXCEL</center>

Инструмент «Форматировать как таблицу» – является новым и полезным средством для автоматического создания таблиц в Excel. Он ускоряет выполнения многих задач и позволяет предотвратить некоторые ошибки. Кардинально отличается от обычных форматированных границами диапазонов ячеек благодаря функциональным средствам, работающих автоматически или под управлением пользователя.

### <center>КАК СОЗДАТЬ УМНУЮ ТАБЛИЦУ В EXCEL</center>

Теперь рутинную работу с таблицами можно выполнить в автоматическом или полуавтоматическом режиме. Чтобы убедится в этом, начнем со смены обычной таблицы на автоматически форматированную и рассмотрим все ее свойства.

<ol>
    <li>
        Заполните диапазон ячеек данными, так как показано ниже на рисунке. Перейдите курсором на любую ячейку в пределах этого диапазона и выберите инструмент «Главная»-«Форматировать как таблицу» (CTRL+T).
        ![img](/images/img.png)
    </li>
    <li>
        Excel автоматически распознает диапазон данных, а так же заглавную строку и отобразит результат в диалоговом окне «Создание таблицы». Если вы согласны с параметрами – жмите ОК. В результате диапазон A1:C7 автоматически преобразуется в таблицу:
        ![img](/images/img.png)
    </li>
    <li>
        При автоматическом определении диапазона, Excel охватывает все ячейки до первой пустой строки и до первого пустого столбца. Это следует учитывать при подготовке данных, не оставляйте пустых ячеек.
        ![img](/images/img.png)
    </li>
    <li>
        Отличие автоматической таблицы от форматированных диапазонов:
    </li>
    <li>
        Автоматическое форматирование таблицы, стиль которого можно легко изменить, выбрав его из галереи готовых форматов.
    </li>
    <li>
        С правой стороны каждого заголовка столбца таблицы расположены кнопки с выпадающим меню форматирования и сортировки. Отображение этих кнопок можно отключить или включить, выбрав инструменты: «Главная»-«Фильтр и сортировка»-«Фильтр».
    </li>
    <li>
        В правом нижнем углу таблицы расположен маркер, перемещение которого позволяет изменять диапазон данных.
        ![img](/images/img.png)
    </li>
    <li>
        Как только таблица активна (или любая ее ячейка) сразу активируется панель «Работа с таблицами»-«Конструктор», которая содержит множество инструментов для настройки ее функций.
        ![img](/images/img.png)
    </li>
    <li>
        Если таблица активна, то при вертикальной прокрутке данных заголовки столбцов листа автоматически присваивают себе имена заголовков столбцов таблицы для удобного просмотра. Не нужно использовать закрепление областей
        ![img](/images/img.png)
    </li>
    <li>
        Сохранение стиля форматирования от изменений. Обратите внимание на рисунок. При вставке новой строки листа форматирование автоматически остается неизменяемым своему стилю. Это особенно полезно, когда выполняется **автоматическое добавление строк в таблицу Excel**.
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Если сделать изменения в формуле одной из ячеек, то все ячейки этого же столбца автоматически заполняться этой же формулой.
        ![img](/images/img.png)
    </li>
</ol>

Формулы в таблице отличаются от обычных формул, но их рассмотрим на следующих уроках.

### <center>СТИЛИ И ОФОРМЛЕНИЕ ДАННЫХ В ТАБЛИЦЕ</cnter>

Самый быстрый способ создать таблицу – это выделить диапазон и нажать комбинацию горячих клавиш CTRL+T. В такой способ таблица получает стиль, присвоенный по умолчанию (в галерее стилей он называется «средний 2»). Его можно изменить на более подходящий для Вас стиль. Тот, который вы часто используете в своих отчетах.

Изменим стиль форматирования таблицы, который присваивается по умолчанию:

<ol>
    <li>Раскройте галерею стилей и щелкните правой кнопкой по Вашему наиболее часто используемому стилю.</li>
    <li>Из появившегося контекстного меню выберите опцию: «По умолчанию»</li>
</ol>

![img](/images/img.png)

Теперь вы умеете устанавливать свой собственный стиль по умолчанию. Польза данной функции особенно ощутима, когда приходится создавать много таблиц, которые должны соответствовать тому или иному стилю.

Размер таблицы можно легко изменять, используя маркер в ее нижнем правом углу.

Расширьте таблицу для нового столбца данных. Для этого сместите маркер таблицы расположенный в нижнем правом углу вправо, так чтобы добавился еще один столбец.

![img](/images/img.png)

Смещая маркер можно добавлять и больше столбцов. Всем им будут автоматически присвоены заголовки «Столбец1», «Столбец2» и т.д. Название заголовком можно без проблем изменить на желаемые значения, с помощью ввода в их ячейки нового текста.

Этим же маркером можно добавлять в таблицу новые строки, смещая его вниз. Управляя маркером в любом направлении, мы управляем количеством строк и столбцов, которое должна содержать таблица. Нельзя только смещать маркер по диагонали, чтобы одновременно добавлять / удалять строки и столбцы.

## <center>АВТОМАТИЧЕСКОЕ ДОБАВЛЕНИЕ СТРОК И СТОЛБЦОВ В ТАБЛИЦУ EXCEL</center>

Добавление строк или столбцов в умной таблице не связано с добавлением строк на листе. Для подтверждения этого правила пронумеруем строки за пределами таблицы и добавим пару внутренних строк.

### <center>АВТОМАТИЧЕСКОЕ ДОБАВЛЕНИЕ СТРОК В ТАБЛИЦУ EXCEL</center>

Чтобы в таблицу автоматически добавилась строка достаточно под данными ввести новое значение:

<ol>
    <li>
        Создайте таблицу так как показано на рисунке.
        ![img](/images/img.png)
    </li>
    <li>
        В любую ячейку под таблицей (например, B7) введите значение и нажмите Enter
        ![img](/images/img.png)
    </li>
</ol>

В результате в таблицу автоматически добавилась новая строка.

**Интересный факт!** Новые строки таблиц не связаны со строками листа. Чтобы убедиться в этом сделаем следующее:

<ol>
    <li>
        Пронумеруйте строки в диапазоне A2:A6 так, чтобы номера были за пределами.
        ![img](/images/img.png)
    </li>
    <li>
        Вертикально выделите две ячейки в двух строках (например, B3:B4) и щелкните по ним правой кнопкой мышки.
        ![img](/images/img.png)
    </li>
    <li>
        Выберите опцию в контекстном меню: «Вставить»-«Строки таблицы выше». Или выделите одну ячейку и два раза нажмите CTRL+SHIFT+«+».
    </li>
</ol>

![img](/images/img.png)

Как видно одновременно вставилось 2 строки, та как было выделено 2 ячейки в двух строках. А номера каждой строки, которые находятся вне диапазона, остались без изменений и разрывов, что подтверждает независимость новых строк и столбцов таблицы от листа.

### <center>АВТОМАТИЧЕСКОЕ ДОБАВЛЕНИЕ СТОЛБЦОВ В ТАБЛИЦУ EXCEL</center>

Полезная функция – автоматическое расширение после ввода любых данных в смежные ячейки (по вертикали и по горизонтали). Если данные введены в ближайшей ячейке справа от таблицы – добавится столбец, а если под таблицей – строка.

Расширим таблицу с помощью ввода данных в смежную ячейку. В ячейку D1 введите текст «Прибыль» и автоматически добавится новый столбец. После ввода в ячейку справа от нее появился инструмент с выпадающим меню:

![img](/images/img.png)

<ol>
    <li>
        «Отменить авторазвертывание таблицы» – отменяет создание новой колонки. В этой ситуации для данной опции так же можно нажать комбинацию клавиш CTRL+Z – результат будет тот же.
    </li>
    <li>
        «Не развертывать таблицы автоматически» – опция полностью отключает автоматическое расширение всех таблиц при заполнении смежных ячеек.
    </li>
    <li>
        «Параметры автозамены» – открывает диалоговое окно «Автозамена» с активной закладкой «Автоформат при вводе».
    </li>
</ol>

![img](/images/img.png)

Чтобы снова включить автоматическое добавление строк и столбцов таблицы при заполнении ближайших ячеек следует открыть настройки программы: «Файл»-«Параметры»-«Правописание»-«Параметры автозамены»-«Автоформат при вводе». На данной вкладке отмечаем галочкой опцию: «Выполнять в ходе работы»-«Включать в таблицу новые строки и столбцы».

## <center>СТИЛИ ТАБЛИЦ EXCEL ДЛЯ АВТОМАТИЧЕСКОГО ФОРМАТИРОВАНИЯ ДИАПАЗОНОВ ЯЧЕЕК</center>

Excel предоставляет большую галерею готовых стилей автоматического форматирования таблицы. Так же предусмотрен предварительный просмотр при наведении курсора мышки на любой стиль из галереи. Стили можно применять для быстрого форматирования обычных диапазонов ячеек.

### <center>ПРИСВОЕНИЕ СТИЛЕЙ ТАБЛИЦЫ ОБЫЧНОМУ ДИАПАЗОНУ</center>

Для реализации данной задачи нам нужно создать таблицу, присвоить ей стиль, а потом отменить «Форматировать как таблицу».

Присвоим стиль форматирования авто-таблицы для обычного диапазона ячеек:

<ol>
    <li>
        На чистом листе выделите диапазон из пустых ячеек и выберите инструмент: «Главная»-«Форматировать как таблицу». Выберите из галереи желаемый стиль форматирования.
    </li>
    <li>
        В появившемся диалоговом окне «Создание таблицы» при необходимости можно отметить опцию «Таблица с заголовками» и нажмите Ок.
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните по таблице и на вспомогательной панели «Работа с таблицами»-«Конструктор» выберите инструмент «Преобразовать в диапазон» в разделе инструментов «Сервис». Или щелкните правой кнопкой мышки по таблице и в контекстном меню выберите: «Таблица»-« Преобразовать в диапазон». Это позволит отменить форматировать как таблицу Excel диапазон.
    </li>
</ol>

![img](/images/img.png)

Таблица преобразуется в обычный диапазон ячеек, который форматирован по ее стилю. Это так же очень быстрый и удобный способ форматирования ячеек. Так форматировать значительно быстрее, чем делать все с нуля. Достаточно только взять за основу готовый стиль из галереи, а потом внести свои изменения и дополнения деталей.

### <center>АВТОМАТИЧЕСКОЕ ФОРМАТИРОВАНИЕ С ПОМОЩЬЮ СТИЛЕЙ</center>

Выберем изменяем стиль автоматического форматирования таблицы:

<ol>
    <li>
        Создайте таблицу (CTRL+T) как показано на рисунке.
        ![img](/images/img.png)
    </li>
    <li>
        Перейдите на любую ячейку таблицы и выберите инструмент «Главная»-«Форматировать как таблицу» или «Работа с таблицами»-«Стили таблиц».
    </li>
    <li>
        Наводите и задержите курсор мышки на любой из предложенных готовых стилей галереи. Обратите внимание на таблицу, которая в предварительном просмотре отображает, как будет выглядеть присвоенный ей тот или иной стиль.
        ![img](/images/img.png)
    </li>
    <li>
        Сделайте щелчок левой кнопкой мышки и таблица будет автоматически сформатирована под выбранный Вами новый стиль.
    </li>
</ol>

Очень быстрый и удобный метод форматирования – это присвоение стиля с добавлением своих поправок или изменений при необходимости.

Если Вами будут внесены изменения в форматирования стиля, они сохранятся (при желании можно присвоить другой стиль). Например, если изменить фон одной ячейки на желтый цвет, то при выборе другого стиля эта же ячейка останется желтой.

### <center>ВЫДЕЛЕНИЕ ЭЛЕМЕНТОВ ТАБЛИЦЫ</center>

Протестируем способы выделения таблиц целиком и по-отдельности ее частей: строк и столбцов. Для решения данной задачи не обязательно активировать таблицу. Для неактивной таблицы достаточно сделать следующее:

<ol>
    <li>
        Для удобства сместим таблицу так чтобы в ее начале была пустая строка и пустой столбец (например в ячейка B2).
        ![img](/images/img.png)
    </li>
    <li>
        Наведите курсор мышки на верхний левый угол таблицы так, чтобы он сместился на косую черную стрелку по диагонали.
    </li>
    <li>
        Сделайте один щелчок левой кнопкой мышки и выделятся только значения данных таблицы. Еще раз щелкните так же и выделится вся таблица с заголовками и строкой итогов. Если щелкнуть еще раз то будет снова выделены только данные, так как эта функция работает в режиме переключателя.
    </li>
</ol>

![img](/images/img.png)

Способы выделения строк и столбцов быстрыми клавишами:

<ol>
    <li>
        Переместите курсор клавиатуры в область таблицы, чтобы она стала активной.
    </li>
    <li>
        Нажмите комбинацию горячих клавиш CTRL+A для выделения данных. Повторное нажатие CTRL+A выделит всю таблицу полностью.
    </li>
    <li>
        Щелкните по любой ячейке в диапазоне данных и наведите курсор мышки на край таблицы так, чтобы курсор изменился на крестик стрелок. Сделайте щелчок левой кнопкой мышки и выделится вся таблица.
    </li>
</ol>

Теперь выделяем строки и столбцы. В активной таблице можно нажать комбинацию горячих клавиш CTRL+Пробел, тогда выделится столбец данных. Тот, который содержит активную ячейку. А если нажать комбинацию SHIFT+Пробел, тогда выделяется строка соответствующая активной ячейке. Данная функция реализовывается и с помощью курсора мышки, если подвести его к заголовку одного столбца или в начало строки так, чтобы он изменил свой внешний вид на вертикальную или горизонтальную стрелку.

## <center>ВОЗМОЖНОСТИ УМНОЙ ТАБЛИЦЫ EXCEL В НОВЫХ ВЕРСИЯХ</center>

Возможности электронных таблиц Excel в новых версиях существенно выросли. Рассмотрим преимущества авто-таблиц в действии.

### <center>ОСНОВНЫЕ ВОЗМОЖНОСТИ ТАБЛИЦ</center>

На листе доходов и расходов отделов фирмы в разных городах записаны в одной таблице. В столбце D следует посчитать прибыль по отделам, а под таблицей нужно просуммировать все доходы и расходы.

![img](/images/img.png)

Очень приятным и полезным свойством таблицы является автоматическое заполнение целого столбца формулами, которые достаточно ввести только в одну ячейку. Вторым полезным свойством является функциональная строка итогов.

<ol>
    <li>В ячейку D1 введите заголовок прибыль и в таблице автоматически добавиться еще один столбец.</li>
    <li>
        В D2 введите формулу: =B2-C2. После ввода формула будет автоматически скопирована в каждую ячейку столбца «Прибыль».
        ![img](/images/img.png)
    </li>
    <li>
        Перейдите на любую ячейку в диапазоне таблицы выберите опцию: «Работа с таблицами»-«Строка итогов» или нажмите комбинацию горячих клавиш CTRL+SHIFT+T.
    </li>
</ol>

![img](/images/img.png)

К таблице добавилась функциональная строка итогов.

Как видно на рисунке Excel одновременно выполнил 2 операции:

<ol>
    <li>Автоматически добавлено и заполнил новый столбец «Прибыль»</li>
    <li>Подключено многофункциональную итоговую строку, которая предоставила много вычислительных возможностей для каждого столбца.</li>
</ol>

![img](/images/img.png)

Теперь достаточно перейти в ячейку B8, чтобы раскрыть выпадающий список и выбрать опцию «Сумма». Потом следует сделать так же в ячейке C8.

### <center>ВОЗМОЖНОСТИ ОБРАБОТКИ ДАННЫХ ТАБЛИЦЫ EXCEL</center>

По умолчанию Excel добавляет суммирование в строке итогов для последнего столбца.

В строке суммирования используется функция =ПРОМЕЖУТОЧНЫЕ.ИТОГИ(), вместо привычной =СУММ().

В аргументах функций используются внутренние адреса таблицы определенных заголовком таблицы: =ПРОМЕЖУТОЧНЫЕ.ИТОГИ(109;[Прибыль]) вместо D2:D7.

Если в выпадающем списке строки итогов выбрать вместо опции «Сумма» другую опцию: «Количество», «Максимум» и т.п., то Excel будет использовать туже самую функцию, изменив только один параметр – число 109 на: 103, 104 и т.п. (от 101 до 111).

![img](/images/img.png)

Стоит отметить, что числовые параметры 101-111 не включают при вычислении значения в скрытых строках, а параметры от 1-11 включают все значения даже в скрытых строках.

## <center>УДАЛЕНИЕ ДУБЛИКАТОВ В EXCEL С ПОМОЩЬЮ ТАБЛИЦ</center>

Возможности функций авто-таблицы позволяют сравнивать значения и устранять их дубликаты. Сразу стоит отметить, что одинаковые числовые значения с разным форматом ячеек в Excel воспринимаются как разные. Рассмотрим это правило на конкретном примере при удалении дубликатов.

### <center>КАК УДАЛИТЬ ДУБЛИКАТЫ В EXCEL</center>

Ниже на рисунке изображена таблица с дублирующими значениями. Строка 3 содержит тоже значение, что и строка 6. А значение строки 4 = строке 7. Ячейки с числами в дублирующихся строках имеют одинаковые значения и разные форматы. У них отличается количество разрядов после запятой. Выполним 2 разные операции для удаления дубликатов.

Устранение дубликатов на основе значений колонки с текстом:

<ol>
    <li>
        Создайте умную таблицу (CTRL+T) с повторяющимися значениями как на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните по таблице и выберите инструмент «Работа с таблицами»-«Конструктор»-«Удалить дубликаты» в разделе инструментов «Сервис».
        ![img](/images/img.png)
    </li>
    <li>В появившемся окне «Удалить дубликаты», следует отключить проверку по 4-му столбцу «Цена».</li>
</ol>

![img](/images/img.png)

Строки 6 и 7 распознаны как дублирующие и удалены из таблицы. Если в пункте 2 не отключить проверку по столбцу ни одна строка не будет удалена, так как для Excel все числа в колонке «Цена» считаются разными.

### <center>АЛЬТЕРНАТИВНЫЕ СПОСОБЫ УДАЛЕНИЯ ДУБЛИКАТОВ</center>

В Excel существуют и другие средства для работы с дублированными значениями. Например:

<ol>
    <li>
        «Данные»-«Удалить дубликаты» - Инструмент удаляет повторяющиеся строки на листе Excel.
        ![img](/images/img.png)
    </li>
    <li>
        «Данные»-«Сортировка и фильтр»-«Дополнительно»-«Расширенный фильтр»-«Только уникальные записи». Инструмент скрывает повторяющиеся строки листа.
        ![img](/images/img.png)
    </li>
    <li>
        «Главная»-«Условное форматирование»-«Правила выделения ячеек»-«Повторяющиеся значения». Инструмент подсвечивает дублирующие данные цветом.
        ![img](/images/img.png)
    </li>
    <li>
        Формула: =СЧЁТЕСЛИ($B:$B;B2)>1. Формула ищет одинаковые значения чисел количества в столбце B. Формулу следует протянуть маркером (скопировать) вдоль всех значений. Так же следует проконтролировать, чтобы был одинаковый формат отображения всех исходных чисел в столбце A.
        ![img](/images/img.png)
    </li>
    <li>
        Формула в массиве:
        ![img](/images/img.png). Формула ищет одинаковые наименования в диапазоне A2:A13 и выводит их в отдельный список столбца B (формулу нужно скопировать в диапазон B2:B13). Обратите внимание, что формула отображается в фигурных скобках {}, а значит она выполняется в **массиве**. Поэтому ее нужно вводить комбинацией горячих клавиш CTRL+SHIFT+Enter.
    </li>
</ol>

![img](/images/img.png)

Каждый инструмент обладает своими преимуществами и недостатками. Но эффективнее всех использовать для удаления дубликатов – таблицу (как описано выше). Там весь процесс происходит поэтапно с максимальным контролем данных. Это дает возможность получить качественный результат.

# <center>ФОРМУЛЫ В EXCEL</center>

## <center>АБСОЛЮТНЫЕ ОТНОСИТЕЛЬНЫЕ АДРЕСА ЯЧЕЕК В ФОРМУЛЕ</center>

Перед началом работы с формулами первое, что нужно изучить – это адресацию ссылок на ячейки. Чтобы уметь правильно обращаться к данным. И только потом уже следует изучать функции.

Если в ячейке введен первый символ знак «=», то все что будет введено дальше, для Excel является одним из параметров:

<ul>
    <li>формулы;</li>
    <li>ссылки;</li>
    <li>операции вычисления;</li>
    <li>ошибка.</li>
</ul>

Причину ошибки иногда очень сложно отследить в длинных формулах и тогда их следует прослеживать пошагово.

### <center>АБСОЛЮТНЫЙ АДРЕС ЯЧЕЙКИ</center>

Допустим, нам нужно посчитать стоимость за сутки проживания в отелю Еврозоне. Все цены представлены в валюте евро сконвертируем в рубли по курсу 1 EUR = 74 RUB. Курсы валют изменяются каждый день, поэтому нужно сделать прайс так, чтобы можно было легко и просто вычислить актуальные цены в рублях. Вычислим цены с помощью формул с абсолютными или смешанными адресами ячеек так, чтобы не нужно было изменять в них формулы при каждом изменении курса валют. Изменения будут вноситься только в одну ячейку. Для этого введем формулу: =B2*$D$2 или: =B2*D$2, в ячейку С2 как показано на рисунке:

![img](/images/img.png)

В адресах, которые ссылаются на ячейку D2 следует заблокировать символом ($) номер строки 2. Тогда при автозаполнении ячеек формулы будут иметь один фиксированный параметр. То есть, несколько ячеек будут ссылаться на одну и ту же ячейку. При том нам в данной ситуации, не важно будет ли заблокирован столбец символом ($) или нет. Поэтому здесь можно использовать абсолютную ($D$2) или смешанную(D$2) ссылку.

![img](/images/img.png)

Стоит отметить, что первый множитель у нас имеет относительную ссылку (B2), что позволило нам автоматически подставить правильные параметры формулы относительно каждой ячейки при автозаполнении.

### <center>ГОРЯЧИЕ КЛАВИШИ АБСОЛЮТНОЙ ССЫЛКИ</center>

Чтобы упростить ввод разного типа ссылок в Excel можно воспользоваться горячей клавишей F4, которая при поочередном нажатии работает как переключатель между типами ссылок:

<ul>
    <li>абсолютный;</li>
    <li>смешанный с фиксированной строкой;</li>
    <li>смешанный с фиксированным столбцом;</li>
    <li>относительный.</li>
</ul>

Чтобы убедиться, как это удобно работает, сделайте следующее:

<ol>
    <li>В любой пустой ячейке введите знак равно (=).</li>
    <li>Щелкните левой кнопкой мышки по любой дугой ячейке, на которую будет ссылаться исходная ячейка. В строе формул отобразиться ее адрес.</li>
    <li>Переодически нажимайте клавишу F4 и наблюдайте над тем, как меняется тип ссылки (сначала на абсолютный тип и т.д.).</li>
</ol>

![img](/images/img.png)

Благодаря формулам программа Excel является сильным и эффективным инструментом, который выполняет сложнейшие вычислительные операции с данными. Excel без формул был бы мертвой таблицей со строками и столбцами разбитой на множество ячеек. Такая таблица способна только форматировать отображение данных. Адресам ссылок можно присваивать имя, но об этом на следующих уроках.

## <center>АВТОМАТИЧЕСКИЙ ПЕРЕСЧЕТ ФОРМУЛ В EXCEL И ВРУЧНУЮ</center>

Excel умолчанию пересчитывает все формулы во всех листах всех открытых книг после каждого введения данных. Если лист содержит сотни или тысячи формул автоматический пересчет начинает заметно замедлять процесс работы с программой. Рассмотрим, как можно настроить Excel для повышения его производительности и беспрепятственной работы.

### <center>АВТОМАТИЧЕСКИЙ И РУЧНОЙ ПЕРЕСЧЕТ</center>

Для книги, которая содержит сотни сложных формул можно настроить пересчет по востребованию пользователя. Для этого:

<ol>
    <li>Введите формулу на чистый лист (чтобы можно было проверить как работает данный пример).</li>
    <li>Выберите инструмент: «Формулы»-«Параметры вычислений»-«Вручную».</li>
    <li>Убедитесь, что теперь после ввода данных в ячейку (например, число 7 вместо 1 в ячейке A2 как на рисунке), формула не пересчитывает результат автоматически. Пока пользователь не нажмет клавишу F9 (или SFIFT+F9).</li>
</ol>

![img](/images/img.png)
![img](/images/img.png)
![img](/images/img.png)

**Внимание!** Быстрая клавиша F9 – выполняет пересчет во всех формулах книги на всех листах. А Комбинация горячих клавиш SHIFT+F9 – выполняет пересчет только на текущем листе.

Если на листе не содержится множество формул, пересчет которых может тормозить Excel, то нет смысла использовать выше описанный пример. Но на будущее все же стоит знать о такой возможности. Ведь со временем придется сталкиваться со сложными таблицами с множеством формул. Кроме того данная функция может быть включена случайно и нужно знать где ее выключить для стандартного режима работы.

### <center>КАК ОТОБРАЖАТЬ ФОРМУЛУ ЯЧЕЙКЕ EXCEL</center>

В ячейках Excel мы видим только результат вычислений. Сами же формулы можно увидеть в строке формул (по отдельности). Но иногда нам нужно одновременно просмотреть все функции в ячейках (например, чтобы их сравнить и т.п.).

Чтобы наглядно отобразить пример данного урока нам потребуется лист содержащий формулы:

![img](/images/img.png)

Изменим настройки Excel так, чтобы ячейки отображали формулы, а не результат их вычисления.

![img](/images/img.png)

Чтобы добиться данного результата, нужно выбрать инструмент: «Формулы»-«Показать» (в разделе «Зависимости формул»). Чтобы выйти из этого режима нужно выбрать данный инструмент повторно.

Так же можно использовать комбинацию горячих клавиш CTRL+` (над клавишей Tab). Данная комбинация работает в режиме переключателя, то есть повторное нажатие возвращает в обычный режим отображения результатов вычисления в ячейках.

_Примечание. Все выше описанные действия распространяются только на режим отображения ячеек одного листа. То есть на других листах при необходимости потребуется выполнять эти действия повторно._

## <center>ТРЕХМЕРНЫЕ ССЫЛКИ В ФОРМУЛАХ EXCEL</center>

Если в формуле ссылка ссылается на другой лист или другую книгу, то такая ссылка в Excel считается трехмерной.

Чаще всего пользователь Excel использует формулы, которые обрабатывают текущие данные одного и того же листа где находиться сама формула (например, =В32 или =АВ123). Тогда исходные адреса ячеек и формулы лежат в одной плоскости, поэтому их адреса являются двумерными.

Расширение адреса ссылки за границы текущего листа (например, =Лист2!В32), позволяет выступить в трехмерном пространстве ячеек. Рассмотрим конкретные примеры.

### <center>ПРИМЕР ИСПОЛЬЗОВАНИЯ ТРЕХМЕРНЫХ ССЫЛОК В EXCEL</center>

Создайте новую книгу с 4-ма листами: «1 квартал», «Январь», «Февраль», «Март». На каждом листе введите в диапазон A1:A4 одинаковые значения: «Оплата», «Телефон», «Интернет», «Спутниковое ТВ».

![img](/images/img.png)

В ячейках B2:B4 каждого листа месяца введите разные суммы определяющие расходы на конец месяца. Сумам присвойте денежный формат ячеек.

На листе «1 квартал» в диапазон B2:B4 введите трехмерные формулы, которые суммируют суммы каждого месяца соответственно типу расходов. А в ячейке B6 просуммируйте итоговую сумму расходов двумерной формулой.

Вводим трехмерную формулу. 

**Способ 1:**

<ol>
    <li>
        Перейдите на лист «1 квартал» в ячейку B2 и введите знак равно – «=».
    </li>
    <li>
        Щелкнув по закладке листа «Январь» вы переместитесь на лист первого месяца. Там же сделайте щелчок левой кнопкой мышки по ячейке B2 и поставьте символ «+» с клавиатуры. В этот момент ссылка в строке формул должна отображаться, так как показано на рисунке:
        ![img](/images/img.png)

    </li>
    <li>
        Выполните операцию предыдущего пункта 2 со всеми остальными листами – «Февраль» и «Март» (после марта плюс не нужен), а затем жмите Enter.
    </li>
    <li>
        Когда формула будет полностью заполнена нажмите клавишу «Enter».
    </li>
    <li>
        Скопируйте формулу из ячейки B2 (первого листа) во все ячейки диапазона B3:B4.
    </li>
    <li>
        А в ячейке B6 просуммируйте все расходы диапазона B2:B4 с помощью обычного сложения: =B2+B3+B4.
    </li>
</ol>

Изначально можно ввести трехмерную формулу в ячейку B2 листа «1 квартал» написав все названия листов вручную: =Январь!B2+Февраль!B2+Март!B2.

**Способ 2:** Так же можно использовать в формуле функцию СУММ(). Например, =СУММ(Январь!B2;Февраль!B2;Март!B2).

![img](/images/img.png)

**Способ 3:** Можно использовать сокращенный вариант аргументов функции СУММ() с помощью указания трехмерных диапазонов. Например, =СУММ(Январь:Март!B2). Данный способ показывает, как можно эффективно использовать диапазоны в трехмерных ссылках.

![img](/images/img.png)

Обратите внимание на формулу в ячейке B6 данного рисунка. Пример, =СУММ(Январь:Март!B2:B4).

Все три способа ввода трехмерных формул имеют свои преимущества и недостатки. Например, если у нас мало используется листов и ячеек с небольшим количеством данных в диапазонах, то удобнее использовать 1 способ. А если много листов и большие объемы данных (например, диапазон B2:B527). Тогда рационально использовать способ №3.

### <center>ФУНКЦИЯ ДВССЫЛ В ТРЕХМЕРНЫХ ССЫЛКАХ: ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ</center>

Создайте листы и заполните их данными для всех месяцев одинаково, лишь числовые значения должны отличаться, так как указано на рисунке:

![img](/images/img.png)

На листе «Сумма по месяцам» следует составить таблицу, так чтобы отдельно отображалась сумма доходов и сумма налогов соответствующего месяца.

![img](/images/img.png)

**Внимание!** Названия заголовков столбцов в диапазоне B2:D2 должны совпадать с названиями имен листов. Это даст нам возможность использовать в формуле очень удобную функцию =ДВССЫЛ(), которая конвертирует текст в адрес ссылки.

Символ «&» (конкатенации) соединяет два текста в один. Так же обратите внимание, что параметры функции ссылаются на ячейку B2, которая содержит навязывание месяца и соответственно имя нужного нам листа – «Январь». Текстовое значение ячейки B2 конвертируется в адрес ссылки с помощью функции =ДВССЫЛ() и в результате получаем адрес трехмерной ссылки «Январь!B2:B4».

## <center>ЗАВИСИМОСТЬ ФОРМУЛ В EXCEL И СТРУКТУРА ИХ ВЫЧИСЛЕНИЯ</center>

Большинство формул используют данные с одной или множества ячеек и в пошаговой последовательности выполняется их обработка. Изменение содержания хотя-бы одной ячейки приводит к автоматическому пересчету целой цепочки значений во всех ячейках на всех листах. Иногда это короткие цепочки, а иногда это длинные и сложные формулы. Если результат расчета правильный, то нас не особо интересует структура цепочки формул. Но если результат вычислений является ошибочным или получаем сообщение об ошибке, тогда мы пытаемся проследить всю цепочку, чтобы определить, на каком этапе расчета допущена ошибка. Мы нуждаемся в отладке формул, чтобы шаг за шагом проверить ее работоспособность.

### <center>АНАЛИЗ ФОРМУЛ В EXCEL</center>

Чтобы выполнить отслеживание всех этапов расчета формул, в Excel встроенный специальный инструмент который рассмотрим более детально.

В ячейку B5 введите формулу, которая просто суммирует значения нескольких ячеек (без использования функции СУММ).

![img](/images/img.png)

Теперь проследим все этапы вычисления и содержимое суммирующей формулы:

<ul>
    <li>Перейдите в ячейку B5, в которой содержится формула.</li>
    <li>
        Выберите инструмент: «Формулы»-«Зависимости формул»-«Вычислить формулу». Появиться диалоговое окно «Вычисление».
        ![img](/images/img.png)
    </li>
    <li>В данном окне периодически нажимайте на кнопку «Вычислить», наблюдая за течением расчета в области окна «Вычисление:»</li>
</ul>

Для анализа следующего инструмента воспользуемся простейшим кредитным калькулятором Excel в качестве примера:

![img](/images/img.png)

Чтобы узнать, как мы получили результат вычисления ежемесячного платежа, перейдите на ячейку B4 и выберите инструмент: «Формулы»-«Зависимости формул»-«Влияющие ячейки».

![img](/images/img.png)

Теперь мы наглядно видим, с какими значениями работает формула ежемесячного платежа. Дальше нам нужно узнать, как сформировались эти значения. Для этого перейдите сначала на ячейку с первым значением – С2 и снова выберите инструмент «Влияющие ячейки».

![img](/images/img.png)

В результате у нас сформировалась графическая схема цепочки вычисления ежемесячного платежа формулами Excel.

_Примечание. Чтобы очистить схему нужно выбрать инструмент «Убрать стрелки»._

**Полезный совет.** Если нажать комбинацию клавиш CTRL+«`» (апостроф над клавишей Tab) или выберите инструмент : «Показать формулы». Тогда мы увидим, что для вычисления ежемесячного платежа мы используем 3 формулы в данном калькуляторе. Они находиться в ячейках: B4, C2, D2.

Такой подход тоже существенно помогает проследить цепочку вычислений. Снова перейдите в обычный режим работы, повторно нажав CTRL+«`».

### <center>КАК УБРАТЬ ФОРМУЛЫ В EXCEL</center>

Теперь рассмотрим, как убрать формулы в Excel, но сохранить значение. Передавая финансовые отчеты фирмы третьим лицам, не всегда хочется показывать способ вычисления результатов. Самым простым решением в данной ситуации – это передача листа, в котором нет формул, а только значения их вычислений.

На листе в ячейках B5 и C2:C5 записанные формукы. Замемим их иуоговыми знаӇениюми резуһьтатов вычислений.

!Zimg](/imageó/img.pnæ)
![img](/images/ilg.png)

Нажмиуе комбимацию клавиш CTRM+A )или!щелкните в левом весхнем углу на пересечений номеров строк й загологков столбцов листа), чтҾбы выделить все!содержиное.

Тепесь щелкнҸте по вӋделенному и выберите опцию из контелстного меню «Специальная вставка» (или нажмите комбйнацию горячих ккавиш CTRL+ALT+V(.

![img](/images/img.png©

В появившемря диалоговом окҼе выберите опцию «значемия»!и нажмите кнопку ОК.

В резулэтатд лист не содержит только значения дұнныф.

## <center?КАК УБРҐТЬ ОШИБКИ В ЯЧЕЙКАХ EXCEL</bentdr>

При ошибоӇных!вычислениях, формулы отобразают нескольҺо типов!ошиаок вместо змачемий. Рассмотрим йх нҰ практических псимерах Ҳ прҾцессе работы формул, коуорые дали ошибочные!результаты вычислений.

### <centdr>ОШИБКИ В ХОРМңЛЕ DXCEM ОТОБРАЖАЕМЫЕ В!ЯЧЕЙКАХ¼/center>

В данном уроке аудуӂ описанъ знбченйя оӈибок фоӀмул, которые мовут содержатӌ ячҵйки. Знұя зҽачемие каждпго кода (напримдр: #ЗНАЧ!, #ДЕЛ/0!, #ЧИҡЛО!¬ #Н/Д!, #ИМЮ!, #ПУСңО!, #ССЫЛКА!) мпжно!легко разобраться, как найтй ошибку в формуле и!устранить ее.

**Лак убрауь #ДЕЛ/0 в Excem**

![img](/images/img.pnf)
![imf](/hmages/img.png)

Как вҸдно при делении на ячейлу с пустым значениеҼ прпграмма воспрининает как¡деление на 0. В результате Ҳыдает значение: #ДЕЛ/0! В этом можно убҵдиться и с помощью подсказки.

Читайте также: **Как убрать ошибку деления на ноль формулой Excel.**

В других арифметических вычислениях (умножение, суммирование, вычитание)пустая ячейка также является нулевым значением.

**Результат ошибочного вычисления – #ЧИСЛО!**

Неправильное число: #ЧИСЛО! – это ошибка невозможности выполнить вычисление в формуле.

Несколько практических примеров:

![img](/images/img.png)

**Ошибка: #ЧИСЛО!** возникает, когда числовое значение слишком велико или же слишком маленькое. Так же данная ошибка может возникнуть при попытке получить корень с отрицательного числа. Например, =КОРЕНЬ(-25).

В ячейке А1 – слишком большое число (10 1000). Excel не может работать с такими большими числами.

В ячейке А2 – та же проблема с большими числами. Казалось бы, 10000 небольшое число, но при возвращении его факториала получается слишком большое числовое значение, с которым Excel не справиться.

В ячейке А3 – квадратный корень не может быть с отрицательного числа, а программа отобразила данный результат этой же ошибкой.

**Как убрать НД в Excel**

**Значение недоступно: #Н/Д!** – значит, что значение является недоступным для формулы:

![img](/images/img.png)

Записанная формула в B1: =ПОИСКПОЗ(„Максим”; A1:A4) ищет текстовое содержимое «Максим» в диапазоне ячеек A1:A4. Содержимое найдено во второй ячейке A2. Следовательно, функция возвращает результат 2. Вторая формула ищет текстовое содержимое «Андрей», то диапазон A1:A4 не содержит таких значений. Поэтому функция возвращает ошибку #Н/Д (нет данных).

**Ошибка #ИМЯ! в Excel**

Относиться к категории ошибки в написании функций. **Недопустимое имя: #ИМЯ!** – значит, что Excel не распознал текста написанного в формуле (название функции ему неизвестно, оно написано с ошибкой). Это результат ошибки синтаксиса при написании имени функции. Например:

![img](/images/img.png)

**Ошибка #ПУСТО! в Excel**

**Пустое множество: #ПУСТО!** – это ошибки оператора пересечения множеств. В Excel существует такое понятие как пересечение множеств. Оно применяется для быстрого получения данных из больших таблиц по запросу точки пересечения вертикального и горизонтального диапазона ячеек. Если диапазоны не пересекаются, программа отображает ошибочное значение – #ПУСТО! Оператором пересечения множеств является одиночный пробел. Им разделяются вертикальные и горизонтальные диапазоны, заданные в аргументах функции.

![img](/images/img.png)
![img](/images/img.png)
![img](/images/img.png)

В данном случаи пересечением диапазонов является ячейка C3 и функция отображает ее значение.

Заданные аргументы в функции: =СУММ(B4:D4 B2:B3) – не образуют пересечение. Следовательно, функция дает значение с ошибкой – #ПУСТО!

**#ССЫЛКА! – ошибка ссылок на ячейки Excel**

**Неправильная ссылка на ячейку: #ССЫЛКА!** – значит, что аргументы формулы ссылаются на ошибочный адрес. Чаще всего это несуществующая ячейка.

![img](/images/img.png)

В данном примере ошибка возникала при неправильном копировании формулы. У нас есть 3 диапазона ячеек: A1:A3, B1:B4, C1:C2.

Под первым диапазоном в ячейку A4 вводим суммирующую формулу: =СУММ(A1:A3). А дальше копируем эту же формулу под второй диапазон, в ячейку B5. Формула, как и прежде, суммирует только 3 ячейки B2:B4, минуя значение первой B1.

Когда та же формула была скопирована под третий диапазон, в ячейку C3 функция вернула ошибку #ССЫЛКА! Так как над ячейкой C3 может быть только 2 ячейки а не 3 (как того требовала исходная формула).

_Примечание. В данном случае наиболее удобнее под каждым диапазоном перед началом ввода нажать комбинацию горячих клавиш ALT+=. Тогда вставиться функция суммирования и автоматически определит количество суммирующих ячеек._

Так же ошибка **#ССЫЛКА!** часто возникает при неправильном указании имени листа в адресе трехмерных ссылок.

**Как исправить ЗНАЧ в Excel**

**#ЗНАЧ!** – ошибка в значении. Если мы пытаемся сложить число и слово в Excel в результате мы получим ошибку **#ЗНАЧ!** Интересен тот факт, что если бы мы попытались сложить две ячейки, в которых значение первой число, а второй – текст с помощью функции =СУММ(), то ошибки не возникнет, а текст примет значение 0 при вычислении. Например:

![img](/images/img.png)

**Решетки в ячейке Excel**

Ряд решеток вместо значения ячейки ###### – данное значение не является ошибкой. Просто это информация о том, что ширина столбца слишком узкая для того, чтобы вместить корректно отображаемое содержимое ячейки. Нужно просто расширить столбец. Например, сделайте двойной щелчок левой кнопкой мышки на границе заголовков столбцов данной ячейки.

Так решетки (######) вместо значения ячеек можно увидеть при отрицательно дате. Например, мы пытаемся отнять от старой даты новую дату. А в результате вычисления установлен формат ячеек «Дата» (а не «Общий»).

![img](/images/img.png)

Неправильный формат ячейки так же может отображать вместо значений ряд символов решетки (######).

## <center>ЗАВИСИМОСТИ ФОРМУЛ В EXCEL И ПОСТРОЕНИЕ ИХ СХЕМЫ</center>

Excel оснащен инструментами для прослеживания зависимости формул между собой. Они расположены на закладке «Формулы» в разделе «Зависимости формул». Рассмотрим детально все действия этих инструментов.

### <center>ИНСТРУМЕНТ ПРОВЕРКА НАЛИЧИЯ ОШИБОК</center>

Данным инструментом можно выяснить причину ошибочных значений в ячейках после вычисления формул.

Чтобы оценить эффективность инструмента «Проверка наличия ошибок» в действии, смоделируем следующую ситуацию. Допустим у нас на листе находится формула, которая не находит нужного значения в диапазоне ячеек и отображает в результате вычисления ошибку #Н/Д.

![img](/images/img.png)

Выполните следующие действия:

<ol>
    <li>Выберите: «Формулы»-«Зависимости формул»-«Проверка наличия ошибок». Excel сразу переместит курсор на первую ячейку содержащую ошибку.</li>
    <li>В появившемся окне «Контроль ошибок» выберите действие, которое вы хотели бы выполнить с данной ошибкой. Например, кнопка «Пропустить ошибку» автоматически выполнит поиск следующего ошибочного значения.</li>
</ol>

### <center>ИНСТРУМЕНТ ВЛИЯЮЩИЕ ЯЧЕЙКИ</center>

Приготовьте лист с формулами, так как показано ниже на рисунке:

![img](/images/img.png)

Проверьте, в каких ячейках используются данные для вычисления результата формулой в F2.

<ol>
    <li>
        Выберите: «Формулы»-«Зависимости формул»-«Влияющие ячейки» и вы увидите источники данных для F2.
        ![img](/images/img.png)
    </li>
    <li>
        Чтобы проследить полную цепочку зависимости и узнать, откуда берутся данные ячейках C2 и D2, повторно выберите: «Влияющие ячейки».
        ![img](/images/img.png)
    </li>
    <li>
        Удалите отображаемые стрелки схемы источников значений, используя инструмент: «Убрать стрелки».
    </li>
</ol>

_Примечание. Такие же стрелки схем отображаются при выборе опции «Источники ошибок» из развернутого списка меню._

### <center>ИНСТРУМЕНТ ЗАВИСИМЫЕ ЯЧЕЙКИ</center>

На этом же листе проверьте, какие формулы используют содержимое D2.

<ol>
    <li>Перейдите на ячейку D2.</li>
    <li>Выберите: «Зависимые ячейки».</li>
    <li>Повторно нажмите на этот же инструмент для продолжения схемы цепочки.</li>
</ol>

![img](/images/img.png)

Отображаемые стрелки снова удалите инструментом «Убрать стрелки».

## <center>ПРОВЕРКА ВВОДИМЫХ ЗНАЧЕНИЙ В EXCEL</center>

Программа Excel обладает эффективными инструментами для удобного контроля ввода больших объемов данных. Так же присутствуют средства для одновременного экспонирования нескольких значений ячеек, которые не соответствуют определенным требованиям.

### <center>ПРОВЕРКА ДАННЫХ В EXCEL</center>

Приготовьте лист доходов и расходов как показано на рисунке:

![img](/images/img.png)

Прибыль – это естественно доход минус расход. Допустим нам нужно проверить, в какие дни прибыль падала ниже 40$. Решение следующее:

<ol>
    <li>
        Выделите данные в диапазоне D2:D6 и выберите инструмент: «Данные»-«Работа с данными»-«Проверка данных».
    </li>
    <li>
        В появившемся окне: «Проверка вводимых значений» установите такие же настройки как показано на рисунке. И нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Теперь выберите инструмент из выпадающего списка: «Данные»-«Проверка данных»-«Обвести неверные данные». И обратите внимание на результат:
        ![img](/images/img.png)
    </li>
    <li>
        При необходимости можете удалить красные обводки, выбрав инструмент «Удалить обводку неверных данных».
    </li>
</ol>

_Примечание. Обведение несоответствующих критериям данных работают только в тех диапазонах, в которых установлены эти же критерии инструментом «Проверка данных»._

### <center>ОКНО КОНТРОЛЬНОГО ЗНАЧЕНИЯ В EXCEL</center>

Смоделируем следующую ситуацию. Нужно закупить расходные материалы для небольшой фирмы. Требуется приобрести канцелярские принадлежности, потребительские принадлежности и моющие средства. Списки закупаемых позиций записываем отдельно на каждом листе, разделяя их по типам товаров.

Наперед не известно, сколько позиций будет в каждой группе товаров.

На листе ИТОГО должно быть посчитано, сколько денег нужно для приобретения каждой группы товаров по отдельности. И какая общая сумма расходов.

![img](/images/img.png)
![img](/images/img.png)

Дописывая каждую новую позицию, пользователь должен иметь возможность следить за общей суммой расходов. Решение:

<ol>
    <li>
        Создайте книгу с листами, так как указано выше на рисунке и на каждом листе добавьте по несколько позиций разным количеством.
    </li>
    <li>
        На листе: «ИТОГО» поставьте формулы как указано выше на рисунке и перейдите в ячейку B4.
    </li>
    <li>
        Перейдите на закладку «Формулы» и выберите инструмент «Окно контрольного значения»
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне нажмите кнопку «Добавить контрольное значение» и в нем указываем адрес ячейки, за значением которого мы будем следить: =ИТОГО!$B$4. Жмите добавить.
    </li>
</ol>

Теперь у Вас есть возможность избежать бесконтрольных расходов при заполнении листов новыми товарами.

![img](/images/img.png)

Не важно, на каком листе Вы находитесь. Поверх всех окон отображено окно контрольного значения, а в нем видно общую сумму расходов. Несложно догадаться, как сделать так, чтобы в этом окне отображались и значения общей суммы каждой группы по отдельности.

**Полезный совет.** Если взять курсором мышки за заголовок "Окно контрольного значения" и навести на строку состояния окна программы (в область ярлычков с названиями листов), то оно удобно зафиксируется в нижней части главного окна.

# <center>ИМЕНА ДИАПАЗОНОВ ЯЧЕЕК</center>

## <center>КАК ПРИСВОИТЬ ИМЯ ЗНАЧЕНИЮ EXCEL</center>

Имена в Excel удобно использовать для содержимого диапазонов ячеек, к которым часто приходиться обращаться из формул. В случаи изменения этих диапазонов, вместо того чтобы переформатировать все формулы, достаточно лишь изменить значение в имени. Ниже приведем конкретный пример.

### <center>ПРИМЕР ПРИСВОЕНИЯ ИМЕНИ В EXCEL</center>

Управляя магазином, мы хотим знать все о ценах на его товары. Почем покупаем, почем продаем. То есть нам нужен прайс с оптово-закупочными и розничными ценами, где определена наша прибыль. Для упрощения примера установим одинаковую наценку 10% на все товарные позиции.

![img](/images/img.png)

Как видно если изменяется наценка нужно изменить все формулы в данном случае. Конечно, для этого можно значение наценки вынести в отдельную ячейку, а в формулах сделать на нее абсолютною ссылку. Но использовать имя значительно удобнее, если бы у каждой группы товаров была своя наценка. Ведь такие ссылки в аргументах формул легко читаются.

Присвоим наценке имя и пока установим ее значение на уровне 10%, а потом будем изменять. Чтобы присвоить значению имя делаем следующее:

<ol>
    <li>
        Выберите инструмент: «Формулы»-«Определенные имена»-«Присвоить имя».
    </li>
    <li>
        Введите имя «Наценка1», а в поле «Диапазон» просто значение 10% так как указано на рисунке. При необходимости выберите область распространения имени (на конкретный лист или на целую книгу). И нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Теперь нам нужно применить наше имя «Наценка1» в формулах.
    </li>
</ol>

![img](/images/img.png)

При создании имен следует учитывать несколько простых правил:

<ol>
    <li>Имя должно начинаться с буквы или знака нижнего подчеркивания. Нельзя чтобы в имени первым символом было число или спецсимвол.</li>
    <li>Начиная со второго символа можно использовать: буквы, цифры, точки и знаки нижнего подчеркивания. Другие символы запрещено использовать (даже пробел).</li>
    <li>Нельзя использовать пробелы.</li>
</ol>

Теперь мы без проблем можем изменять наценку, а формулы будут автоматически пересчитывать результат вычисления. Например, увеличим нашу наценку на 2%:

<ol>
    <li>
        Выберите инструмент «Формулы»-«Диспетчер имен».
        ![img](/images/img.png)
    </li>
    <li>В диалоговом окне выберите «Наценка1» и нажмите на кнопку «Изменить». В поле «Диапазон» введите новое значение 12% (или 0,12). И нажмите ОК. После нажатия все формулы с именем «Наценка1» автоматически выполнять пересчет и выдадут новые результаты.</li>
</ol>

_Примечание. Если формулы не пересчитаны значит у Вас в настройках Excel включена опция ручного пересчета формул («Формулы»-«Параметры вычислений»-«Вручную»), в таком случаи новые цены мы получим после нажатия на клавишу F9._

### <center>ПРЕИМУЩЕСТВА ИМЕН В EXCEL</center>

При запуске программы нам сразу доступны для нашего взгляда: ячейки, листы, строки, столбцы, кнопки инструментов и много других элементов, только не имена. Чтобы их использовать до них нужно обираться лишь с помощью соответствующих инструментов. Большинство пользователей так и не решаться использовать, а вместо этого ищут решения более сложными путями. Очень жаль, ведь с помощью имен можно изящно решать большинство задач в Excel.

Чаще всего имя используют в идентификации диапазонов ячеек. Реже применяют для резервирования констант и функций. Рационально применяемые имена существенно упрощают понимание формул, особенно когда мы давно с ними не работали в старом документе.

## <center>ИМЕНА ДИАПАЗОНОВ EXCEL С АБСОЛЮТНЫМ АДРЕСОМ</center>

В основном пользователи Excel используют один тип имен диапазонов. При использовании имени в формулах, к нему обращаются как к абсолютной ссылке на диапазон ячеек. Хотя в предыдущем уроке мы **присвоили имя** не диапазону, а числу (значению).

### <center>ПРЕИМУЩЕСТВА ИМЕН ДИАПАЗОНОВ ПЕРЕД АБСОЛЮТНЫМИ ССЫЛКАМИ</center>

Приготовьте лист, на котором расходы будут пересчитаны из одной валюты в другую.

![img](/images/img.png)

Пересчет должен выполняться соответственно курсов валют, которые изменяются. Поэтому курсы нельзя вносить в формулы, чтобы при их изменении не пришлось редактировать каждую ячейку.

Для решения данной задачи мы можем обойтись без использования имен с помощью абсолютных ссылок. Ниже приведем пример. Но имена дают более изящное решение данной задачи. Для сравнения рассмотрим оба варианта.

Допустим, мы решаем данную задачу с помощью абсолютной ссылки на ячейку со значением текущего курса. Тогда нам нужно сделать так:

<ol>
    <li>
        Запишем курсы ЕВРО и ДОЛЛАРА в отельных ячейках F2 и G2.
        ![img](/images/img.png)
    </li>
    <li>В ячейки C2 и D2 введем формулы, которые ссылаются к ценам в рублях через относительную ссылку, а к другим валютам через абсолютную ссылку.</li>
    <li>Скопируем диапазон ячеек C2:D2 в C3:D5.</li>
</ol>

![img](/images/img.png)

Данное решение вполне рабочее и его используют для временных вычислений. Преимущества абсолютных ссылок очевидны. При изменении только одной ячейки автоматически пересчитывается целый диапазон ячеек без лишних изменений.

Главным недостатком абсолютных ссылок является плохая читабельность формул. В документах для долгосрочного использования вместо абсолютных ссылок лучше использовать имена. Они обладают теми же преимуществами, но и улучшают читабельность формул. Это существенно повысит производительность пользователя при редактировании формул для внесения поправок или изменения порядка аргументов вычислений. Даже спустя несколько лет Вы откроете такой документ и быстро сориентируетесь в алгоритмах расчетов в сложных отчетах. Тем более это важно, если документ предназначен для использования широкого круга пользователей.

Теперь рассмотрим использование имен как альтернативный вариант для выше описанной задачи:

<ol>
    <li>
        Выделите диапазон ячеек F1:G2 и выберите инструмент: «Формулы»-«Определенные имена»-«Создать из выделенного».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне «Создание имен из выделенного диапазона», отметьте первую опцию: «в строке выше», как на рисунке. Это значит, что значения в верхних строках будут использованы для названия имен ячеек в нижних строках. Будет создано одновременно сразу 2 имени. Ячейка F2 получит имя «Евро», а ячейка G2 – «Доллар».
    </li>
    <li>
        Выделите диапазон C2:D5 и выберите инструмент из выпадающего меню: «Формулы»-«Определенные имена»-«Присвоить имя»-Применить имена».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне выделите сразу 2 имени, а остальное оставьте все по умолчанию и нажмите ОК.
    </li>
</ol>

Это только примитивный пример преимущества использования имен вместо абсолютных ссылок. Вы без проблем можете менять курсы валют (изменяя значения ячеек F2 и G2), а цены будут автоматически пересчитаны.

_Примечание. Курсы валют можно хранить не только в значениях ячеек, но и в самих именах. Просто в поле диапазон введите значение текущего курса._

### <center>ИСПОЛЬЗОВАНИЯ ИМЕН В EXCEL ПРИ ПЕРЕСЕЧЕНИИ МНОЖЕСТВ</center>

Теперь приведем более наглядный пример существенного преимущества использования имен.

Создайте отчет по продажам за первый квартал по 4-ем магазинам как на рисунке:

![img](/images/img.png)

С помощью формулы и оператора пересечения множеств мы будем работать с этим отчетом как с базой данных. В ячейках A8 и B8 мы создаем запрос к базе, а в ячейке C8 получим результирующий ответ. Сначала создадим все имена:

<ol>
    <li>
        Выделите диапазон ячеек A2:D5 и выберите инструмент: «Формулы»-«Создать из выделенного». В появившемся окне отмечаем вторую опцию сверху: «в столбце слева».
        ![img](/images/img.png)
    </li>
    <li>
        Выделите диапазон ячеек B1:D5 и выберите инструмент: «Формулы»-«Создать из выделенного». В появившемся окне отмечаем вторую опцию сверху: «в столбце сверху». Таким образом, у нас создались все нужные нам имена. Чтобы убедиться в этом выберите инструмент: «Диспетчер имен».
        ![img](/images/img.png)
    </li>
    <li>
        Перейдите в ячейку C8 и введите функцию СУММ со следующими аргументами: =СУММ(Магазин3 февраль) и нажмите Enter.
        ![img](/images/img.png)
    </li>
</ol>

Отлично! В результате мы видим значение 500 ¬– прибыль магазина3 за февраль месяц. Теперь нам только осталось с помощью функции сделать обработчик запросов, который так же будет использовать имена в своем алгоритме. Для этого:

<ol>
    <li>
        Модифицируем формулу в ячейке C8, а именно так: =СУММ(ДВССЫЛ(A8) ДВССЫЛ(B8)). И нажмите Enter. В результате формула выдала ошибку: #ССЫЛКА! Не переживайте по этому поводу, все под контролем, делаем обработчик запросов далее.
    </li>
    <li>
        Создадим еще 2 имени. Выделите диапазон A2:A5 чтобы присвоить ему имя «магазины». Для этого выберите инструмент: «Формулы»-«Присвоить имя». Заполните диалоговое окно как на рисунке. А потом выделите диапазон B1:D1 и присвойте ему имя «месяцы».
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Создаем выпадающий список для безошибочного запроса к нашей мини базе данных. Перейдите в ячейку А8 и выберите инструмент: «Данные»-«Работа с данными»-«Проверка данных». В появившемся окне: «Проверка вводимых значений» внесите настройки, так как показано на рисунке. И нажмите ОК.
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
    <li>
        Таким же образом создайте второй список с месяцами в ячейке B8.
    </li>
</ol>

![img](/images/img.png)

Готово! В результате мы теперь можем уверенно работать с нашей базой данных. Указываем параметры запроса, а в ячейке теперь вместо ошибки **#ССЫЛКА!** отображается правильный результирующий ответ.

_Примечание. Хотя списки можно и не использовать, а вводить названия магазинов и месяцев вручную. Списки нужны для удобства ввода и исключения возможных ошибок допущенных при ручном вводе значений. Результат будет тот же._

В некоторой степени решение данной задачи можно выполнить и без имен используя плохо-читаемые абсолютные адреса ссылок на диапазоны ячеек. Но вот такой обработчик запросов без использования имен сделать гораздо сложнее.

## <center>ОБЛАСТЬ ВИДИМОСТИ ИМЕНИ НА ЛИСТЕ EXCEL</center>

Excel позволяет создавать имена с областью видимости в приделах 1-го листа или целой книги. По умолчанию имя доступно в приделах целой книги. Это в большинстве случаем удобно, когда одно значение имени можно использовать на разных листах. Но иногда требуется ограничить область действия имени. Для этого в Excel присутствует возможность создавать имена доступ, к которым можно получить только из одного листа.

### <center>ПРИМЕР НЕОБХОДИМОСТИ ОГРАНИЧИТЬ ОБЛАСТЬ ИМЕНИ</center>

Определим имя, так чтобы была возможность сконструировать структуру книги соответственно следующим требованиям:

Прибыль, как известно – это доход минус расход. Ежегодно мы формируем отчеты, в которых подытоживаем обще-годовую прибыль. Для этого мы вычитаем расходы из доходов отдельно по каждому кварталу, а потом суммируем результат.

Пока мы анализируем лист с данными за конкретный год, нас не интересуют другие года. Например, формула: =СУММ(расходы) для нас ассоциируются с расходами текущего года данного листа.

На следующий год структура формул не измениться. Какой же смысл создавать их заново на новом листе, когда можно просто скопировать лист с готовыми формулами?

Если-бы действия имени «расходы» распространялось на все листы, то его нельзя было-бы использовать на других листах не допустив ошибки. А если создавать для каждого нового листа свое новое имя, тогда после копирования листа нужно редактировать каждую формулу для удаления старых и вставки новых имен в аргументы.

Лучшее решение в данной ситуации – это ограничить распространения действия имени в пределах одного листа.

Сначала создадим пример отчета, в котором уже готовые все формулы, но данные еще незаполненные. Пример послужит нам шаблоном. Для удобства область заполнения данных выделим цветным фоном. И так:

<ol>
    <li>
        На листе: «Пример отчета» выделите диапазон B2:B5 и выберите инструмент: «Формулы»-«Определенные имена»-«Присвоить имя». В появившемся окне создаем имя «Доход» ограниченным в пределах одного листа заполнив поля, так как на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Аналогичным способом создаем еще 2 имени: «Расход» и «Прибыль» для диапазонов C2:C5 и D2:D5 соответственно. Эти 2 имени так же должны иметь распространение действия в пределах 1-го листа. А в поле «Диапазон» окна «Создание имени», так же должны быть абсолютные ссылки на их диапазоны.
    </li>
    <li>
        Не забудьте заполнить диапазон D2:D5 формулами. Так же введите формулы в ячейки B6, C6 и D6 для получения итоговых значений.
        ![img](/images/img.png)
    </li>
    <li>
        Скопируйте лист «Пример отчета» и присвойте название для копии «2008г.». О том, как скопировать лист вы уже знаете из урока: **Создание, копирование и перемещение листов в книгах Excel**
    </li>
    <li>
        Новый лист «2008г» заполните данными и выберите инструмент: «Формулы»-«Определенные имена»-«Диспетчер имен».
    </li>
</ol>    

![img](/images/img.png)

Как видно в диспетчере имен Excel автоматически создал новые имена с распространением действия в пределах одного листа.

**Полезный совет.** Лист «Пример отчета» в данной книге хорошо использовать в качестве шаблона для ежегодных отчетов. Поэтому лучше защитить его формулы от изменения. Оставить доступными для редактирования только ячейки диапазонов ввода данных B2:C5. О ток как защитить формулы от случайного изменения читайте в уроке: **Защита листа и ячеек в Excel.**

**Внимание!** Если мы будем копировать не целый лист, а только его содержимое, тогда у нас так же автоматически создадутся новые имена, но их область видимости может распространяться на целую книгу. В целях избежания ошибок лучше копировать лист целиком, а не только его содержимое.

## <center>ИМЕНА ДИАПАЗОНОВ С ОТНОСИТЕЛЬНЫМ АДРЕСОМ ССЫЛКИ</center>

По умолчанию Excel автоматически присваивает именам диапазоны ячеек с абсолютным адресом ссылки. Такие имена наиболее часто используются в процессе работы. Но иногда нужно присвоить относительный адрес ссылки для имени.

### <center>ПРИМЕРЫ ИМЕН С ОТНОСИТЕЛЬНЫМИ</center>

Имея прибыль в отдельных месяцах, посчитаем суммарную прибыль за квартал. Для этой задачи можно сложить значения выбранных ячеек, но значительно удобнее использовать имя с относительной адресацией.

<ol>
    <li>Составьте отчет, так как показано ниже на рисунке и перейдите в ячейку C4.</li>
    <li>
        Выберите инструмент: «Формулы»-«Определенные имена»-«Присвоить имя».
        ![img](/images/img.png)
    </li>
    <li>
        В диалоговом окне: «Создание имени» введите в поле «Имя:» его название «квартал», а в поле «Диапазон:» вводим относительные адрес диапазона охватывающего прибыли трех месяцев первого квартала. Опцию в выпадающем списке «Область:» установите на свое усмотрение. С данным параметром вы знакомы из предыдущего урока: **Область видимости имени на листе Excel.**
    </li>
    <li>
        Напротив последнего месяца первого квартала (ячейка C4) введите формулу: =СУММ(квартал). Скопируйте ее во все ячейки напротив последних месяцев каждого квартала: C7, C10 и C13.
        ![img](/images/img.png)
    </li>
</ol>

_Примечание. Чтобы быстро и удобно изменить тип адреса в ссылках (с абсолютного на относительный), используйте клавишу F4._

### <center>ПРИСВОИТЬ ИМЯ ФУНКЦИИ В EXCEL</center>

Имена в Excel можно присваивать не только диапазонам ячеек и значениям, но так же и формулам. Имя, присвоенное формуле с относительным адресом ссылки, можно использовать как функцию.

<ol>
    <li>
        Создайте книгу Excel с отчетами так как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>Перейдите в ячейку B6 и выберите инструмент: : «Формулы»-«Присвоить имя».</li>
    <li>
        Заполните диалоговое окно так как показано на рисунке. Обратите внимание на то, что в поле «Диапазон» указана функция с относительными ссылками на диапазон. А в параметре «Область» обязательно указан текущий лист «2008».
    </li>
    <li>В ячейки B6, C6 и D6 введите значение: =итого.</li>
    <li>Скопируйте лист «2008» назвав новые копии листов: «2009» и «2010». И откройте «Формулы»-«Диспетчер имен».</li>
</ol>

![img](/images/img.png)

Как видно в диспетчере имен при копировании листов для них автоматически создались имена «итого».

## <center>АВТОМАТИЧЕСКИ ИЗМЕНЯЕМЫЕ ДИАПАЗОНЫ ЯЧЕЕК В EXCEL</center>

В процессе работы с данными в Excel иногда заранее не известно, сколько данных будет собрано в той или иной таблице. Поэтому мы не всегда можем заранее знать какой диапазон должно охватывать имя. Ведь количество данных может изменяться. Для решения данной задачи следует автоматически изменить именованный диапазон используемых ячеек, в зависимости от количества введенных данных.

### <center>КАК В EXCEL СДЕЛАТЬ АВТОМАТИЧЕСКОЕ ИЗМЕНЕНИЕ ДИАПАЗОНА</center>

Допустим, у нас есть объект инвестирования, по которому мы хотим знать суммарную прибыль за весь период его использования. Заранее мы не можем определить период использования инвестиционного объекта. Но нам нужно постоянно следить за общим доходом, который приносит нам данный объект инвестирования.

Сформируйте отчет по доходности нашего объекта инвестирования, так как показано на рисунке:

![img](/images/img.png)

Данную задачу можно было-бы решить путем суммирования целого столбца B и после появления в нем записей общая сумма изменялась бы автоматически. Но это некорректный способ решения задач в Excel. Во-первых, нам нельзя будет использовать ячейки столбца B для ввода других данных. Во-вторых, так функция суммирования будет нерационально потреблять больше памяти. Это может привести к серьезным проблемам при работе с документом. Самым рациональным решением является использование динамических имен.

<ol>
    <li>Выберите инструмент «Формулы»-«Определенные имена»-«Присвоить имя».</li>
    <li>
        Заполните поля диалогового окна «Создание имени» как на рисунке. Обратите внимание на то, что в поле «Диапазон:» мы используем функцию =СМЕЩ, а в одном из ее параметров используем функцию =СЧЕТ. Пример: =СМЕЩ(Лист1!$B$2;0;0;СЧЁТ(Лист1!$B:$B);1)
        ![img](/images/img.png)
    </li>
    <li>
        Переместите курсор в ячейку D2 и введите функцию =СУММ с именем «доход» в ее параметрах.
        ![img](/images/img.png)
    </li>
</ol>

Теперь постепенно заполняя ячейки в столбце B, мы можем проследить, как изменяется охват ячеек именем «доход».

### <center>ФУНКЦИЯ СМЕЩ В EXCEL</center>

Разберем более детально функции, которые мы вводили в поле диапазон при создании динамического имени.

Функция =СМЕЩ определяет наш диапазон в зависимости от количества заполненных ячеек в столбце B. 5 параметров функции =СМЕЩ(начальная ячейка; смещение размера диапазона по строкам; смещение по столбцам; размер диапазона в высоту; размер диапазона в ширину):

![img](/images/img.png)

<ol>
    <li>
        «Начальная ячейка» – указывает верхнюю левую ячейку, от которой будет динамически расширяться диапазон как вниз, так и вправо (при необходимости).
    </li>
    <li>
        «Смещение по строкам» – параметр определяет, на какое количество нужно смещать диапазон по вертикали от начальной ячейки (первого параметра). Значения могут быть нулевыми и отрицательными.
    </li>
    <li>
        «Смещение по столбцам» – параметр определяет, на какое количество нужно смещать по горизонтали от начальной ячейки. Значения могут быть даже нулевыми и отрицательными.
    </li>
    <li>
        «Размер диапазона в высоту» – количество ячеек, на которое нужно увеличить диапазон в высоту. По сути, название говорит само за себя.
    </li>
    <li>
        «Размер диапазона в ширину» – количество ячеек, на которое нужно увеличить в ширину от начальной ячейки.
    </li>
</ol>

Последние 2 параметра функции являются необязательными. Если их не заполнять, то диапазон будет состоять из 1-ой ячейки. Например: =СМЕЩ(A1;0;0) – это просто ячейка A1, а параметр =СМЕЩ(A1;2;0) ссылается на A3.

Теперь разберем функцию: =СЧЕТ, которую мы указывали в 4-ом параметре функции: =СМЕЩ.

### <center>ЧТО ОПРЕДЕЛЯЕТ ФУНКЦИЯ СЧЕТ</center>

![img](/images/img.png)

Функция =СЧЕТ($B:$B) автоматически считает количество заполненных ячеек в столбце B.

Таким образом, мы с помощью функции =СЧЕТ() и =СМЕЩ() автоматизируем процесс формирования диапазона для имени «доход», что делает его динамическим. Теперь еще раз посмотрим на нашу формулу, которой мы присвоили имя «доход»: =СМЕЩ(Лист1!$B$2;0;0;СЧЁТ(Лист1!$B:$B);1)

Читать данную формулу следует так: первый параметры указывает на то, что наш автоматически изменяемый диапазон начинается в ячейке B2. Следующие два параметра имеют значения 0;0 – это значит, что динамический диапазон не смещается относительно начальной ячейки B2. А увеличивается только его размер по вертикали, о чем свидетельствует 4-тый параметр. В нем находится функция СЧЕТ и она возвращает число равно количеству заполненных ячеек в столбце B. Соответственно количество ячеек по вертикали в диапазоне будет равно числу, которое нам даст функция СЧЕТ. А за ширину диапазона у нас отвечает последний 5-тый параметр, где находиться число 1.

Благодаря функции СЧЕТ мы рационально загружаем в память только заполненные ячейки из столбца B, а не весь столбец целиком. Данный факт исключает возможные ошибки связанные с памятью при работе с данным документом.

### <center>ДИНАМИЧЕСКИЕ ДИАГРАММЫ В EXCEL</center>

У нас есть динамическое имя, теперь создадим динамическую диаграмму для данного типа отчета:

<ol>
    <li>Выделите диапазон B2:B6 и выберите инструмент: «Вставка»-«Диаграммы»-«Гистограмма»-«Гистограмма с группировкой».</li>
    <li>
        Щелкните левой кнопкой мышки по любому столбцу гистограммы и в строке формул отобразится функция диаграммы: =РЯД().
        ![img](/images/img.png)
    </li>
    <li>
        В строке формул измените параметры функции: =РЯД(Лист1!$B$1;;Лист1!$B$2:$B$7;1) на =РЯД(Лист1!$B$1;;Лист1!доход;1).
    </li>
    <li>
        В отчет добавьте новую запись в ячейки A8 - «июль», B8 - «77000» соответственно. И убедитесь, что на диаграмме автоматически добавился новый столбец.
    </li>
</ol>

![img](/images/img.png)

Используя наше динамическое имя «доход» нам удалось создать автоматически изменяемую динамическую диаграмму, которая сама добавляет и отображает новые данные в отчете.

## <center>ИЗМЕНЯЕМЫЕ ДИАПАЗОНЫ И ФУНКЦИЯ ПРОМЕЖУТОЧНЫЕ ИТОГИ В EXCEL</center>

Динамически изменяемы диапазоны очень удобно использовать вместе с функцией ПРОМЕЖУТОЧНЫЕ.ИТОГИ(). Рассмотрим конкретный пример:

Составьте схематическую таблицу, которая условно представляет собой клиентскую базу, так как показано ниже на рисунке.

![img](/images/img.png)

Данная таблица изменяема и у нее неопределенно количество строк. Одни строки могут добавляться другие удаляться в процессе работы.

В нашей базе можно отфильтровать клиентов, которые живут в городе заданном критерием фильтра. В ячейке F1 мы будем отображать, какой процент наших клиентов живет в том или ином городе.

Так как размер нашей клиентской базы неопределенный мы будем использовать динамические имена с изменяемыми диапазонами:

<ol>
    <li>Выберите инструмент: «Формулы»-«Определенные имена»-«Присвоить имя».</li>
    <li>
        В диалоговом окне «Создание имени» в первое поле вводим слово «клиенты», а для поля «Диапазон:» вводим функцию со следующими параметрами: =СМЕЩ($A$1;1;0;СЧЁТЗ($A:$A)-1;1)
        ![img](/images/img.png)
    </li>
    <li>В ячейку F1 введите формулу: =ПРОМЕЖУТОЧНЫЕ.ИТОГИ(3; клиенты)/СЧЁТЗ(клиенты)</li>
    <li>Перейдите на любую ячейку нашей базы в диапазоне A1:C11 и выберите инструмент: «Данные»-«Сортировка и фильтр»-«Фильтр».</li>
    <li>Отфильтруйте данные по городу «Москва» (столбец C), а в ячейке F1 сразу же отобразиться процент наших клиентов приживающих в данном городе.</li>
</ol>

![img](/images/img.png)

При создании динамического имени, мы использовали функцию СЧЁТЗ($A:$A)-1. Данная функция считает количество заполненных ячеек в столбце A. Но нам нужно было исключить заголовок столбца «Имя» поэтому сразу после функции стоит -1.

В ячейке F1 мы использовали функцию =ПРОМЕЖУТОЧНЫЕ.ИТОГИ(3; клиенты). Первым параметром мы указываем, какую функцию использовать для нашего динамического диапазона «клиенты». Код параметр 3 (или 103) – это использование той же функции СЧЁТЗ() только уже для отфильтрованного результата. То есть считаются только те непустые ячейки, которые остались после использования фильтра.

Формула в ячейке F1 показывает точные данные, если база клиентов заполонена правильно. Например, нельзя, чтобы клиент был внесен в базу без имени, а только фамилия и город. Иначе значение в ячейке F1 не соответствует действительности. Также нельзя указывать только имя и фамилию без города.

# <center>СОЗДАНИЕ ДИАГРАММ И ГРАФИКОВ В EXCEL</center>

## <center>АВТОМАТИЧЕСКОЕ СОЗДАНИЕ ГРАФИКОВ И ДИАГРАММ В EXCEL</center>

В новых версиях Excel разработчики максимально автоматизировали процесс создания диаграмм и графиков. В следующих примерах данного урока мы рассмотрим базовые возможности Excel в области создания диаграмм и графиков.

### <center>КАК БЫСТРО СОЗДАТЬ ДИАГРАММУ ИЛИ ГРАФИК</center>

Создайте таблицу, по которой нужно будет создать графическое отображение ее содержимого:

![img](/images/img.png)

Теперь мы выполним несколько простых действий:

<ul>
    <li>создадим гистограмму;</li>
    <li>изменим на ней размер шрифта;</li>
    <li>проверим динамическое изменение на графике в зависимости от изменения данных в таблице.</li>
</ul>

Для начала работы выделите диапазон A1:C4 и выполняйте следующие действия:

<ol>
    <li>
        Нажмите клавишу F11, после чего у вас автоматически создастся диаграмма на отдельном листе. Так же автоматически активизируется панель инструментов: «Работа с диаграммами»-«Конструктор».
        ![img](/images/img.png)
    </li>
    <li>
        Измените тип диаграммы на: «Гистограмма»-«Гистограмма с группировкой».
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните правой кнопкой мышки по легенде и выберите опцию «Шрифт» в контекстном меню. В появившемся окне укажите больший размер шрифта (например, 12) и нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Выберите инструмент «Конструктор»-«Расположение»-«Переместить диаграмму». В появившемся диалоговом окне: «Перемещение диаграммы» выберите опцию «на имеющемся листе», а из выпадающего списка укажите лист где размещена таблица с исходными данными «Лист1» и нажмите ОК.
    </li>
</ol>    

![img](/images/img.png)
![img](/images/img.png)

График переместился на лист, где находятся его исходные данные. Теперь проверим их связь между собой. Для этого сделайте любые изменения в значениях таблицы. Например, измените размер выручки Магазина 2 в понедельник. После нажатия клавиши Enter график динамически изменяет отображение значений в соответствии с новыми значениями в таблице.

![img](/images/img.png)

Для следующего примера удалите текущий график. Для этого щелкните по графику, чтобы активировать его и нажмите клавишу «DELETE» на клавиатуре.

_Примечание. Обратите внимание, что при переносе графика с отдельного листа, сам лист «Диаграмма1» удаляется автоматически._

### <center>КАК ИЗМЕНИТЬ ОСИ В ГРАФИКЕ EXCEL</center>

Снова выделите диапазон A1:C4 и нажмите комбинацию горячих клавиш для создания графика ALT+F1. Снова в конструкторе измените тип диаграммы на гистограмму с группировкой. В результате у нас по оси X отображаются магазины, а нужно там отобразить дни недели.

Теперь проследим одну важную особенность автоматического создания диаграмм и графиков:

<ol>
    <li>Удалите текущую гистограмму. Щелкните по ней левой кнопкой мышки и нажмите клавишу «DELETE» на клавиатуре.</li>
    <li>Измените таблицу, добавив все рабочие дни недели.</li>
    <li>Выделите диапазон A1:F4 и снова нажмите комбинацию клавиш ALT+F1.</li>
</ol>

![img](/images/img.png)

Теперь при создании график поменял значения на осях X и Y. Возникает вопрос, почему так ведет себя Excel? Ответ очень прост: Excel всегда распределяет данные на графике так, чтобы большее количество данных приходилось на ось X, а меньшее – на ось Y соответственно.

**Внимание!** При необходимости всегда можно вручную задать какие данные на каких осях графика должны находиться. Для этого в конструкторе выберите инструмент «Строка/столбец» или воспользуйтесь инструментом «Выбрать данные».

![img](/images/img.png)

В данном примере только разъясняется логическое поведение Excel при автоматическом создании графиков с использованием шаблонов по умолчанию.

### <center>ВОЗМОЖНОСТИ ДИАГРАММ И ГРАФИКОВ В EXCEL</center>

Визуальный анализ данных записанных в таблицах Excel это утомительный и рутинный рабочий процесс. Как не парадоксально, но в большинстве случаев нас интересует не детали отчетов, а общее представление текущей ситуации и тенденции ее изменения. Из отчетов в таблицах Excel мы хотим быстро и легко получать разного рода важную информацию о бизнесе:

<ul>
    <li>какие ценности растут, какие снижаются;</li>
    <li>в каком месяце доходы были самые высокие, а в каком низкие;</li>
    <li>на какой продукт магазин тратит наибольшую часть вложенных средств и т.п.</li>
</ul>

Естественно значительно удобнее читать, понять и воспринять такого рода информацию из графиков, чем из таблиц.

С каждой новой версией Excel появляются все новые и усовершенствованные инструменты для создания и редактирования диаграмм и графиков. В один клик мышкой можно изменять типы диаграмм и стили их оформления. Теперь нет необходимости шаг за шагом выстраивать строить графики. Достаточно только выделить диапазон ячеек с исходными данными и выбрать готовый базовый шаблон графика, который потом легко преобразовать и настроить под свои потребности. Данный метод создания графиков и диаграмм удовлетворяет до 90% потребностей пользователей. Для особенных задач присутствует возможность детального разбора графического представления информации. Если часто приходится сталкиваться с уникальными задачами, то можно создать свои пользовательские шаблоны графиков или диаграмм. Для типичных наиболее часто решаемых задач стоит использовать базовые шаблоны, предлагаемые программой по умолчанию.

Часто-используемые возможности диаграмм и графиков рассмотрим на следующих уроках с полезными, практическими примерами.

## <center>КАК ПОСТРОИТЬ ГРАФИК ФУНКЦИИ В EXCEL</center>

Чтобы правильно построить линейный график функций в Excel необходимо выбрать точечную диаграмму с прямыми отрезками и маркерами. Естественно это не единственный, но весьма быстрый и удобный способ.

Для разного рода данных нужно использовать разные типы графиков. Убедимся в этом, разобрав практический пример с построением математического графика функций в Excel.

### <center>ПОСТРОЕНИЕ ГРАФИКОВ ФУНКЦИЙ В EXCEL</center>
Начнем из анализа и создания графика функций в Excel. Мы убедимся в том, что линейный график в Excel существенно отличается от графика линейной функции, который преподают в школе.

Линейная функция x=y имеет следующие значения: x1=0, x2=1, x3=7. Заполните таблицу этими значениями как показано на рисунке:

![img](/images/img.png)

Выделите диапазон A1:B4 и выберите инструмент: «Вставка»-«Диаграммы»-«График»-«График с маркерами».

![img](/images/img.png)

В результате у нас созданы 2 линии на графике, которые наложены одна сверх другой. Так же мы видим, что линии сломаны, а значит, они не соответствуют презентации школьному графику линейной функции. Излом линий, получается, по причине того, что на оси X у нас после значений: 0, 1 сразу идет значение 7 (упущены 2,3,4,5,6).

**Вывод один:** данный способ графического построения данных нам не подходит. А значит щелкните по нему левой кнопкой мышки (чтобы сделать его активным) и нажмите клавишу DELETE на клавиатуре, чтобы удалить его.

**Как построить график линейной функции в Excel?**

Чтобы создать правильный график функций в Excel выберите подходящий график.

Выделите диапазон A1:B4 и выберите инструмент: «Вставка»-«Диаграммы»-«Точечная»-«Точечная с прямыми отрезками и маркерами».

![img](/images/img.png)

Как видно на рисунке данный график содержит одинаковое количество значений на осях X и Y. По умолчанию в шаблоне данного графика цена делений оси X равна 2. При необходимости ее можно изменить. Для этого:

<ul>
    <li>
        наведите курсор мышки на любое значение оси X чтобы появилась всплывающая подсказка «Горизонтальная ось (значений)» и сделайте двойной щёлочек левой кнопкой мышки;
        ![img](/images/img.png)
    </li>
    <li>
        в появившемся окне «Формат оси» выберите пункт опции: «Параметры оси»-«цена основных делений»-«фиксированное» и установите значение 1 вместо 2.
        ![img](/images/img.png)
    </li>
    <li>
        нажмите на кнопку «Закрыть».
        ![img](/images/img.png)
    </li>
</ul>

Теперь у нас отображается одинаковое количество значений по всем осям.

Очень важно понимать разницу в предназначениях графиков Excel. В данном примере мы видим, что далеко не все графики подходят для презентации математических функций.

_Примечание. В принципе первый способ можно было-бы оптимизировать под отображение линейной функции, если таблицу заполнить всеми значениями 0-7. Но это не всегда работающее решение, особенно в том случае если вместо значений будут формулы изменяющие данные. Одним словом если нужно забить гвоздь лучше взять молоток, чем микроскоп. Несмотря на то, что теоретически гвозди можно забивать и микроскопом._

Не существует универсальных графиков и диаграмм, которыми можно отобразить любой отчет. Для каждого типа отчета наиболее подходящее то или иное графическое представление данных. Выбор зависит от того что и как мы хотим презентовать. На следующих примерах вы убедитесь, что выбор имеет большое значение. Существует даже целая наука «Инфографика», которая учит лаконично презентовать информацию с максимальным использованием графики вместо текста, насколько это только возможно.

## <center>КАК СДЕЛАТЬ ДИАГРАММУ С ПРОЦЕНТАМИ В EXCEL</center>

Часто в отчетах нужно отобразить в Excel из скольких частей состоит стопроцентная целостность определенного показателя и сколько приходится процентов на каждую его часть. Например, чтобы узнать рентабельность товара нам нужно его цену реализации разбить на части: закупочная цена, покрытие расходов, наценка. Для отображения долей хорошо использовать круговые диаграммы с разноцветными секторами. Рассмотрим все более детально на конкретном примере.

### <center>КРУГОВЫЕ ДИАГРАММЫ С ПРОЦЕНТАМИ В EXCEL</center>

Допустим, у нас есть условный товар, о котором мы все знаем в цифрах. Но нам нужно определить какими партиями его продавать. Если его наценка составляет 15%-20% значит, данный товар будет реализовываться только оптовыми партиями, а если более 20% – розничными. Розничная цена для данного товара не должна превышать 1700, а оптовая – 1400. Низкорентабельные товары будем считать с наценкой менее 15%. Теперь заполните таблицу, так как показано на рисунке:

![img](/images/img.png)

Сделаем круговую диаграмму с процентами:

Выделите диапазон B2:B4 выберите инструмент: «Вставка»-«Диаграммы»-«Круговая».

![img](/images/img.png)

Если кликнуть по диаграмме у нас активируется дополнительная панель. На ней выберите тип отображения с процентным соотношением долей: «Работа с диаграммами»-«Конструктор»-«Макеты диаграмм»-«Макет 6».

![img](/images/img.png)

Теперь нам наглядно видно, что наценку лучше увеличить на 50 и продавать данный товар в розницу. Так как оптовыми партиями реализовывать его будет нерентабельно.

Экспонируем наценку, чтобы повысить презентабельность диаграммы. Для этого первый раз кликните по кругу диаграммы. А второй раз непосредственно по сектору наценки. После чего удерживая левую клавишу мышки, немного сместите сектор наценки.

![img](/images/img.png)

**Кольцевая диаграмма с процентами**

Презентуем с помощью диаграммы таблицу с данными о деятельности фирмы за 2 года. И сравним их в процентном соотношении. Постройте следующую таблицу:

![img](/images/img.png)

Для решения данной задачи можно использовать 2 круговые диаграммы. Но в данном примере мы будем использовать более эффективный инструмент:

<ol>
    <li>
        Выделите диапазон A2:C4 и выберите инструмент: «Вставка»-«Диаграммы»-«Другие»-«Кольцевая».
        ![img](/images/img.png)
    </li>
    <li>
        Чтобы улучшить внешний вид выберите: «Работа с диаграммами»-«Конструктор»-«Стили диаграмм»-«Стиль10».
    </li>
    <li>
        Для отображения значений на диаграмме в процентах выбираем: Работа с диаграммами»-«Конструктор»-«Макеты диаграмм»-«Макет 2».
    </li>
</ol>

![img](/images/img.png)

Главная цель этих двух примеров – показать разницу между разными типами диаграмм и их отличие перед гистограммами. Их рассмотрим в следующем примере.

### <center>ГИСТОГРАММА В ПРОЦЕНТАХ</center>

Теперь рассмотрим, как сделать в Excel гистограмму на проценты. Для примера возьмем эту же таблицу презентуем с помощью сразу 3-х гистограмм. Снова выделите диапазон ячеек A2:C4 и выберите: «Вставка»-«Диаграмма»-«Гистограмма»:

<ul>    
    <li>«Объемная гистограмма с группировкой»;</li>
    <li>«Объемная гистограмма с накоплением»;</li>
    <li>«Объемная нормированная гистограмма с накоплением».</li>
</ul>

![img](/images/img.png)
![img](/images/img.png)
![img](/images/img.png)

Теперь на всех созданных гистограммах используйте переключатель: «Работа с диаграммами»-«Конструктор»-«Строка/столбец».

![img](/images/img.png)
![img](/images/img.png)
![img](/images/img.png)

Изначально при создании гистограмм Excel разместил по умолчанию годы в рядах, а наименования показателей в категориях. Так как наименований больше они попали в категории. А нам нужно было сравнить показатели по годам и для этого мы поменяли строки со столбцами местами, используя переключатель «Строка/столбец».

Вкратце опишем, что отображает каждый тип выбранной гистограммы в данном примере:

<ol>
    <li>Объемная гистограмма с группировкой – позволяет оценить изменения всех типов расходов. Известно, что они изменились, но неизвестно есть ли существенные изменения в процентном соотношении?</li>
    <li>Объемная гистограмма с накоплением – легко можно оценить суммарное снижение расходов в 2013-ом году. Но все еще неизвестно как изменилась ситуация в процентах?</li>
    <li>Объемная нормированная гистограмма с накоплением – видно, что сумма транспортных расходов в процентах не существенно изменилась. Существенно возросли расходы на реализацию. А накладные расходы наоборот уменьшились. Но с другой стороны не знаем абсолютных значений и суммарных изменений.</li>
</ol>

Каждый тип диаграммы отличается своими преимуществами и недостатками. Важно уметь правильно подбирать способ графического отображения для разного рода данных. Этому учит наука «Инфографика».

## <center>КАК ПОСТРОИТЬ ЛЕПЕСТКОВУЮ ДИАГРАММУ В EXCEL</center>

Лепестковую диаграмму пользователи Excel часто недооценивают, а зря. В некоторых случаях ее сложно заменить другими типами диаграмм, а иногда невозможно. Приведем один из таких примеров.

### <center>ПОСТРОЕНИЕ ЛЕПЕСТКОВОЙ ДИАГРАММЫ В EXCEL</center>

Допустим, мы хотим приобрести бывший в употреблении автомобиль для активного отдыха на природе во время выходных. Это должен быть внедорожный класс автомобилей за небольшую цену в рабочем состоянии. Для примера рассмотрим 2 модели старый военный УАЗ и старый внедорожник швейцарской армии Pinzgauer. Перед тем как сделать выбор сделаем сравнение преимуществ и недостатков этих двух внедорожников по пяти-бальной системе. В данном примере ограничимся только шестью свойствами весьма существенных для вездеходных качеств автомобилей.

![img](/images/img.png)

Как видно ниже на рисунке оба автомобиля обладают своими преимуществами и недостатками. Поэтому нельзя сразу однозначно отдать предпочтение одному из выбранных автомобилей.

Теперь продемонстрируем, как нас может выручить лепестковая диаграмма в данной ситуации.

Выделите диапазон ячеек A1:C7 и выберите инструмент: «Вставка»-«Диаграммы»-«Другие»-«Заполненная лепестковая».

![img](/images/img.png)

Площадь лепестковой диаграммы отображает, какие показатели более свойственны, для тех или иных сравниваемых величин. Где они схожи, а где наиболее различны. В чем их главный плюс и основное отличие.

Теперь нам невооруженным взглядом видно, что с точки зрения цены абсолютным лидером является УАЗ. Но по техническим характеристикам все же выигрывает Pinzgauer.

## <center>ПУЗЫРЬКОВАЯ ДИАГРАММА В EXCEL И ИНФОГРАФИКЕ</center>

Пузырьковая диаграмма в Excel используется достаточно редко, но достаточно часто ее используют в «Инфографике». Поэтому каждому пользователю Excel стоит знать о ее бесспорных преимуществах.

### <center>КАК ПОСТРОИТЬ ПУЗЫРЬКОВУЮ ДИАГРАММУ В EXCEL</center>

На практическом примере отобразим пользу и построение пузырьковой диаграммы в Excel.

В районном центре, в который входят 3 населенных пункта, наступили выборы мера. На главную кандидатуру представлен лидер партии, о котором люди разного мнения во всех 3-х населенных пунктах. Так же в них разное количество жителей и желающих участвовать в выборах. О чем свидетельствуют данные записанные по каждому населенному пункту.

Команда пиар-менеджмента лидера партии хочет спрогнозировать результаты выборов при текущем отношении избирателей к своему клиенту-кандидату.

Отобразим данные об избирателях на пузырьковой диаграмме, чтобы легче было понять, где нужно наиболее активно проводить агитацию. Составьте таблицу данных об избирателях как показано на рисунке:

![img](/images/img.png)

<ol>
    <li>Выделите диапазон B2:D4 и выберите инструмент: «Вставка»-«Диаграммы»-«Другие»-«Пузырьковая».</li>
    <li>Наш диапазон данных B2:D4 обладает одинаковым количеством строк и столбцов. Поэтому Excel может неправильно расположить данные. В таком случаи используйте инструмент: «Работа с диаграммами»-«Конструктор»-«Строка/столбец».</li>
    <li>
        Отредактируйте диаграмму. Сначала выберите: «Работа с диаграммами»-«Конструктор»-«Макеты диаграмм»-«Макет 7».
        ![img](/images/img.png)
    </li>
    <li>
        Сделайте двойной щелчок левой кнопкой мышки по любой подписи справа возле любого пузырька. И в появившемся окне «Формат подписи данных» выберите 2 опции в разделе «Параметры подписи». Первая опция – «размеры пузырьков», вторая – «В центре». Галочки в «значения X» и «значения Y» можно убрать.
    </li>
</ol>

![img](/images/img.png)

**Полезный совет!** Чтобы добавить названия осей на диаграмму используйте инструмент: «Работа с диаграммами»-«Макет»-«Название осей»-«Название основной горизонтальной оси»-«Название под осью» и «Название основной вертикальной оси»-«Повернутое название».

Как видно на диаграмме, наиболее важную роль для нашего кандидата в меры играют первые 2 населенных пункта: Коровьи Валы и Долинская. Они принесут наиболее весомое значение в результат выборов. Так же там проживает большая часть жителей готовых голосовать за нашего кандидата. Нерентабельными будут агитационные вложения в Плютово, так как там люди неохотно желают голосовать. А те, которые и придут на выборы, то большая их часть проголосует за конкурентов.

## <center>ПОВЕРХНОСТНАЯ ДИАГРАММА В EXCEL И ПРИМЕР ЕЕ ПОСТРОЕНИЯ</center>

Принцип построения поверхностных диаграмм в Excel можно сравнить с рельефными картами. Где положение пункта определяется не только долготой и широтой, но и третьей величиной – высотой.

Данное сравнение поможет понять, как создать на первый взгляд сложную поверхностную диаграмму в Excel и как ее использовать.

### <center>ПОСТРОЕНИЕ ПОВЕРХНОСТНОЙ ДИАГРАММЫ В EXCEL</center>

Практический пример применения и создания поверхностной диаграммы в Excel.

Напряжение излучения в квадратной комнате определено формулой z=[sin(x)*y]2. Начало осей координат расположено центру комнаты.

Визуально сложно определить место в комнате, где наиболее интенсивное излучение. Создадим графическое представление ситуации, которое будет читабельно даже для дилетантов.

Сначала выполним все необходимые расчеты и вычисления в таблице. А поверхностную диаграмму построим на основе уже полученных данных.

<ol>
    <li>
        Заполните таблицу как указано на рисунке.
        ![img](/images/img.png)
    </li>
    <li>
        Выделите диапазон B2:L12 так, чтобы B2 активной ячейкой выделенного диапазона (выделяйте с верхнего левого угла B2 диапазона к нижнему правому углу до ячейки L12).
    </li>
    <li>
        Не снимая выделения, введите в строку формул: =(SIN(B$13)*$A2)^2 и нажмите комбинацию клавиш CTRL+Enter. Обратите внимание, как мы используем в аргументах формулы смешанные ссылки на ячейки.
        ![img](/images/img.png)
    </li>
    <li>
        Между столбцами A и B вставьте новый столбец и заполните его вторую ячейку формулой: =" "&A2 (не забудьте поставить пробел между кавычками). Скопируйте эту формулу во все ячейки столбца до 12-ой строки (то есть заполните этой формулой диапазон ячеек B2:B12).
    </li>
    <li>Выделите диапазон: B2:M12 и выберите инструмент: «Вставка»-«Диаграммы»-«Другие»-«Поверхность».</li>
</ol>

![img](/images/img.png)

Теперь четко видно на диаграмме что наибольшая интенсивность излучения находится в углах комнаты.

Чтобы правильно настроить горизонтальную ось X, щелкните по диаграмме, чтобы ее активировать и выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Выбрать данные».

![img](/images/img.png)

В появившемся окне «Выбор источника данных» в правом разделе «Подписи горизонтальной оси (категории)» щелкните на кнопку «Изменить».

![img](/images/img.png)

В окне «Подписи оси» измените значение, выделив диапазон ячеек C13:M13 и на всех диалоговых окнах нажмите ОК.

![img](/images/img.png)

### <center>КРАТКОЕ ОПИСАНИЕ ПРИМЕРА</center>

**Стоит отметить!** При создании поверхностной диаграммы мы изменили числовые значения столбца A в текстовые, поместив их в столбец B с помощью формулы . Если бы мы этого не сделали, то Excel воспринял бы эти числовые значения (столбца A) как данные для построения поверхностной диаграммы, а не как подписи данных.

Если бы мы просто присвоили текстовый формат для значений столбца A (вместо дополнительного столбца с формулами), тогда мы просто получили бы ошибку при расчетах.

Вот в такой нехитрый способ мы красиво сделали подписи для осей диаграммы и не допустили ошибок при расчетах.

## <center>ПОСТРОЕНИЕ ЛИНИИ ТРЕНДА В EXCEL ДЛЯ АНАЛИЗА ГРАФИКА</center>

Очень часто на графиках с большим количеством информации содержит колебания (шумы), из-за которых усложняется восприятия информации. Благодаря линиям тренду можно экспонировать главную тенденцию, которую отображает график. Линия тренда как будто визуально отфильтровывает шумы на графике, а информация становится более понятной.

### <center>КАК ДОБАВИТЬ ЛИНИЮ ТРЕНДА НА ГРАФИК</center>

Данные в диапазоне A1:B7 отобразим на графике и найдем линейную функциональную зависимость y=f(x):

<ol>
    <li>
        Выделите диапазон A1:B7 и выберите инструмент: «Вставка»-«Диаграммы»-«Точечная»-«Точечная с гладкими кривыми и маркерами».
        ![img](/images/img.png)
    </li>
    <li>
        Когда график активный нам доступная дополнительная панель, а в ней выберите инструмент: «Работа с диаграммами»-«Макет»-«Линия тренда»-«Линейное приближение»
        ![img](/images/img.png)
    </li>
    <li>
        Сделайте двойной щелчок по лини тренду и в появившемся окне поставьте галочку напротив опции: «показывать уравнение на диаграмме».
        ![img](/images/img.png)
    </li>
</ol>

_Примечание. Если на графике находится несколько линий данных, тогда предварительно следует выделить линию того графика для которого следует включить линию тренда._

### <center>ПРОГНОЗИРОВАНИЕ В EXCEL С ПОМОЩЬЮ ЛИНИИ ТРЕНДА</center>

Сменим график на гистограмму, чтобы сравнить их уравнения:

<ol>
    <li>
        Щелкните правой кнопкой по графику и выберите опцию из контекстного меню: «Изменить тип диаграммы».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне выберите параметр: «Гистограмма»-«Гистограмма с группировкой».
        ![img](/images/img.png)
    </li>
</ol>

Как видно оба графика отображают одни и те же данные, но у них разные уравнения трендовых линий, сохраняется только направление тенденции (снизу вверх).

Из этого следует, что линия тренда это только аппроксимирующий (приближенный) инструмент.

Сравним уравнения на разных типах графиков. На оси координат XY:

<ul>
    <li>прямая с уравнением: y=2,4229x-3,519 пересекает вертикальную ось Y в отрицательном значении оси: y=-3,519.</li>
    <li>прямая с уравнением: y=2,4229x+18,287 пересекает вертикальную ось Y на уровне: y=18,287.</li>
</ul>

Чтобы визуально убедится в этом, сделаем следующее:

<ol>
    <li>Снова измените гистограмму на точечную диаграмму. Правой кнопкой по гистограмме «Изменить тип диаграммы», далее «Точечная»-«Точечная с гладкими кривыми и маркерами».</li>
    <li>Сделайте двойной щелчок по линии тренда и измените ее параметры так: «Прогноз»-«назад на:» установите значение 12,0. И нажмите ОК.</li>
</ol>

![img](/images/img.png)

Теперь, даже визуально видно, что угол наклонения линии на разных типов графиков отличается. Но направление тенденции сохраняется. Это удобный инструмент для визуального восприятия тенденции. Но при анализе графиков его следует воспринимать как аппроксимирующий вспомогательный инструмент.

## <center>ПОСТРОЕНИЕ ГРАФИКОВ В EXCEL ПРАКТИЧЕСКАЯ РАБОТА</center>

Задания на построение графиков в Excel с примерами и описанием. Все примеры интересны и полезно-применимы в работе с Excel. Так же они позволяют понять принцип работы и возможности доступных инструментов в Excel для графического представления информации из таблиц.

### <center>НЕСКОЛЬКО ГРАФИКОВ НА ОДНОЙ ДИАГРАММЕ EXCEL</center>

И з этого примера мы узнаем, как построить несколько графиков в Excel.

Данные указанные ниже на рисунке следует графически отобразить двумя графиками с разными шкалами:

![img](/images/img.png)

<ul>
    <li>показатели роста – надо отобразить гистограммой;</li>
    <li>показатели веса – следует отобразить линейным графиком с маркерами;</li>
    <li>показатели возраста будут отображаться только как подписи для данных, а не как значения графика.</li>
</ul>

Обратите внимание на форматы ячеек:

<ul>
    <li>в столбце A каждая ячейка содержит число и текст (так как эти значения будут подписями данных);</li>
    <li>в столбцах B и C находятся числовые значения оформлены нестандартным форматом.</li>
</ul>

Наш график будет построен по принципу «два в одном». Только сначала сделаем гистограмму и на нее наложим линейный график:

<ol>
    <li>
        Выделите диапазон A1:C6 и выберите инструмент: «Вставка»-«Диаграммы»-«Гистограмма»-«Гистограмма с группировкой».
        ![img](/images/img.png)
    </li>
    <li>
        Правой кнопкой мышки щелкните по любому столбику гистограммы, но только второго ряда и выберите опцию в контекстном меню «Изменить тип диаграммы для ряда».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне «Изменение типа диаграммы» укажите на новый тип: «График»-«График с маркерами».
        ![img](/images/img.png)
    </li>
    <li>
        Добавляем дополнительную вертикальную ось на график. Щелкните правой кнопкой мышки по ново-созданному линейному графику и в контекстном меню выберите опцию: «Формат ряда данных». В появившемся окне поставьте пункт напротив опции: «Параметры ряда»-«Построить ряд»-«По вспомогательной оси» И нажмите кнопку «Закрыть».
        ![img](/images/img.png)
    </li>
</ol>

В результате у нас получился очень информативный график!

В столбце A мы отображаем числа в текстовом формате ячеек, чтобы Excel распознал их как подписи данных на графике. Если же этого не сделать, то при создании графического представления буде добавлен еще один ряд данных на график. И нам бы пришлось его удалить. Или же перед созданием нужно было-бы выделять диапазон, который охватывает только значения представляемых данных B1:C2. А потом изменять и настраивать выбор источника данных: «Работа с диаграммами»-«Конструктор»-«Выбрать данные». А так все настроилось автоматически.

В Excel большинство задач можно решить несколькими путями. Мы знакомим Вас с самыми короткими из них.

### <center>ЗАДАНИЕ НА ПОСТРОЕНИЕ ГРАФИКОВ С НАКОПЛЕНИЕМ</center>

Допустим, мы пытаемся накопить 2000$ на любые цели за любой срок. Каждый день недели записываем, сколько нам удалось отложить. Создадим график «термометр», который будет отображать, сколько у нас накоплено денег и процент реализации цели.

![img](/images/img.png)

Нам заранее неизвестно, за сколько дней нам удастся реализовать свою цель. Поэтому количество записей в столбце A и B не может быть ограничено.

Для начала заполним все формулы:

<ul>
    <li>в ячейку E1 вводим сумму, которую хотим накопить (2000$);</li>
    <li>в ячейке E2 формула: =СУММ(B:B) данной формулой мы суммируем целый столбец та как на перед мы не знаем какое количество значений он будет содержать;</li>
    <li>в ячейке E4 формула: =E2/E1;</li>
    <li>в ячейке E5 формула: =1-E4.</li>
</ul>

Для всех значений таблицы задайте формат ячеек такой же, как на рисунке.

<ol>
    <li>
        Перейдите курсором на ячейку E4 и выберите инструмент: «Вставка»-«Диаграммы»-«Гистограмма»-«Нормированная гистограмма с накоплением». Обратите внимание, что при создании гистограммы диапазон данных автоматически расширился из одной ячейки E4 до блока ячеек D3:D5.
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните по гистограмме левой кнопкой мышки чтобы сделать ее активной и доступным дополнительную верхнюю панель инструментов. И там выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Строка/столбец». Таким образом, мы создали гистограмму с одним столбцом.
        ![img](/images/img.png)
    </li>
    <li>
        С помощью дополнительной панели отформатируем гистограмму. Сначала выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Стили диаграмм»-«Стиль 15».
        ![img](/images/img.png)
    </li>
    <li>
        Теперь подпиши столбики гистограммы выбрав инструмент: «Работа с диаграммами»-«Макет»-«Подписи данных»-«В центре».
        ![img](/images/img.png)
    </li>
</ol>   

Теперь можно заполнят значениями колонку B и нижний столбец гистограммы будет расти, а верхний – уменьшаться. Столбцы изменяются динамически, обновляя свои значения.

![img](/images/img.png)

**Обратите внимание!** Формула: =E2/E1 целенаправленно записана в ячейку E4, а не в очередную E3. Если бы они небыли разделены пустой ячейкой E3, тогда Excel при создании гистограммы автоматически включил бы весь диапазон смежных ячеек D1:E5.

## <center>ИНТЕРПОЛЯЦИЯ ГРАФИКА И ТАБЛИЧНЫХ ДАННЫХ В EXCEL</center>

Интерполяция – это своего рода «латание» графиков в тех местах, где возникают обрывы линий из-за отсутствия данных по отдельным показателям. Термин интерполяция подразумевает «латание» внутренних обрывов на графике. А если бы «латались» внешние обрывы, то это была-бы уже экстраполяция графика.

### <center>КАК ПОСТРОИТЬ ГРАФИК С ИНТЕРПОЛЯЦИЕЙ В EXCEL</center>

При работе в Excel приходится сталкиваться с интерполяцией графиков различной сложности. Но для первого знакомства с ней рассмотрим сначала самый простой пример.

Если в таблице еще нет всех значений показателей, но уже нужно сформировать по ним отчет и построить графическое представление данных. Тогда на графике мы наблюдаем обрывы в местах, где отсутствуют значения показателей.

Заполните таблицу как показано на рисунке:

![img](/images/img.png)

Выделите диапазон A1:B4 и выберите инструмент: «Вставка»-«Диаграммы»-«График»-«График с маркерами».

![img](/images/img.png)

Чтобы устранить обрывы на графике, то есть выполнить интерполяцию в Excel, можем использовать 2 решения для данной задачи:

<ol>
    <li>Изменить параметры в настройках графика выбрав соответствующую опцию.</li>
    <li>Использовать функцию: =НД() – возвращает значение ошибки #Н/Д.</li>
</ol>

Оба эти способа рассмотрим далее на конкретных примерах.

**Способ 1:**

<ol>
    <li>
        Сделайте график активным щелкнув по нему левой кнопкой мышки и выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Выбрать данные».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне «Выбор источника данных» кликните на кнопку «Скрытые и пустые ячейки»
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне «Настройка скрытых и пустых ячеек» выберите опцию «линию». И нажмите ОК во всех открытых диалоговых окнах.
        ![img](/images/img.png)
        ![img](/images/img.png)
    </li>
</ol>    

Как видно на рисунках сразу отображены 2 варианта опций «линию» и «нулевые значения». Обратите внимание, как ведет себя график при выборе каждой из них.

### <center>МЕТОДЫ ИНТЕРПОЛЯЦИИ ТАБЛИЧНЫХ ДАННЫХ В EXCEL</center>

Теперь выполним интерполяцию данных в таблице с помощью функции: =НД(). Для этого нужно предварительно сбросить выше описанные настройки графика, чтобы увидеть как работает данный способ.

**Способ 2:** В ячейку B3 введите функцию =НД(). Это автоматически приведет к интерполяции графика как показано на рисунке:

![img](/images/img.png)

_Примечание. Вместо функции =НД() в ячейку можно ввести просто значение: #Н/Д!, результат будет тот же._

## <center>СПАРКЛАЙН ПОЗВОЛЯЕТ СОЗДАТЬ МИНИ ГРАФИК В ЯЧЕЙКЕ EXCEL</center>

Спарклайн в Excel – это график в ячейке (можно назвать мини-графиком). Спарклайн очень удобный дополнительный инструмент для презентации тенденции общего тренда в отчетах. Он эффектно дополняет общее графическое представление о поведении конкретной ситуации. Но определенно его нельзя использовать для детального анализа данных. Почему так и какие преимущества спарклайнов перед обычными графиками? Ответим на этот вопрос конкретным примером.

### <center>КАК СДЕЛАТЬ СПАРКЛАЙН В EXCEL</center>

Разберем на конкретном примере, что такое спарклайны в Excel и как их использовать. Предприятие имеет 5 магазинов в разных районах города. Возле таблицы с показателями оборотов в месяцах первого квартала разместите мини-графики в ячейках отображающие тенденцию изменения оборотов за текущий период:

<ol>
    <li>
        Заполните таблицу данными так как показано ниже на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Выделите диапазон B2:D6 и выберите инструмент: «Вставка»-«Спарклайны»-«График».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне «Создание спарклайнов» укажите значение в полю «Диапазон расположения», выделив диапазон E2:E6. И нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Теперь если выделить диапазон ячеек E2:E6 у нас появляется дополнительная панель инструментов «Работа со спаркалнйами». В ней выберите инструмент: «Конструктор»-«Цвет маркера»-«Маркеры»-«Оранжевый 25%». Это действие сделало мини-графики более читабельными и привлекательными.
    </li>
</ol>

![img](/images/img.png)

Несмотря на то, что спарклайны – это маленькие графики в ячейках их значения все равно легче читать, чем из таблицы. Мы не можем детально проанализировать ситуацию по каждому магазину. Но нам легко быстро оценить общую ситуацию по всех магазина одновременно. Которые магазины хорошо развиваются, а которые нет.

Чтобы оценить преимущества спарклайнов, создайте обычных график и сравните:

<ol>
    <li>Выделите диапазон A1:D6. Потом выберите инструмент: «Вставка»-«Диаграммы»-«График».</li>
    <li>
        Так как у нас категорий (месяцев) меньше чем рядов (магазинов) нужно поменять значения в строках и столбцах. Для этого выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Строка/столбец».
    </li>
</ol>

![img](/images/img.png)

В результате у нас получилась картинка, которая не требует лишних комментариев.

## <center>РАБОТА С ШАБЛОНАМИ ГРАФИКОВ В EXCEL</center>

Создание или оформление нестандартных графиков в Excel с уникальными свойствами и настройками, отнимает достаточно много времени. Поэтому каждый раз после построения очередного нестандартно графика стоит подумать, как скоро он может понадобиться в следующий раз. Возможно, лучше сохранить его как шаблон, чтобы использовать в будущем для новых данных. Ведь каждый вид отчета требует отдельного вида графиков (иногда даже несколько видов). Поэтому каждому пользователю Excel важно уметь создавать шаблоны графиков и использовать их по назначению.

### <center>РАБОТА С ШАБЛОНАМИ ГРАФИКОВ В EXCEL</center>

Создайте график, который часто приходится использовать и сохраните его как шаблон:

<ol>
    <li>
        Создайте таблицу с графиком как ниже на рисунке и для примера немного измененный в оформлении график с маркерами такой как показано ниже на рисунке. Выделите диапазон B1:B6 и сначала используйте стандартный шаблон: «Вставка»-«Диаграммы»-«График»-«График с маркерами». А потом кликните по нему и немного измените его стиль оформления: «Работа с диаграммами»-«Конструктор»-«Стили диаграмм»-«Стиль 32»):
        ![img](/images/img.png)
    </li>
    <li>
        Выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Тип»-«Сохранить как шаблон».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне «Сохранение шаблона диаграммы» заполните поле «Имя файла:» так: «Мой_график_с_маркерами.crtx» и нажмите кнопку «Сохранить».
        ![img](/images/img.png)
    </li>
</ol>

Теперь Ваш пользовательский шаблон графика можно использовать наравне со стандартными встроенными шаблонами в Excel. Чтобы убедиться в этом попробуем его использовать в действии:

<ol>
    <li>Заполните новую табличку с новыми данными как указано ниже на рисунке.</li>
    <li>
        Выделите диапазон C1:C6 и выберите инструмент: «Вставка»-«Диаграммы»-«График»-«Все типы диаграмм».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне «Изменение типа диаграмм» в левой части списка типов графиков укажите на самый первый «Шаблоны», а потом в правой части выберите свой «Мой_график_с_маркерами». И нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

Если вы наиболее часто используете свой пользовательский шаблон по сравнению со стандартными шаблонами графиков, тогда есть смысл сделать его шаблоном по умолчанию. Это значит, что при нажатии на комбинацию горячих клавиш ALT+F1 (или F11 если нужно отобразить большой график на отдельном листе), будет создан график или диаграмма по вашему шаблону и стилю оформления.

Чтобы сделать шаблон по умолчанию сделайте следующее:

<ol>
    <li>Снова откройте окно «Изменение типа диаграмм» как описано выше.</li>
    <li>Перейдите на свой шаблон «Шаблоны»-«Мой_график_с_маркерами» и щелкните по нему левой кнопкой мышки, чтобы выделить его.</li>
    <li>
        Нажмите ниже на кнопку «Сделать стандартной» и нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

Теперь проверим шаблон по умолчанию в действии:

<ul>
    <li>заполните новый столбец в таблице (как ниже на рисунке) и выделите его D1:D6;</li>
    <li>нажмите комбинацию горячих клавиш ALT+F1 (или F11).</li>
</ul>

![img](/images/img.png)

Теперь у Вас есть быстрый доступ к Вашему пользовательскому шаблону графика.

_Примечание. Назначить шаблоном по умолчанию в такой способ можно как пользовательские, так и стандартные встроенные шаблоны Excel._

### <center>КОПИРОВАНИЕ ШАБЛОНОВ ГРАФИКОВ</center>

Шаблоны можно присваивать стандартным графикам разными способами. Удалите все графики, которые у вас созданы на листе выделив каждый и нажав кнопку DELETE на клавиатуре. По каждой колонке (Доход, Расход и Прибыль) создайте любой стандартный график.

![img](/images/img.png)

<ol>
    <li>
        Щелкните по первому графику и выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Тип»-«Изменить тип диаграммы». В появившемся уже знакомому выше описанном окне укажите свой пользовательский шаблон и нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните по первому графику и нажмите комбинацию горячих клавиш CTRL+ C. Потом щелкните по второму графику и нажмите комбинацию клавиш CTRL+ V. Выберите инструмент: «Работа с диаграммами»-«Конструктор»-«Выбрать данные». И в появившемся окне «Выбор источника данных» удалите лишний ряд. Либо просто щелкните по графику и поправьте диапазон используемых данных с помощью перетаскивания выделенной границы.
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните по второму графику и нажмите CTRL+ C. Потом щелкните по третьему графику и выберите инструмент: «Главная»-«Буфер обмена»-«Вставить»-«Специальная вставка» (или просто нажмите CTRL+ALT+V). В появившемся окне следует выбрать опцию: «форматы» и нажать ОК.
    </li>
</ol>

![img](/images/img.png)
![img](/images/img.png)
![img](/images/img.png)

**Полезный совет!** Самый быстрый способ изменить стандартный шаблон на пользовательский (установленный по умолчанию) – это выделить и нажать комбинацию горячих клавиш ALT+F1 (или F11).

# <center>ПОДБОР ПАРАМЕТРА, ПОИСК РЕШЕНИЯ И СЦЕНАРИИ</center>

## <center>УРАВНЕНИЯ И ЗАДАЧИ НА ПОДБОР ПАРАМЕТРА В EXCEL</center>

Часто нам нужно предварительно спрогнозировать, какие будут результаты вычислений при определенных входящих параметрах. Например, если получить кредит на закупку товара в банке с более низкой процентной ставкой, а цену товара немного повысить – существенно ли возрастет прибыль при таких условиях?

При разных поставленных подобных задачах, результаты вычислений могут завесить от одного или нескольких изменяемых условий. В зависимости от типа прогноза в Excel следует использовать соответствующий инструмент для анализа данных.

### <center>ПОДБОР ПАРАМЕТРА И РЕШЕНИЕ УРАВНЕНИЙ В EXCEL</center>

Данный инструмент следует применять для анализа данных с одним неизвестным (или изменяемым) условием. Например:

<center>2**x**+1=7</center>

<ul>
    <li>**y**=7 является функцией **x**;</li>
    <li>нам известно значение **y**, следует узнать при каком значении **x** мы получим **y** вычисляемый формулой.</li>
</ul>

Решим данную задачу встроенными вычислительными инструментами Excel для анализа данных:

<ol>
    <li>
        Заполните ячейки листа, так как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Перейдите в ячейку B2 и выберите инструмент, где находится подбор параметра в Excel: «Данные»-«Работа с данными»-«Анализ что если»-«Подбор параметра».
    </li>
    <li>
        В появившемся окне заполните поля значениями как показано на рисунке, и нажмите ОК:
        ![img](/images/img.png)
    </li>
</ol>

В результате мы получили правильное значение 3.

![img](/images/img.png)

Получили максимально точный результат: 2*3+1=7

### <center>ВТОРОЙ ПРИМЕР ИСПОЛЬЗОВАНИЯ ПОДБОРА ПАРАМЕТРА ДЛЯ УРАВНЕНИЙ</center>

Немного усложним задачу. На этот раз формула выглядит следующим образом:

**x**<sub>2</sub>=4

**Решение:**

<ol>
    <li>
        Заполните ячейку B2 формулой как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Выберите встроенный инструмент: «Данные»-«Работа с данными»-«Анализ что если»-«Подбор параметра» и снова заполните его параметрами как на рисунке (в этот раз значение 4):
        ![img](/images/img.png)
    </li>
    <li>
        Сравните 2 результата вычисления:
        ![img](/images/img.png)
    </li>
</ol>

**Обратите внимание!** В первом примере мы получили максимально точный результат, а во втором – максимально приближенный.

Это простые примеры быстрого поиска решений формул с помощью Excel. Сегодня каждый школьник знает, как найти значение x. Например:

<center>x=(7-1)/2</center>

Excel в своих алгоритмах инструментов анализа данных использует более простой метод – подстановки. Он подставляет вместо x разные значения и анализирует, насколько результат вычислений отклоняется от условий указанных в параметрах инструмента. Как только будет, достигнут результат вычисления с максимальной точностью, процесс подстановки прекращается.

По умолчанию инструмент выполняет 100 повторений (итераций) с точностью 0.001. Если нужно увеличить количество повторений или повысить точность вычисления измените настройки: «Файл»-«Параметры»-«Формулы»-«Параметры вычислений»:

![img](/images/img.png)

Таким образом, если нас не устраивает результат вычислений, можно:

<ol>
    <li>Увеличить в настройках параметр предельного числа итераций.</li>
    <li>Изменить относительную погрешность.</li>
    <li>В ячейке переменной (как во втором примере, A3) ввести приблизительное значение для быстрого поиска решения. Если же ячейка будет пуста, то Excel начнет с любого числа (рандомно).</li>
</ol>

Используя эти способы настроек можно существенно облегчить и ускорить процесс поиска максимально точного решения.

О **подборе нескольких параметров** в Excel узнаем из примеров следующего урока.

## <center>3 ПРИМЕРА ИСПОЛЬЗОВАНИЯ ПОДБОРА ПАРАМЕТРА В EXCEL</center>

На данном уроке мы научимся практически применять вычислительный инструмент «Подбор параметр» в Excel. Специально для Вас подготовлено 3 практических примера, которые могут пригодиться Вам уже сегодня.

### <center>ПОДБОР ПАРАМЕТРА ДЛЯ БАНКОВСКИХ ДЕПОЗИТОВ</center>

На протяжении 10-ти лет мы хотим накопить 20 000$. Свои сбережения будем откладывать на банковский депозит по 5% годовых. Деньги будем вносить на банковский депозитный счет ежегодно и одинаковыми частями взносов. Какой должен быть размер ежегодного взноса, чтобы за 10 лет собрать 20 000$ при 5-т и процентах годовых?

Для решения данной задачи в Excel воспользуемся инструментом «Подбор параметра»:

<ol>
    <li>
        Составьте таблицу как показано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>В ячейку B5 введите функцию: =БС(B1;B2;B3;)</li>
    <li>
        Оставаясь на ячейке B5, выберите инструмент: «Данные»-«Работа с данными»-«Анализ что если»-«Подбор параметра»
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся окне заполните поля, так как на рисунке и нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

Результат вычисления получился с отрицательным числом – это правильно в соответствии со стандартом финансовых функций Excel. Регулярные взносы должны отображаться отрицательным значением, так как это категория расходных операций. А по истечению 10 лет мы получим на приход +20 000$.

**Полезный совет!** Если Вы нужно узнать размер ежемесячных взносов, тогда перед использованием инструмента «Подбор параметра» нужно процентную ставку разделить на 12 (чтобы перевести в ежемесячный процент).

А количество лет нужно перевести в количество месяцев умножив на 12. Таким образом, в ячейке B3 мы получим необходимую сумму ежемесячного взноса для достижения цели.

### <center>ПОИСК РЕШЕНИЙ ПОДБОРОМ ПАРАМЕТРА ПРИ ЦЕНООБРАЗОВАНИИ</center>

Стратегия для построения производственного плана выпуска продукта:

<ol>
    <li>В текущем году продукт должен быть продан в количестве 10 000шт.</li>
    <li>Производственные расходы 1-ой штуки: 7,5 руб.</li>
    <li>Расходы на реализацию: 450 000 руб.</li>
</ol>

Какую установить розничную цену, чтобы рентабельность производства сохранялась на уровне 20%?

Рентабельность определяется как соотношение дохода к прибыли (прибыль разделить на доход) и выражается только в процентах!

Снова решим поставленную задачу в Excel с помощью подбора параметра:

<ol>
    <li>
        Составьте таблицу с исходными данными и формулами, так как указано на рисунке ниже. **Обратите внимание!** В столбце D указаны, какие именно нужно вводить формулы в соответствующие ячейки столбца B. А в ячейке B1 указана цена 1 руб. чтобы избежать ошибок в формуле B3 и B10 (вероятная ошибка деления на 0). Не забудьте отформатировать все ячейки соответствующим форматам: денежный, общий, процентный.
        ![img](/images/img.png)
    </li>
    <li>
        Перейдите в ячейку B10 и выберите инструмент: «Данные»-«Работа с данными»-«Анализ что если»-«Подбор параметра»
        ![img](/images/img.png)
    </li>
    <li>
        Заполните поля в появившемся диалоговом окне как на рисунке и нажмите ОК.
    </li>
</ol>

![img](/images/img.png)

Как видно розничную цену (B1) нужно устанавливать в 2 раза выше производственных расходов на 1-ну штуку продукции. Только тогда мы сможем удержать рентабельность производства на уровне 20% при таких расходах на реализацию. В реальности бывает и еще хуже.

### <center>ПОДБОР ПАРАМЕТРА ДЛЯ БАНКОВСКИХ КРЕДИТОВ</center>

Допустим, Вы хотите приобрести автомобиль в кредит. Максимальная сумма ежемесячного взноса, которую Вы можете себе позволить, составляет 700$. Банк не может выдать Вам кредит сроком более чем на 3 года, с процентной ставкой 5,5% годовых. Можете ли вы себе позволить при таких условиях кредитования приобрести автомобиль стоимостью в 30 000$, а если нет, то на какую сумму можно рассчитывать?

Составьте таблицу условий кредитования в Excel как показано ниже на рисунке. **Обратите внимание!** Ячейка B4 содержит формулу: =-ПЛТ(B3/12;B2;B1).

![img](/images/img.png)

Как видно Вы не можете себе позволить такой дорогой автомобиль. Теперь узнаем, какая максимальная стоимость автомобиля соответствует Вашим финансовым возможностям. Для этого перейдите в ячейку B4 и выберите инструмент: «Данные»-«Работа с данными»-«Анализ что если»-«Подбор параметра».

![img](/images/img.png)

Заполните поля в появившемся диалоговом окне как показано выше на рисунке и нажмите ОК.

![img](/images/img.png)

Как видно максимальная стоимость автомобиля, на которую можно рассчитывать составляет при таких финансовых возможностях и условиях кредитования составляет – 23 1812$.

**Внимание!** Если срок кредитования определяется количеством месяцев, а не лет, то годовую процентную ставку нужно перевести в месячную. Поэтому в первом аргументе функции ПЛТ стоит значение B3/12 (5,5% годовых разделено на 12 месяцев).

Используя финансовые функции, следует помнить об их стандартах. Например, сумма займа всегда отображаются как отрицательное число. Поэтому перед функцией ПЛТ мы использовали знак минус.

## <center>НАДСТРОЙКА ПОИСК РЕШЕНИЯ И ПОДБОР НЕСКОЛЬКИХ ПАРАМЕТРОВ EXCEL</center>

Надстройка Excel «Поиск решения» – это аналитический инструмент, который позволяет нам быстро и легко определить, когда и какой результат мы получим при определенных условиях. Возможности инструмента поиска решения намного выше, чем может предоставить «**подбор параметра**» в Excel.

Основные отличия между поиском решения и подбором параметра:

<ol>
    <li>Подбор нескольких параметров в Excel.</li>
    <li>Наложение условий ограничивающих изменения в ячейках, которые содержат переменные значения.</li>
    <li>Возможность использования в тех случаях, когда может быть много решений одной задачи.</li>
</ol>

Где находится поиск решений в Excel? По умолчанию данная надстройка не установлена. О том, как ее установить читайте: **подключение надстройки «Поиск решения»**.

### <center>ПРИМЕРЫ И ЗАДАЧИ НА ПОИСК РЕШЕНИЯ В EXCEL</center>

Рассмотрим аналитические возможности надстройки. Например, Вам нужно накопить 14 000$ за 10 лет. На протяжении 10-ти лет вы хотите каждый год откладывать на депозитный счет в банке по 1000$ под 5% годовых. Ниже на рисунке построена таблица в Excel, по которой хорошо видно остаток накопленных средств на каждый год.

![img](/images/img.png)

Как видно при таких условиях депозитного счета и взносов накопления цель не будет достигнута даже через 10 лет. При решении данной задачи можно пойти двумя путями:

<ol>
    <li>Найти банк, который предлагает более высокую процентную ставку по депозитам.</li>
    <li>Увеличить размер ежегодных накопительных взносов на банковский счет.</li>
</ol>

Мы можем изменять переменные значения в ячейках B1 и B2 так, чтобы подобрать необходимые условия для накопления необходимой суммы денег.

Надстройка «Поиск решения» - позволяет нам одновременно использовать 2 этих варианта, чтобы быстро смоделировать наиболее оптимальные условия для достижения поставленной цели. Для этого:

<ol>
    <li>
        Перейдите в ячейку B14 и выберите инструмент: «Данные»-«Анализ»-«Поиск решения».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне заполните все поля и параметры так как указано ниже на рисунке. Не забудьте убрать галочку напротив опции: «Сделать переменные без ограничений неотрицательными». И нажмите «Найти решение».
        ![img](/images/img.png)
    </li>
</ol>

Как видно программа немного увеличила процентную ставку и сумму ежегодных взносов.

**Ограничение параметров при поиске решений**

Допустим, вы пошли в банк с этой таблицей, но банк отказывается поднять Вам процентную ставку. В таком случаи нам нужно узнать, насколько нам придется повысить сумму ежегодных вложений. Мы должны установить ограничение на ячейку с одним переменным значением. Но перед началом измените значения в переменных ячейках на исходные: в B1 на 5%, а в B2 на -1000$. А теперь делаем следующее:

<ol>
    <li>Перейдите в ячейку B14 и выберите инструмент: «Данные»-«Анализ»-«Поиск решения».</li>
    <li>Напротив списка параметров: «В соответствии с ограничениями» нажмите на кнопку «Добавить».</li>
    <li>
        В появившемся окне «Добавление ограничения» заполните поля так как указано выше на рисунке. И нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Снова заполняем параметры и поля появившегося диалогового окна, как в предыдущем примере:
        ![img](/images/img.png)
    </li>
    <li>
        Нажмите «Найти решение».
        ![img](/images/img.png)
    </li>
</ol>

Данный базовый пример открывает Вам возможности использовать аналитический инструмент для более сложных задач, где нужно добавлять ограничения на некоторые показатели при анализе данных.

## <center>СЦЕНАРИИ В EXCEL ПОЗВОЛЯЮТ ПРОГНОЗИРОВАТЬ РЕЗУЛЬТАТ</center>

При работе в Excel часто приходится сталкиваться с большими и сложными отчетами, которые содержат много длинных формул с разными функциями в аргументах. К тому же формулы могут быть трехмерными и могут ссылаться на другие листы или даже книги.

### <center>СОЗДАНИЕ СЦЕНАРИЕВ В EXCEL</center>

Например, при составлении бюджета предприятия нужно учитывать множество показателей. Но чтобы проверить эффективность бюджета следует его проанализировать при различных условиях. Ведь в процессе бюджетирования нас интересует, на сколько будет чувствительна эффективность выделенных финансовых средств при следующих сценариях развития событий влияющих на предприятие:

<ul>
    <li>банки повысят процентные ставки по кредитам;</li>
    <li>существенно измениться уровень инфляции;</li>
    <li>поднимут налоги и т.п.</li>
</ul>

Тестировать план бюджета в оригинальном файле крайне не рекомендуется. Создавая новые копии документов для теста можно нарушить адресации во множестве трехмерных ссылок формул и функций. Наиболее рациональное решения для данной ситуации – это использование сценариев Excel.

**Пример сценариев в Excel**

Для примера применения сценариев в практике, будем использовать простые задачи. Допустим нам нужно накопить 13 800$ за 10 лет на банковском депозите с определенной процентной ставкой. Нам нужно узнать какой будем делать ежегодный взнос на депозит. И какая процентная ставка нас устроит для накопления денежных средств.

<ol>
    <li>
        Составьте таблицу так как указано на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Выделите диапазон ячеек B1:B2 и выберите инструмент: «Данные»-«Работа с данными»-«Анализ что если»-«Диспетчер сценариев».
        ![img](/images/img.png)
    </li>
    <li>
        В диспетчере нажмите на кнопку «Добавить».
        ![img](/images/img.png)
    </li>
    <li>
        В окне «Добавление сценария» укажите имя «Макс.ставка%» и ссылку на диапазон изменяемых ячеек. И нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Появится окно «Значения ячеек сценария», в нем введите новое значение 7% для ячейки B1, а в B2 не изменяйте как выше указано на рисунке. И нажмите ОК.
    </li>
    <li>
        Повторите выше указанные пункты с 3 по 5. Только на этот раз в 4-ом пункте укажите имя «Макс.взнос»; в 5-том пункте укажите новое значение взноса -1100 для ячейки B2, а B1 оставьте без изменений как ниже на рисунке:
        ![img](/images/img.png)
    </li>
    <li>
        Теперь в диспетчере сценариев нажмите на кнопку отчет.
        ![img](/images/img.png)
    </li>
    <li>
        Ничего не меняя жмем ОК.
        ![img](/images/img.png)
    </li>
</ol>

**Готово!!!**

![img](/images/img.png)

Теперь мы получили отчет, по которому можно сравнивать как будут развиваться события при различных возможных сценариях, чтобы заранее предвидеть результат при разных экономических условиях.

# <center>ПОДБОР ПАРАМЕТРА, ПОИСК РЕШЕНИЯ И СЦЕНАРИИ</center>

## <center>СОРТИРОВКА И ФИЛЬТР В EXCEL НА ПРИМЕРЕ БАЗЫ ДАННЫХ КЛИЕНТОВ</center>

Сортировка в Excel – это распределение строк таблицы в определенном порядке, который соответствует конкретным условиям пользователя. Упорядочивание строк при сортировке всегда выполняется относительно выбранного столбца.

### <center>РАБОТА В EXCEL C ФИЛЬТРОМ И СОРТИРОВКОЙ</center>

Чтобы выполнить сортировку Excel можно воспользоваться несколькими простыми способами. Сначала рассмотрим самый простой.

**Способ 1:**

<ol>
    <li>
        Заполните таблицу как на рисунке:
        ![img](/images/img.png)
    </li>
    <li>Перейдите на любую ячейку столбца F.</li>
    <li>
        Выберите инструмент: «Главная»-«Редактирование»-«Сортировка и фильтр»-«Сортировка от А до Я».
        ![img](/images/img.png)
    </li>
</ol>

**Способ 2:**

<ol>
    <li>Перейдите на любую ячейку таблицы с данными.</li>
    <li>Выберите инструмент: «Главная»-«Редактирование»-«Сортировка и фильтр»-«Фильтр»</li>
    <li>
        Щелкните по выпадающему списку опций в заголовке «Город» таблицы и выберите опцию «Сортировка от А до Я».
        ![img](/images/img.png)
    </li>
</ol>

Первый способ более простой, но он может выполнить сортировку только по одному столбцу (критерию). Для сортировки по нескольким столбцам следует использовать «Способ 2».

**Полезный совет!** В таблицах рекомендуется всегда использовать столбец с номерами строк. Он позволит всегда вернуться к первоначальному расположению строк после нескольких сортировок. Для этого достаточно выполнить сортировку этого столбца (например, №п/п).

Следует помнить, что сортировка выполняется над данными таблицы без пустых строк. Если нужно отсортировать только часть данных таблицы, тогда следует выделить это диапазон непосредственно перед сортировкой. Но такое фрагментированное сортирование данных очень редко имеет смысл и легко приводит к ошибкам.

### <center>СОРТИРОВКА ПО НЕСКОЛЬКИМ СТОЛБЦАМ В EXCEL</center>

Отсортируем базу данных клиентов в соответствии с двумя критериями:

<ol>
    <li>Наименование городов в алфавитном порядке.</li>
    <li>Возраст клиентов от младших до старших.</li>
</ol>

Выполним сортировку по отдельным столбцам таблицы:

<ol>
    <li>
        Перейдите курсором клавиатуры на любую ячейку таблицы и выберите инструмент: «Данные»-«Сортировка и фильтр»-«Сортировка».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне укажите параметры сортировки так, как указано ниже на рисунке и нажмите на кнопку «Добавить уровень».
        ![img](/images/img.png)
    </li>
    <li>
        Заполните параметры второго уровня как ниже на рисунке и нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

В результате таблица Excel отсортирована по нескольким критериям.

![img](/images/img.png)

Чем выше уровень параметров сортировки, тем выше его приоритет.

_Примечание. В Excel начиная с версии 2010-го года, количество уровней может быть столько, сколько столбцов в таблице. В старших версиях Excel разрешалось только 3 уровня._

### <center>КАК СДЕЛАТЬ ФИЛЬТР В EXCEL ПО СТОЛБЦАМ</center>

Фильтрация данных – это выборка из базы строк соответствующим определенным условиям. Например, отбор всех клиентов женского пола с одного или нескольких городов.

С данной таблицы нужно выбрать всех клиентов в возрасте до 30-ти лет проживающих в городах Москва и Санкт-Петербург.

![img](/images/img.png)

<ol>
    <li>
        Снова перейдите на любую ячейку таблицы базы данных клиентов и выберите инструмент: «Главная»-«Редактирование»-«Сортировка и фильтр»-«Фильтр».
    </li>
    <li>
        Щелкните по выпадающему списку столбца «Город» и отметьте галочками только Москву и Санкт-Петербург. И нажмите ОК.
        ![img](/images/img.png)
    </li>
    <li>
        Щелкните по выпадающему списку столбца «Возраст» и выберите опцию: «Числовые фильтры»-«Настраиваемый фильтр».
        ![img](/images/img.png)
    </li>
    <li>
        Заполните поля в окне «Пользовательский автофильтр» как указано на рисунке и нажмите ОК.
        ![img](/images/img.png)
    </li>
</ol>

Как видно в столбце «№п/п» отсутствуют некоторые номера, что подтверждает о фильтрации данных в таблице. Так же обратите внимание, как изменились кнопки выпадающих списков на столбцах C и F. Так как они содержать настройки их Excel отметил значком воронки. Теперь если нам нужно вернуть исходный вид базы данных о клиентах мы знаем, по каким столбцам нужно изменить настройки фильтрации. Но еще быстрее сбросить фильтр можно выбрав по новой инструмент «Главная»-«Редактирование»-«Сортировка и фильтр»-«Фильтр».

Листы Excel – это универсальные инструменты для сбора информации. В их строках описываем все элементы данных, а в столбцах – свойства. Строки нужно заполнять непрерывно одна за другой не оставляя пустых строк. Таким образом, у нас образуется простая однотабличная (не реляционная) база данных.

В языках баз данных (SQL и т.п.) строки таблиц считаются рядами, а столбцы – полями. Названия полей записаны в самой первой строке (заголовок таблицы) и эта строка не является рядом базы данных. Все инструменты для работы с электронными таблицами требуют организованной структуры для заполняемых данных. Поэтому не стоит хаотично заполнять ячейки листа. А придерживаться простой табличной структуры: столбцы должны иметь заголовки, а строки должны заполняться неразрывно. Только тогда мы имеем возможность обрабатывать данные в Excel с максимальной эффективностью.

## <center>ОБУЧЕНИЕ СВОДНЫМ ТАБЛИЦАМ EXCEL НА ПРИМЕРАХ</center>

Сводные таблицы в Excel – это мощный инструмент и чтобы описать все его возможности нельзя вложиться в одну статью. Возможностям сводных таблиц придаться посвящать целую книгу. В этой же статье будет обзор принципиальных свойств сводной таблицы. В двух словах можно описать ее главную особенность как инструмент для создания разного рода отчетов из суммирующих наборов. Такое определение сложно воспринять словами, поэтому сразу переходим к примерам и практике.

### <center>РАБОТА СО СВОДНЫМИ ТАБЛИЦАМИ В EXCEL</center>

Создайте таблицу исходных данных о клиентах фирмы, так как показано на рисунке:

![img](/images/img.png)

Теперь по исходной базе данных клиентов построим сводную таблицу, в которой можно легко отобразить средний возраст всех клиентов фирмы, которые не имеют дисконтную скидку c распределением на:

<ul>
    <li>возраст;</li>
    <li>образование;</li>
    <li>пол.</li>
</ul>

**Решение для построения сводного отчета в Excel:**

<ol>
    <li>
        Перейдите на любую ячейку исходной клиентской базы и выберите инструмент: «Вставка»-«Таблицы»-«Сводная таблица».
        ![img](/images/img.png)
    </li>
    <li>
        В появившемся диалоговом окне переключите на опцию «На существующий лист» и в поле «Диапазон» укажите значение H3:
        ![img](/images/img.png)
    </li>
    <li>
        В окне настроек (справа) «Список полей сводной таблицы» переместите значение «Пол» из поля «Выберите поля для добавления в отчет» в поле «Фильтр отчета»:
        ![img](/images/img.png)
    </li>
    <li>Таким же образом распределите остальные значения по полям так как указано выше на рисунке.</li>
    <li>
        Щелкните правой кнопкой мышки по любой ячейке внутри сводной таблицы. Из появившегося контекстного меню выберите опцию: «Итоги по»-«Среднее».
        ![img](/images/img.png)
    </li>
    <li>Округлите все значения до десятых с помощью формата ячеек.</li>
</ol>

![img](/images/img.png)

**Обратите внимание!** В ячейке I1 мы имеем возможность указать пол (мужской, женский или оба) для сегментирования отчета.

**Полезный совет!** Данная сводная таблица не имеет динамического подключения баз данных к исходной таблице клиентов. Поэтому любое изменение в исходной таблице не обновляются автоматически в сводной таблице. Поэтому после каждого изменения исходных данных следует щелкнуть правой кнопкой мышки по сводной таблице и выбрать опцию «Обновить». Тогда все данные выполнять пересчет и обновятся.

### <center>ПРИМЕР НАСТРОЙКИ СВОДНЫХ ОТЧЕТОВ</center>

Теперь поменяем структуру отчета в той же сводной таблице по тем же данным.

<ol>
    <li>
        Если вы случайно закрыли окно «Список полей сводной таблицы», тогда щелкните левой кнопкой мышки по сводной таблице, чтобы сделать ее активной. Затем включите опцию: «Работа со сводными таблицами»-«Параметры»-«Показать»-«Список полей».
        ![img](/images/img.png)
    </li>
    <li>
        Переместите значение «Пол» в поле «Название строк» под значение «Образование».
        ![img](/images/img.png)
    </li>
</ol>

Структура отчета кардинально изменена:

![img](/images/img.png)

Появились группировки, которые управляются кнопками (+ и -). Эти вспомогательные кнопки и заголовки можно включить/отключить через меню: Работа со сводными таблицами»-«Параметры»-«Показать»-«Кнопки» или «Заголовки полей». Так же у нас больше нет фильтра для сегментирования отчета по полу в ячейке I1.

{% include links.html %}
